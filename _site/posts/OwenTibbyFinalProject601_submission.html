<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Owen Tibby">
<meta name="dcterms.date" content="2022-12-23">

<title>DACSS 601: Data Science Fundamentals - FALL 2022 - Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta name="twitter:title" content="DACSS 601: Data Science Fundamentals - FALL 2022 - Final Project">
<meta name="twitter:description" content="Introduction &amp; Purpose of the Study:">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
    <span class="navbar-title">DACSS 601: Data Science Fundamentals - FALL 2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page">Fall 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/601_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Final Project</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Final materials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://dacss.github.io/601_Fall_2022/" class="sidebar-item-text sidebar-link">Fall 2022 posts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">final Posts</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><strong>Introduction</strong></a></li>
  <li><a href="#data-methodology" id="toc-data-methodology" class="nav-link" data-scroll-target="#data-methodology"><strong>Data &amp; Methodology:</strong></a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations"><strong>Visualizations</strong></a>
  <ul class="collapse">
  <li><a href="#bonus-section" id="toc-bonus-section" class="nav-link" data-scroll-target="#bonus-section">Bonus Section</a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><strong>Reflection</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>Conclusion</strong></a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"><strong>Bibliography</strong></a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><strong>Appendix</strong></a>
  <ul class="collapse">
  <li><a href="#appendix-a" id="toc-appendix-a" class="nav-link" data-scroll-target="#appendix-a">Appendix A:</a></li>
  <li><a href="#appendix-b" id="toc-appendix-b" class="nav-link" data-scroll-target="#appendix-b">Appendix B:</a></li>
  <li><a href="#appendix-c" id="toc-appendix-c" class="nav-link" data-scroll-target="#appendix-c">Appendix C:</a></li>
  <li><a href="#appendix-d" id="toc-appendix-d" class="nav-link" data-scroll-target="#appendix-d">Appendix D:</a></li>
  <li><a href="#appendix-e" id="toc-appendix-e" class="nav-link" data-scroll-target="#appendix-e">Appendix E:</a></li>
  <li><a href="#appendix-f" id="toc-appendix-f" class="nav-link" data-scroll-target="#appendix-f">Appendix F:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Final Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Final Project (Second Submission)</div>
    <div class="quarto-category">Used Vehicle Data</div>
    <div class="quarto-category">Owen Tibby</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Owen Tibby </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 23, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distill)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vindecodr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(vindecodr): there is no package called 'vindecodr'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(sparklyr): there is no package called 'sparklyr'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">paged.print=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level1">
<h1><strong>Introduction</strong></h1>
<p>Introduction &amp; Purpose of the Study:</p>
<p>The automotive sector is a major part of the US economy and is among the hardest hit by the ripple effects of the COVID-19 pandemic. Factory closures and lockdowns led to a supply shortage of critical vehicle components necessary for new car production. Consequently, this has significantly increased the demand and value of used cars. However, some experts believe the market will return to ‘normal’ by the end of 2023. But what did the market look like before the pandemic?</p>
<p>The purpose of this study is to explore the realm of the used car market, specifically, the wholesale sector. The primary data was gathered from a public domain and represents Manheim auction sales between wholesalers/ remarketers and wholesale buyers/ dealers of used vehicles. I am interested in exploring the retained value of vehicles based on their segment, body type, and age. Correlations between vehicle condition and mileage will also be analyzed.</p>
<p>Research Question: How do age, mileage, body style, and condition affect the retained value of a used vehicle?</p>
</section>
<section id="data-methodology" class="level1">
<h1><strong>Data &amp; Methodology:</strong></h1>
<section id="reading-in-the-data" class="level4">
<h4 class="anchored" data-anchor-id="reading-in-the-data">Reading in the Data</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # #RStudio Desktop</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"_data/car_prices2.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>,  <span class="st">"skip"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> carprices</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>exchange_rate <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/Historical_Prices.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Second Read-In of ca_catalog (to make data fields private)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/ca_catalog2.csv"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Read-In from code chunk</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/decoded.keys1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Description of Data:</strong></p>
<p>The primary data used in the analysis was the ‘carprices.csv’ data set from Kaggle (see appendix A). This data set contains historical used vehicle auction transactions that took place between 2014 and 2015. The data was collected from Manheim auction houses across the 34 states in the USA. Each observation details a wholesale auction transaction that includes: the vehicle information, state/province, selling price, sale date, and the market average price i.e., the Manheim Market Report price (MMR) and other specifics about the sale.</p>
</section>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
</section>
<section id="primary-objectives" class="level4">
<h4 class="anchored" data-anchor-id="primary-objectives"><strong>Primary Objectives</strong></h4>
<p><em>Data Cleansing:</em></p>
<ol type="1">
<li><p>Have consistency in the names of vehicle makes and models by using appropriate packages and joins.</p></li>
<li><p>Obtain MSRP from by joining with a catalog</p></li>
</ol>
<p><em>Data Analysis:</em></p>
<ol start="3" type="1">
<li><p>Calculate vehicle age as a variable in both years and months.</p></li>
<li><p>Compute retained value as a percentage of each vehicle’s MSRP</p></li>
<li><p>Compute standard error as a percentage of the mean MSRP for each model and filter transactions with a low error rating for deeper analysis.</p></li>
<li><p>Analyze the impact of age, mileage, condition, and segment on retained value</p></li>
<li><p>Determine the segments (eg. compact cars, midsize cars, etc.) and vehicles with the highest retained value percentage.<br>
</p></li>
</ol>
</section>
<section id="methods" class="level4">
<h4 class="anchored" data-anchor-id="methods"><strong>Methods:</strong></h4>
<p>Retained Value (RV) is calculated by dividing the selling price (auction value) by the vehicle’s MSRP.</p>
<p>Retained Value% = Wholesale Price/ MSRP&nbsp;</p>
<p>I was able to source MSRPs from a Canadian vehicle catalog <em>(Appendix B)</em> . To protect the data confidentiality, the MSRPs in the Canadian dollar catalog were averaged for each year, make, and model by trim level. In other words, I aggregated and derived the mean of the MSRPs of all trims belonging to a specific year, make and model, or YMM to reduce the level of detail. Therefore, MSRPs for trims belonging to a particular year, make and model shows the mean MSRP for the entire YMM group.&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/process_RV.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Using the YMM as a key common to the ‘carprices’ data as well as the ca_catalog, I can combine both and fetch the MSRP. Unsurprisingly, this left one more challenge, the MSRPs are listed in Canadian Dollars. In order to convert it to US Dollars, I will have to find and divide each vehicle MSRP by the USD: CAD exchange rate at the time of release. I was able to source the FX rate from 2006 and onwards using ‘exchange_rate.csv’ data obtained from WSJ Markets. Considering the below assumptions, I joined the exchange_rate.csv to carprices.csv using launch year as the common key between both data frames. Each MSRP was then divided by the daily close rate of the USD-CAD.&nbsp;</p>
<p>Important assumptions to get MSRP in USD:&nbsp;</p>
<ol type="1">
<li><p>Canadian vehicles &amp; trims are priced similarly with US trims.&nbsp;</p></li>
<li><p>All vehicles were released in September of the previous year. i.e., a 2013 vehicle was available for sale in September 2012.&nbsp;</p></li>
<li><p>The exchange rate at the time of release was the closing FX rate at Aug-31st&nbsp;</p></li>
</ol>
</section>
<section id="data-cleansing" class="level4">
<h4 class="anchored" data-anchor-id="data-cleansing"><strong>Data Cleansing:</strong></h4>
<section id="observing-the-data" class="level5">
<h5 class="anchored" data-anchor-id="observing-the-data"><strong>Observing the data</strong></h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Table 1.0: Auction Data (Preview)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(carprices)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

|year |make   |model               |trim       |body  |transmission |vin               |state | condition| odometer|color |interior |seller                                             |   mmr| sellingprice|saledate                                |
|:----|:------|:-------------------|:----------|:-----|:------------|:-----------------|:-----|---------:|--------:|:-----|:--------|:--------------------------------------------------|-----:|------------:|:---------------------------------------|
|2015 |Kia    |Sorento             |LX         |SUV   |automatic    |5xyktca69fg566472 |ca    |       5.0|    16639|white |black    |kia motors america, inc                            | 20500|        21500|Tue Dec 16 2014 12:30:00 GMT-0800 (PST) |
|2015 |Kia    |Sorento             |LX         |SUV   |automatic    |5xyktca69fg561319 |ca    |       5.0|     9393|white |beige    |kia motors america, inc                            | 20800|        21500|Tue Dec 16 2014 12:30:00 GMT-0800 (PST) |
|2014 |BMW    |3 Series            |328i SULEV |Sedan |automatic    |wba3c1c51ek116351 |ca    |       4.5|     1331|gray  |black    |financial services remarketing (lease)             | 31900|        30000|Thu Jan 15 2015 04:30:00 GMT-0800 (PST) |
|2015 |Volvo  |S60                 |T5         |Sedan |automatic    |yv1612tb4f1310987 |ca    |       4.1|    14282|white |black    |volvo na rep/world omni                            | 27500|        27750|Thu Jan 29 2015 04:30:00 GMT-0800 (PST) |
|2014 |BMW    |6 Series Gran Coupe |650i       |Sedan |automatic    |wba6b2c57ed129731 |ca    |       4.3|     2641|gray  |black    |financial services remarketing (lease)             | 66000|        67000|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |
|2015 |Nissan |Altima              |2.5 S      |Sedan |automatic    |1n4al3ap1fn326013 |ca    |       1.0|     5554|gray  |black    |enterprise vehicle exchange / tra / rental / tulsa | 15350|        10900|Tue Dec 30 2014 12:00:00 GMT-0800 (PST) |</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing and removing all records for model year 2006 and older &amp; all erroneous prices</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">&gt;</span> <span class="dv">2006</span>, sellingprice<span class="sc">&gt;</span><span class="dv">100</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of states and body types</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span>  <span class="fu">select</span>(state) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>state)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>body <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>body)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-the-data-mapping-and-joining" class="level5">
<h5 class="anchored" data-anchor-id="cleaning-the-data-mapping-and-joining">Cleaning the Data: Mapping and Joining</h5>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of Body types}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Body Type column</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Body_Type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(body, <span class="st">"EDAN"</span>)<span class="sc">~</span> <span class="st">"Sedan"</span>, <span class="fu">str_detect</span>(body, <span class="st">"SUV"</span>) <span class="sc">~</span> <span class="st">"SUV"</span>, <span class="fu">str_detect</span>(body, <span class="st">"AB"</span>) <span class="sc">~</span> <span class="st">"Pickup"</span>, <span class="fu">str_detect</span>(body, <span class="st">"OUP"</span>)<span class="sc">~</span> <span class="st">"Coupe"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>, <span class="st">"VAN"</span>)<span class="sc">~</span> <span class="st">"Minivan"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ONV"</span>)<span class="sc">~</span> <span class="st">"Convertible"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"AGO"</span>) <span class="sc">~</span> <span class="st">"Wagon"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ATCH"</span>)<span class="sc">~</span> <span class="st">"Hatchback"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"CREW"</span>)<span class="sc">~</span> <span class="st">"Pickup"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Joining multiple files to get the MSRP from a historical catalog. The code below shows what I did to write a new CSV file (that does not include the original MSRP but rather the mean MSRP and the other useful fields like trim count and Error.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Key in the CDN catalog</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span>  ca_catalog <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">YearOfLaunch=</span> <span class="st">`</span><span class="at">Model Year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Catalog with MSRP in CAD</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Combined</span><span class="st">`</span>, <span class="st">`</span><span class="at">YearOfLaunch</span><span class="st">`</span>, <span class="st">`</span><span class="at">Segment</span><span class="st">`</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>( <span class="at">Trim_Count=</span><span class="fu">n</span>(), <span class="at">AVG_MSRP_CAD=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">MSRP_Range_CAD=</span> (<span class="fu">max</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)<span class="sc">-</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)), <span class="at">StdDev_MSRP_CAD=</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>), <span class="at">Error.MSRP_CAD=</span> <span class="fu">std.error</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Writing CSV to exclude confidential MSRPs and only include the AVG_MSRP field</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ca_catalog, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">ca_catalog.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Join #1</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining the data to convert CAD MSRP to USD MSRP later</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ca_catalog, exchange_rate, <span class="fu">c</span>(<span class="st">"YearOfLaunch"</span><span class="ot">=</span> <span class="st">"Year"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating US$ Catalog and Converting to MSRP from CAD to USD</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVG_MSRP=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">AVG_MSRP_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>), <span class="at">digits =</span> <span class="dv">0</span>), <span class="at">MSRP_Range=</span> <span class="st">`</span><span class="at">MSRP_Range_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">StdDev_MSRP=</span> <span class="st">`</span><span class="at">StdDev_MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">Error.MSRP=</span> <span class="st">`</span><span class="at">Error.MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span> )</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalizing US Catalog for Joining</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> us_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Combined, Segment, AVG_MSRP, MSRP_Range, Trim_Count, StdDev_MSRP, Error.MSRP) <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">Error.MSRP</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">1</span>), <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">MSRP_Range</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>), <span class="at">digits=</span><span class="dv">1</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a common key to join carprices and us_catalog</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year2=</span>year, <span class="at">make2=</span>make, <span class="at">model2=</span>model)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(<span class="st">`</span><span class="at">YMM</span><span class="st">`</span>, <span class="st">`</span><span class="at">year2</span><span class="st">`</span>, <span class="st">`</span><span class="at">make2</span><span class="st">`</span>, <span class="st">`</span><span class="at">model2</span><span class="st">`</span>, <span class="at">sep=</span><span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Join #2</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining Data with us_catalog</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">left_join</span>(carprices, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#saving our raw records before filtering</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>raw_carprices <span class="ot">&lt;-</span> carprices</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering NAs out the keys that were not mapped to an MSRP using YMM</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#(Will run these false keys through a vin decoder to get exact matches)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(AVG_MSRP))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the false_keys from main dataset</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(AVG_MSRP)) </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>us_catalog<span class="sc">$</span>Combined <span class="ot">&lt;-</span> <span class="fu">toupper</span>(us_catalog<span class="sc">$</span>Combined)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>vin <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>vin)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>make <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>make)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-the-data-decoding-more-joining" class="level5">
<h5 class="anchored" data-anchor-id="cleaning-the-data-decoding-more-joining">Cleaning the Data: Decoding &amp; More Joining</h5>
<p>Vin deocder function used to decode all VINs that were not matched. This was available from the vindecodr package in R contributed by the NHTSA.</p>
<p>The code below shows how I created the ‘decoded_keys’ csv file that I read in earlier. I have set eval=FALSE because of the lengthy run time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To clean Year, make, Model fields in false_keys (code run time = 3hrs + 13mins)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span>false_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span> VinIn<span class="sc">$</span>vin</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>decode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a> VIN<span class="ot">&lt;-</span> <span class="fu">decode_vin</span>(x)}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(VinIn,  decode)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving the above output as a CSV</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(decoded_keys, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">decoded_keys.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # #R Studio Desktop Read In</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">##Cleaned False keys (Imported at read in so I set eval= FALSE)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"decoded.keys.csv"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#R Studio Cloud Read In</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_keys &lt;- read_csv("/cloud/project/Final_project/decoded.keys1.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<p>Join #3</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting useful columns in false_keys</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>f_keys <span class="ot">&lt;-</span> false_keys</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> false_keys <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with false keys to get sale records</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cleaned_keys= inner_join(a_keys, false_keys, c("VIN" = "vin")) %&gt;% select(1:26) %&gt;% rename("vin" = "VIN")</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span>  <span class="fu">inner_join</span>(false_keys, a_keys, <span class="fu">c</span>(<span class="st">"vin"</span> <span class="ot">=</span> <span class="st">"VIN"</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#saving unmatched NAs for future wrangling</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span> action_keys <span class="sc">%&gt;%</span>   <span class="fu">select</span>(model_year, make,model, VIN) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">year=</span> model_year, <span class="at">make2=</span>make, <span class="at">model2=</span>model) <span class="sc">%&gt;%</span> <span class="fu">unite</span> (YMM, model_year, make2, model2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#saving unmatched keys</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>unmatched_keys <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(f_keys, cleaned_keys, <span class="fu">c</span>(<span class="st">"vin"</span><span class="ot">=</span> <span class="st">"vin"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Join #4-5</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Attempting to clean the most common unmatched keys manually</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span> <span class="fu">mutate</span>(unmatched_keys, <span class="at">year2=</span>year, <span class="at">year3=</span>year, <span class="at">make2=</span>make, <span class="at">make3=</span>make, <span class="at">model2 =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(model,<span class="st">"6 SERIES"</span>)<span class="sc">~</span> <span class="st">"6 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"3 SERIES"</span>)<span class="sc">~</span> <span class="st">"3 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"4 SERIES"</span>)<span class="sc">~</span> <span class="st">"4 SERIES"</span>,<span class="fu">str_detect</span>(model, <span class="st">"5 SERIES"</span>)<span class="sc">~</span> <span class="st">"5 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"CAPTIVA"</span>)<span class="sc">~</span> <span class="st">"CAPTIVA"</span>,<span class="fu">str_detect</span>(model, <span class="st">"OUTLANDER"</span>)<span class="sc">~</span> <span class="st">"OUTLANDER"</span>, <span class="fu">str_detect</span>(model, <span class="st">"RAM PICKUP 1500"</span>)<span class="sc">~</span> <span class="st">"RAM 1500"</span>, <span class="fu">str_detect</span>(model, <span class="st">"TOWN AND COUNTRY"</span>)<span class="sc">~</span> <span class="st">"TOWN &amp; COUNTRY"</span>,  <span class="fu">str_detect</span>(model, <span class="fu">c</span>(<span class="st">"750I"</span>, <span class="st">"7 SERIES"</span>,  <span class="st">"750LI"</span>))<span class="sc">~</span> <span class="st">"7 SERIES"</span> ), <span class="at">model3=</span>model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `mutate()`:
! Problem while computing `model2 = case_when(...)`.
Caused by error in `str_detect()`:
! Can't recycle `string` (size 20826) to match `pattern` (size 3).</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span>  unmatched_keys_clean <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(YMM2, year2, make2, model2, <span class="at">sep=</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in unite(., YMM2, year2, make2, model2, sep = " "): object 'unmatched_keys_clean' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span> unmatched_keys_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year3, make3, model3, trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate, YMM2) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make3), <span class="sc">!</span><span class="fu">is.na</span>(model3)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in select(., year3, make3, model3, trim, body, Body_Type, transmission, : object 'unmatched_keys_clean' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#An additional 6860 records were cleaned</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cleaned_keys2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(unmatched_keys_clean, us_catalog, <span class="fu">c</span>(<span class="st">"YMM2"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">year=</span> year3, <span class="at">make=</span>make3, <span class="at">model=</span>model3, <span class="at">YMM=</span>YMM2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in inner_join(unmatched_keys_clean, us_catalog, c(YMM2 = "Combined")): object 'unmatched_keys_clean' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>unmatched_keys <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(unmatched_keys, cleaned_keys2, <span class="fu">c</span>(<span class="st">"vin"</span><span class="ot">=</span> <span class="st">"vin"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in is.data.frame(y): object 'cleaned_keys2' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>unmatched_unique <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_unique), <span class="st">" "</span>, <span class="st">"unique vehicle VINs; "</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>unmatched_makes <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(make) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>unmatched_models <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(model) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>unmatched_YMM <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(YMM) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_makes), <span class="st">" "</span>, <span class="st">"unmatched makes; "</span>))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_models), <span class="st">" "</span>, <span class="st">"unmatched models: "</span>))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_YMM), <span class="st">" "</span>, <span class="st">"unmatched YMM keys (Year-Make-Model)."</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(a,b,c,d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "20507 unique vehicle VINs; 42 unmatched makes; 136 unmatched models: 349 unmatched YMM keys (Year-Make-Model)."</code></pre>
</div>
</div>
<p>Binding cleaned data sets</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#get column names &amp; order from carprices</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>check_cols <span class="ot">&lt;-</span>  <span class="fu">colnames</span>(carprices) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#checking to see if the column order is the same</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span> cleaned_keys[, check_cols]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>cleaned_keys2 <span class="ot">&lt;-</span> cleaned_keys2[, check_cols]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'cleaned_keys2' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging both sets of cleaned data (Auto and manually cleaned)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(cleaned_keys, cleaned_keys2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in rbind(deparse.level, ...): object 'cleaned_keys2' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(cleaned_keys), <span class="at">caption =</span> <span class="st">"Table 1.1: Displaying cleaned keys"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: Table 1.1: Displaying cleaned keys

| year|make     |model |trim        |body    |transmission |vin               |state | condition| odometer|color |interior |seller                   |   mmr| sellingprice|saledate                                |Body_Type |YMM               |Segment               | AVG_MSRP| MSRP_Range| Trim_Count| StdDev_MSRP| Error.MSRP| Error %| %MSRP_Range|
|----:|:--------|:-----|:-----------|:-------|:------------|:-----------------|:-----|---------:|--------:|:-----|:--------|:------------------------|-----:|------------:|:---------------------------------------|:---------|:-----------------|:---------------------|--------:|----------:|----------:|-----------:|----------:|-------:|-----------:|
| 2015|LEXUS    |RX    |Base        |SUV     |automatic    |2T2ZK1BA7FC155782 |CA    |       4.3|     7770|white |black    |lexus financial services | 41200|        38400|Tue Dec 30 2014 00:00:00 GMT-0800 (PST) |SUV       |2015 LEXUS RX     |Compact SUV/Crossover |    53276|   11216.33|          3|    5728.452|   3307.324|     6.2|        21.1|
| 2013|INFINITI |G37   |G37 Sport   |G COUPE |automatic    |JN1CV6EK4DM921604 |CA    |       4.5|    14716|white |black    |nissan infiniti lt       | 25900|        25000|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |Coupe     |2013 INFINITI G37 |Mid-Size Car          |    56018|   23618.85|         17|    7296.869|   1769.751|     3.2|        42.2|
| 2013|INFINITI |G37   |G37 Journey |G SEDAN |automatic    |JN1CV6AP3DM726059 |CA    |       4.6|       68|black |black    |nissan infiniti lt       | 25700|        27250|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |Sedan     |2013 INFINITI G37 |Mid-Size Car          |    56018|   23618.85|         17|    7296.869|   1769.751|     3.2|        42.2|
| 2013|INFINITI |G37   |G37 Journey |G SEDAN |automatic    |JN1CV6APXDM714541 |CA    |       4.5|    24112|white |black    |nissan infiniti lt       | 22800|        22500|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |Sedan     |2013 INFINITI G37 |Mid-Size Car          |    56018|   23618.85|         17|    7296.869|   1769.751|     3.2|        42.2|
| 2013|INFINITI |G37   |G37 Sport   |G COUPE |automatic    |JN1CV6EK8DM920763 |CA    |       4.7|     4859|black |black    |nissan infiniti lt       | 27200|        26750|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |Coupe     |2013 INFINITI G37 |Mid-Size Car          |    56018|   23618.85|         17|    7296.869|   1769.751|     3.2|        42.2|
| 2013|INFINITI |G37   |G37 Sport   |G COUPE |automatic    |JN1CV6EK8DM900321 |CA    |       4.5|    21126|black |beige    |nissan infiniti lt       | 25100|        26500|Thu Dec 18 2014 12:30:00 GMT-0800 (PST) |Coupe     |2013 INFINITI G37 |Mid-Size Car          |    56018|   23618.85|         17|    7296.869|   1769.751|     3.2|        42.2|</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(cleaned_keys2), <span class="at">caption =</span> <span class="st">"Table 1.2: Displaying cleaned keys2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in head(cleaned_keys2): object 'cleaned_keys2' not found</code></pre>
</div>
</div>
<p>1st iteration of cleaning through decoder: 67% of the previous NA records were automatically cleaned (38208 of 57328 records) 2nd iteration of cleaning (Manually): 6860 records were manually cleaned. In total, 79% of the NAs were cleaned in the Year, Make, and Model fields</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reorganize cleaned keys to rbind with carprices data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(carprices, cleaned_keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
</section>
</section>
<section id="considerations" class="level4">
<h4 class="anchored" data-anchor-id="considerations"><strong>Considerations:</strong></h4>
<p>This approximation of the MSRP using the YMM formed the basis for a lot of the analysis:</p>
<ol type="1">
<li><p><strong>Computation was narrowed down to model level.</strong> By using the mean MSRP for all trim levels, I can only analyze the retained value on the Year, Make, Model level i.e., not specific to the trim. For example, I can only analyze how a 3-year-old Toyota Camry retains its value but not a Toyota Camry XSE.&nbsp;</p></li>
<li><p><strong>Normal distribution of mean price.</strong> The mean of the MSRP assumes that the purchase of trims/packages above the base price mimics a normal distribution. That means that most customers will buy at or around the mean priced trim. Additionally, because trims often follow interval pricing, the mean MSRP of most passenger vehicles tends to be close to&nbsp;the median. Therefore, for the standard vehicle, there is generally not much variation between the median trim price and the mean price of all trims.&nbsp;</p></li>
<li><p><strong>Useful statistics:</strong> it was valuable to assess the number of trims for each model, the standard deviation, and the standard error in my approximation of MSRP. To further the analysis, I also included the Range in MSRP (price difference between top and base trim) as a percentage of mean MSRP, along with Error % in MSRP- which is the standard error divided by the mean MSRP. Since MSRP is the denominator in our RV equation, these metrics provide an idea of how accurate our retained value (RV) percentage is. They also serve as appropriate means of filtering out low-quality data and as a sanity check to statistical tests that were conducted on correlations and regressions.</p></li>
</ol>
<p>The next critical variable is age. For this analysis, I will treat age as continuous in Age_months and Age_years. Like the above assumptions, I will assume that all vehicles of model year x are released in the Fall of the previous year (x-1). This will be done by creating the launch date variable and finding the difference from the sale date in months and years, to obtain the age of the vehicle at the time of sale. A deeper analysis will be placed on 2-year- to 6-year-old vehicle transactions. See the Appendix for more details about the variables.</p>
</section>
<section id="calculations" class="level4">
<h4 class="anchored" data-anchor-id="calculations">Calculations:</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carprices)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for NA values in AVG_MSRP and YMM</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% filter(is.na(AVG_MSRP)) </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% filter(is.na(YMM)) </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Replacing na records in Error%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="ot">&lt;-</span> carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="dv">0</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices<span class="co"># %&gt;% filter(`Error %` &lt;7)</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing new NA records for Bodytype</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>na.body <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Body_Type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 1</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(carprices<span class="sc">$</span>year))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">launch_month=</span> <span class="st">"9"</span>, <span class="at">launch_day=</span> <span class="st">"1"</span>, <span class="at">launch_year=</span> (<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 2</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">launch_date=</span> <span class="fu">make_date</span>(<span class="at">year=</span> <span class="st">`</span><span class="at">launch_year</span><span class="st">`</span>, <span class="at">month =</span> <span class="st">`</span><span class="at">launch_month</span><span class="st">`</span>, <span class="at">day=</span><span class="st">`</span><span class="at">launch_day</span><span class="st">`</span>))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting saledate to a date variable</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">separate</span>(saledate, <span class="at">into=</span> <span class="fu">c</span>(<span class="st">"ddd"</span>, <span class="st">"sale_month"</span>, <span class="st">"sale_day"</span>, <span class="st">"sale_year"</span>, <span class="st">"sale_time"</span>, <span class="st">"GMT"</span>, <span class="st">"TMZ"</span>), <span class="at">sep=</span><span class="st">" "</span>)   </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding the format of the sale month</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_month2=</span> <span class="fu">recode</span>(sale_month, <span class="st">`</span><span class="at">Jan</span><span class="st">`</span> <span class="ot">=</span><span class="st">"1"</span>, <span class="st">`</span><span class="at">Feb</span><span class="st">`</span><span class="ot">=</span> <span class="st">"2"</span>, <span class="st">`</span><span class="at">Mar</span><span class="st">`</span><span class="ot">=</span><span class="st">"3"</span>, <span class="st">`</span><span class="at">Apr</span><span class="st">`</span><span class="ot">=</span><span class="st">"4"</span>, <span class="st">`</span><span class="at">May</span><span class="st">`</span><span class="ot">=</span><span class="st">"5"</span>, <span class="st">`</span><span class="at">Jun</span><span class="st">`</span><span class="ot">=</span><span class="st">"6"</span>, <span class="st">`</span><span class="at">Jul</span><span class="st">`</span><span class="ot">=</span><span class="st">"7"</span>, <span class="st">`</span><span class="at">Aug</span><span class="st">`</span><span class="ot">=</span><span class="st">"8"</span>, <span class="st">`</span><span class="at">Sep</span><span class="st">`</span><span class="ot">=</span><span class="st">"9"</span>, <span class="st">`</span><span class="at">Oct</span><span class="st">`</span><span class="ot">=</span><span class="st">"10"</span>, <span class="st">`</span><span class="at">Nov</span><span class="st">`</span><span class="ot">=</span><span class="st">"11"</span>, <span class="st">`</span><span class="at">Dec</span><span class="st">`</span><span class="ot">=</span><span class="st">"12"</span> ))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Date_Sold</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">#carprices &lt;- mutate(carprices, sale_year2=sale_year)</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_year2=</span>sale_year, <span class="at">Date_Sold =</span> <span class="fu">make_date</span>(<span class="at">year=</span>sale_year2, <span class="at">month =</span> sale_month2, <span class="at">day =</span> sale_day))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyiing up: selecting important columns</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(year, make, model, trim, transmission, Body_Type, state, condition, odometer, color, mmr, sellingprice, sale_year, launch_date, Date_Sold, AVG_MSRP, Trim_Count, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span>, Segment ) </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Age of vehicle</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Age_months=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(Date_Sold, launch_date, <span class="at">units=</span> <span class="st">"days"</span>))<span class="sc">/</span><span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for negatives in Vehicle Age</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span>  <span class="fu">select</span>(Age_months) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Age_months<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding Vehicle Age</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Age_months=</span><span class="fu">recode</span>(Age_months, <span class="st">`</span><span class="at">-8</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Age in years</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Age_years=</span><span class="fu">round</span>(Age_months<span class="sc">/</span><span class="dv">12</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below is the calculation of Retained Value:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Retained value and removing irrational RV%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">RV_percent=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">sellingprice</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>))<span class="co"># %&gt;% filter(RV_percent&lt;125)</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(carprices)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

| year|make   |model    |trim       |transmission |Body_Type |state | condition| odometer|color |   mmr| sellingprice|sale_year |launch_date |Date_Sold  | AVG_MSRP| Trim_Count| Error %| %MSRP_Range|Segment                | Age_months| Age_years| RV_percent|
|----:|:------|:--------|:----------|:------------|:---------|:-----|---------:|--------:|:-----|-----:|------------:|:---------|:-----------|:----------|--------:|----------:|-------:|-----------:|:----------------------|----------:|---------:|----------:|
| 2015|Kia    |Sorento  |LX         |automatic    |SUV       |CA    |       5.0|    16639|white | 20500|        21500|2014      |2014-09-01  |2014-12-16 |    30886|         10|     4.6|        44.9|Mid-Size SUV/Crossover |          4|         0|       69.6|
| 2015|Kia    |Sorento  |LX         |automatic    |SUV       |CA    |       5.0|     9393|white | 20800|        21500|2014      |2014-09-01  |2014-12-16 |    30886|         10|     4.6|        44.9|Mid-Size SUV/Crossover |          4|         0|       69.6|
| 2014|BMW    |3 Series |328i SULEV |automatic    |Sedan     |CA    |       4.5|     1331|gray  | 31900|        30000|2015      |2013-09-01  |2015-01-15 |    43928|         17|     3.2|        48.2|Compact Car            |         17|         1|       68.3|
| 2015|Volvo  |S60      |T5         |automatic    |Sedan     |CA    |       4.1|    14282|white | 27500|        27750|2015      |2014-09-01  |2015-01-29 |    41472|         32|     1.6|        37.2|Compact Car            |          5|         0|       66.9|
| 2015|Nissan |Altima   |2.5 S      |automatic    |Sedan     |CA    |       1.0|     5554|gray  | 15350|        10900|2014      |2014-09-01  |2014-12-30 |    25683|          5|     6.6|        36.9|Mid-Size Car           |          4|         0|       42.4|
| 2014|BMW    |M5       |Base       |automatic    |Sedan     |CA    |       3.4|    14943|black | 69000|        65000|2014      |2013-09-01  |2014-12-17 |    96332|          2|     0.0|         0.0|Mid-Size Car           |         16|         1|       67.5|</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How does the distribution of RV% look?</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(carprices$RV_percent)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Annual KMs</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Annual_miles=</span> <span class="fu">round</span>(odometer<span class="sc">/</span>Age_months <span class="sc">*</span> <span class="dv">12</span>, <span class="at">digits=</span><span class="dv">0</span>))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing Salvage title and damaged vehicles</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition<span class="sc">&gt;</span><span class="fl">1.4999999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="visualizations" class="level1">
<h1><strong>Visualizations</strong></h1>
<p>Before analyzing the impact of the independent variables on the retained value, I will first look at the relationship that each of the IVs have on each other using multiple dimensions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Establishing vehicle groups</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Error in Nissan records</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>mainstream <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Kia"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Volkswagen"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>domestic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Buick"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Chevrolet"</span>, <span class="st">"Chrysler"</span>, <span class="st">"Dodge"</span>, <span class="st">"Ford"</span>, <span class="st">"GMC"</span>, <span class="st">"Jeep"</span>, <span class="st">"Lincoln"</span>, <span class="st">"Ram"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>luxury <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BMW"</span>, <span class="st">"Audi"</span>, <span class="st">"Mercedes-Benz"</span>, <span class="st">"Porsche"</span>, <span class="st">"Lexus"</span>, <span class="st">"INFINITI"</span>, <span class="st">"Acura"</span>, <span class="st">"Genesis"</span>, <span class="st">"Volvo"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Lincoln"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>passenger <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Sedan"</span>, <span class="st">"SUV"</span>, <span class="st">"Coupe"</span>, <span class="st">"Convertible"</span>, <span class="st">"Wagon"</span>, <span class="st">"Hatchback"</span>, <span class="st">"Minivan"</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>pickup <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Pickup"</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>Japanese <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Scion"</span>, <span class="st">"Mitsubishi"</span>, <span class="st">"Suzuki"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>Korean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Kia"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Genesis"</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>Pop.European <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Audi"</span>, <span class="st">"BMW"</span>, <span class="st">"Mercedes-Benz"</span>, <span class="st">"Jaguar"</span>, <span class="st">"Land Rover"</span> )</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>comp.seg <span class="ot">&lt;-</span> <span class="fu">c</span>(mainstream, domestic, luxury)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>comp.makes <span class="ot">&lt;-</span> <span class="fu">c</span>(Japanese, Korean, Pop.European)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="correlation-mileage-age-body-and-condition" class="level4">
<h4 class="anchored" data-anchor-id="correlation-mileage-age-body-and-condition">Correlation: Mileage, Age, Body, and Condition</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between mileage and age (in months and years)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>MLG.AGE1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>Age_months, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>)  , <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>MLG.AGE2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>Age_years, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>) , <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between mileage and condition</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>MLG.CON1. <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between Age and Condition</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>AGE.CON1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>Age_months, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>AGE.CON2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>Age_years, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>RV.MLG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">var</span>(carprices<span class="sc">$</span>RV_percent, carprices<span class="sc">$</span>odometer, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and condition</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>RV.CON <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>RV_percent, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.1</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>, <span class="st">`</span><span class="at">domestic</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup), condition<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.1</span>) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">210000</span>)<span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~Body_Type)+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Mileage"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.1: Relationship between Mileage, Condition and Age"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation between Mileage and Condition "</span>, <span class="st">" = "</span>, MLG.AGE1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Graph%201.1-1.2%20Correlations-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.2</span> <span class="ot">&lt;-</span> plot1<span class="fl">.1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.2</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (Age_years), <span class="at">color=</span> odometer) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~Body_Type)+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Age"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.2: Relationship between Mileage, Condition and Age"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation between Age and Condition "</span>, <span class="st">" = "</span>, AGE.CON1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Graph%201.1-1.2%20Correlations-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Graphs 1.1 and 1.2 above show the inverse relationships across the condition, mileage, and age. While this relationship is very intuitive and almost trivial, a closer look will highlight that a vehicle’s condition is more sensitive to mileage at lower ages. In other words, As vehicles age, the impact of mileage on condition decreases. This was illustrated in Graph 1.1 where the slope of the curve steadily decreased over time.</p>
<p>This may also be caused by the fact that older high-mileage vehicles tend not to be driven as much as younger low-mileage vehicles, due to cost and several other factors like reliability issues. An exception to this would be the rare case where older vehicles (or antiques) already in very good condition are intentionally driven less to preserve their condition. Therefore, aging but maintaining a higher condition rating. Fortunately, I am only analyzing models from 2006 and newer, so this “antique effect” is of no significance but is still worthy of mention for future research purposes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.3</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>, <span class="st">`</span><span class="at">domestic</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.3</span>) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">180000</span>)<span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Body_Type)<span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Mileage"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.3: Relationship between Mileage, Condition, Age and Body Type"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Graph%201.3-1.4%20More%20Correlations-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ,subtitle = str_c("Correlation between Mileage and Condition ", " = ", MLG.AGE1))</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.4</span> <span class="ot">&lt;-</span> plot1<span class="fl">.3</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.4</span>) <span class="sc">+</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> Age_years, <span class="at">color=</span>odometer) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xlim(0, 200000)+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Body_Type)<span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Age"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.4: Relationship between Mileage, Age, Body Type and Condition"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Graph%201.3-1.4%20More%20Correlations-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ,subtitle = str_c("Correlation between Mileage and Condition ", " = ", MLG.AGE1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Keeping in mind the previous takeaways, graphs 1.3 and 1.4 illustrate the correlations by body type.</p>
<p>Unsurprisingly, among all body types, pickups and SUVs are least sensitive to mileage and age. This may be because most pickups and many SUVs are used for a wide range of purposes. They are engineered and designed to be driven more than other body types.</p>
<p>Insufficient data points to make conclusions about wagons and convertibles.</p>
</section>
<section id="correlation-mileage-age-body-condition-and-retained-value" class="level4">
<h4 class="anchored" data-anchor-id="correlation-mileage-age-body-condition-and-retained-value">Correlation: Mileage, Age, Body, Condition and Retained Value</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.1</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span><span class="fu">c</span>(passenger, pickup), RV_percent <span class="sc">&gt;</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>RV.MLG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">var</span>(plot2<span class="fl">.1</span><span class="sc">$</span>RV_percent, plot2<span class="fl">.1</span><span class="sc">$</span>odometer, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2<span class="fl">.1</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (odometer) , <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Mileage"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 2.1: Correlation between Retained Value and Mileage"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.MLG))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/RV_Mileage-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and condition</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.2</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Age_months)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>RV.CON <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(plot2<span class="fl">.2</span><span class="sc">$</span>RV_percent, plot2<span class="fl">.2</span><span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2<span class="fl">.2</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition, <span class="at">y =</span> (RV_percent)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Condition"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 2.2: Correlation between Retained Value and Condition"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.CON)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Graph%202.2%20RV_condition-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Graph 2.1 shows the inverse relationship and diminishing effect that mileage and age have on retained value. However, as seen in graph 2.2, on aggregate, retained value is more strongly correlated to the condition of the car than its mileage.</p>
</section>
<section id="auction-transactions-by-high-volume-states" class="level4">
<h4 class="anchored" data-anchor-id="auction-transactions-by-high-volume-states">Auction Transactions by High-Volume States</h4>
<p>This section aims to take a more comprehensive look at our data. I’ll analyze the states with the most transactions to see if there are any unique patterns to observe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyzing the number of transactions by state by the age </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>vol.states<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, state) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>vol.states <span class="sc">%&gt;%</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(state, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"dark blue"</span>) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"State"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Age_years))<span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Graph 3.1: Number of Transactions by State (Faceted by Age in Years)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From Graph 3.1 above, we see that most vehicles are auctioned between ages 2 and 4 years. This corresponds to the popular lease terms of 24 to 48 months.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>top.states <span class="ot">&lt;-</span> vol.states <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(state, Age_years) <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>plot3<span class="fl">.2</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(state<span class="sc">==</span>vol.states<span class="sc">$</span>state, Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup), RV_percent<span class="sc">&gt;</span> <span class="dv">15</span>, Annual_miles<span class="sc">&lt;</span><span class="dv">25000</span> ) </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and age</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>RV.AGE <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(plot3<span class="fl">.2</span><span class="sc">$</span>RV_percent, plot3<span class="fl">.2</span><span class="sc">$</span>Age_months, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot3<span class="fl">.2</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (Age_months),  <span class="at">color=</span> Annual_miles) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Age (Months)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 3.2: Retained Value vs Age in High Volume States"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.AGE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Auction%20by%20state-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Graph 3.2 shows that generally, across the states with the most auction transactions, vehicles experience similar depreciation curves and correlations between age and mileage.</p>
<p>I filtered for the annual miles driven <em>AnnualMiles</em> to be less than 25,000/ year to filter out vehicles used for commercial purposes. This was done because commercial vehicles (eg. rental cars, taxis, fleet vehicles, etc. ) add another layer of complexity that is beyond the scope of this paper.</p>
</section>
<section id="comparative-analysis" class="level4">
<h4 class="anchored" data-anchor-id="comparative-analysis">Comparative Analysis</h4>
<p>This section will delve into more specific analyses with the aim of providing additional insights.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Analysis by segment</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>by_segment <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">8</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment)) <span class="sc">%&gt;%</span> <span class="co">#, make==c(mainstream, luxury)) %&gt;% </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, Segment, sale_year, Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment_RV=</span> <span class="fu">round</span>(<span class="fu">mean</span>(RV_percent), <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Segment_RV)) <span class="sc">%&gt;%</span><span class="fu">arrange</span>((Age_years)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>((sale_year)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_segment) <span class="sc">+</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> Segment_RV, <span class="at">color =</span> <span class="st">`</span><span class="at">Segment</span><span class="st">`</span>, <span class="at">position=</span> <span class="st">"jitter"</span>), <span class="at">se=</span> F)<span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>,<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Age (Months)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">fill=</span> <span class="st">"Segment"</span>)<span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 4.1 Retained Value % by Segment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/by_segemnts-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the Segments with the highest RV</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>best_value_segments <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, <span class="st">"Pickup"</span>), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment), Segment <span class="sc">!=</span><span class="st">"HD Full-Size Pickup"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Segment,Age_years,  RV_percent, odometer, condition, model) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(Segment, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="at">Mileage=</span><span class="fu">mean</span>(odometer), <span class="at">Condition=</span><span class="fu">mean</span>(condition),  <span class="at">Sample_Size =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>((Age_years))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(best_value_segments))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

|Segment                  | Age_years| RV_percent|  Mileage| Condition| Sample_Size|
|:------------------------|---------:|----------:|--------:|---------:|-----------:|
|Mid-Size Pickup          |         2|   84.49062| 23863.53|  4.235938|          64|
|LD Full-Size Pickup      |         2|   65.05410| 24103.60|  4.165395|         708|
|Mid-Size SUV/Crossover   |         2|   62.48915| 31570.73|  4.113248|        1170|
|Subcompact SUV/Crossover |         2|   62.45069| 23784.00|  4.109972|         361|
|Compact SUV/Crossover    |         2|   60.55754| 31623.59|  4.147182|        1526|
|Full-Size SUV/Crossover  |         2|   59.17824| 37386.29|  3.983682|         239|
|Subcompact Car           |         2|   58.65251| 26016.39|  3.857011|         756|
|Compact Car              |         2|   57.62080| 28570.99|  3.850645|        2636|
|Sports Car               |         2|   51.65524| 26379.09|  3.810995|         382|
|Mid-Size Car             |         2|   50.26370| 30218.83|  3.895602|        3479|
|Minivan                  |         2|   48.67544| 38333.18|  3.810142|         562|
|Full-Size Car            |         2|   46.37824| 33590.26|  3.802490|         763|
|Mid-Size Pickup          |         3|   69.97907| 37121.28|  3.669767|          43|
|LD Full-Size Pickup      |         3|   61.14357| 43369.34|  3.918182|         319|
|Mid-Size SUV/Crossover   |         3|   53.53922| 40163.03|  3.974729|         645|
|Subcompact SUV/Crossover |         3|   52.79717| 38716.22|  3.824528|         106|
|Compact SUV/Crossover    |         3|   50.99491| 43130.34|  3.882127|         884|
|Compact Car              |         3|   49.83264| 36667.74|  3.636541|        1590|
|Full-Size SUV/Crossover  |         3|   48.60702| 48826.74|  3.700000|         114|
|Subcompact Car           |         3|   44.57835| 36470.44|  3.654464|         448|
|Sports Car               |         3|   44.01447| 37149.31|  3.594340|         159|
|Mid-Size Car             |         3|   41.90520| 38922.92|  3.649016|        2540|
|Minivan                  |         3|   38.73265| 59047.21|  3.515510|         247|
|Full-Size Car            |         3|   36.99537| 48094.70|  3.482927|         410|
|Mid-Size Pickup          |         4|   63.71803| 57009.02|  3.825410|         122|
|LD Full-Size Pickup      |         4|   57.18272| 57539.25|  3.756790|         648|
|Subcompact SUV/Crossover |         4|   49.24941| 49667.81|  3.642941|         170|
|Compact SUV/Crossover    |         4|   48.86856| 46028.75|  3.832457|        1673|
|Mid-Size SUV/Crossover   |         4|   48.09937| 48797.56|  3.858866|        1111|
|Full-Size SUV/Crossover  |         4|   46.27714| 61289.26|  3.845714|         140|
|Compact Car              |         4|   46.23107| 41537.70|  3.549270|        2330|
|Sports Car               |         4|   45.71592| 44484.68|  3.571144|         201|
|Subcompact Car           |         4|   43.42934| 46042.44|  3.575000|         484|
|Minivan                  |         4|   40.06356| 61850.17|  3.389894|         376|
|Mid-Size Car             |         4|   39.91684| 43051.56|  3.608307|        4059|
|Full-Size Car            |         4|   38.91142| 47993.60|  3.608391|         727|
|Mid-Size Pickup          |         5|   58.94933| 62382.53|  3.728000|          75|
|LD Full-Size Pickup      |         5|   56.89715| 68722.36|  3.613415|         246|
|Compact SUV/Crossover    |         5|   48.49789| 61335.65|  3.696677|         331|
|Sports Car               |         5|   44.80435| 62525.55|  3.401449|          69|
|Subcompact SUV/Crossover |         5|   42.87000| 65213.82|  3.363333|          60|
|Mid-Size SUV/Crossover   |         5|   42.75421| 69558.88|  3.680135|         297|
|Full-Size SUV/Crossover  |         5|   42.50333| 75887.97|  3.683333|          90|
|Compact Car              |         5|   40.57613| 61687.34|  3.242661|         513|
|Subcompact Car           |         5|   38.78800| 68058.28|  3.123000|         100|
|Mid-Size Car             |         5|   34.83214| 65151.75|  3.364083|         529|
|Minivan                  |         5|   34.31500| 84112.60|  3.111250|          80|
|Full-Size Car            |         5|   34.07561| 66903.28|  3.385366|         164|</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing a few missing fields in Segments that were missing in Catalog</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>BVS <span class="ot">&lt;-</span> best_value_segments <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Segment)) </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>BVS <span class="sc">%&gt;%</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_years, <span class="at">y =</span>(RV_percent)) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span> <span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">reorder</span>(Segment, <span class="sc">-</span>RV_percent))<span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Age (Years)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 4.2: Retained Value % vs. Age Ranked by Segment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/Best%20Segments-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graphical representation of data in Graphs 4.1 and 4.2 suggests that there is a hierarchy that exists among body types. Pickups have generally retained the best value across all years followed by SUVs and cars (sedans, coupes, convertibles, etc).</p>
</section>
<section id="bonus-section" class="level2">
<h2 class="anchored" data-anchor-id="bonus-section">Bonus Section</h2>
<section id="how-does-rv-compare-among-volume-models" class="level4">
<h4 class="anchored" data-anchor-id="how-does-rv-compare-among-volume-models">How does RV% compare among volume models?</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Volume models</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>vol.models<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&gt;</span><span class="dv">0</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>popular.models <span class="ot">&lt;-</span>  vol.models.passenger<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>)<span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 5.1: Most Auctioned Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/2.%20Volume%20models-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From Graph 5.1, it is easy to assume that the Nissan Altima is a highly sought-after vehicle and may therefore hold its value well. However, that may not be entirely true. Graph 5.2 will explore this further.</p>
<p><strong>Do the most auctioned vehicles retain the best value ?</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>BVM <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model<span class="sc">==</span> vol.models.passenger<span class="sc">$</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, odometer, condition, Segment) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),  <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>(<span class="fu">kable</span>(BVM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">make</th>
<th style="text-align: left;">model</th>
<th style="text-align: right;">Age_years</th>
<th style="text-align: right;">RV_percent</th>
<th style="text-align: right;">Error %</th>
<th style="text-align: right;">mileage</th>
<th style="text-align: right;">condition</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Escape</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">59.80893</td>
<td style="text-align: right;">5.371429</td>
<td style="text-align: right;">32660.32</td>
<td style="text-align: right;">4.105357</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Focus</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54.93243</td>
<td style="text-align: right;">5.670270</td>
<td style="text-align: right;">30007.46</td>
<td style="text-align: right;">4.068919</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Fusion</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">53.94091</td>
<td style="text-align: right;">5.018182</td>
<td style="text-align: right;">26895.30</td>
<td style="text-align: right;">4.066667</td>
<td style="text-align: right;">66</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dodge</td>
<td style="text-align: left;">Charger</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">52.56486</td>
<td style="text-align: right;">4.002703</td>
<td style="text-align: right;">27400.24</td>
<td style="text-align: right;">3.859459</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Toyota</td>
<td style="text-align: left;">Camry</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">51.63448</td>
<td style="text-align: right;">5.879310</td>
<td style="text-align: right;">32260.52</td>
<td style="text-align: right;">3.751724</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nissan</td>
<td style="text-align: left;">Altima</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">50.76418</td>
<td style="text-align: right;">4.607463</td>
<td style="text-align: right;">32063.15</td>
<td style="text-align: right;">3.797015</td>
<td style="text-align: right;">67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dodge</td>
<td style="text-align: left;">Grand Caravan</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">43.03421</td>
<td style="text-align: right;">6.200000</td>
<td style="text-align: right;">43253.37</td>
<td style="text-align: right;">3.742105</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">INFINITI</td>
<td style="text-align: left;">G37</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">40.27436</td>
<td style="text-align: right;">3.200000</td>
<td style="text-align: right;">21123.33</td>
<td style="text-align: right;">4.069231</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chevrolet</td>
<td style="text-align: left;">Impala</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">37.74390</td>
<td style="text-align: right;">3.300000</td>
<td style="text-align: right;">45675.93</td>
<td style="text-align: right;">3.465854</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Escape</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">51.96250</td>
<td style="text-align: right;">5.818750</td>
<td style="text-align: right;">39425.44</td>
<td style="text-align: right;">3.896875</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Focus</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">45.75909</td>
<td style="text-align: right;">4.818182</td>
<td style="text-align: right;">41420.00</td>
<td style="text-align: right;">3.945454</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toyota</td>
<td style="text-align: left;">Camry</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">45.49048</td>
<td style="text-align: right;">5.928571</td>
<td style="text-align: right;">41978.05</td>
<td style="text-align: right;">3.519048</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Fusion</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">44.69697</td>
<td style="text-align: right;">5.978788</td>
<td style="text-align: right;">45612.97</td>
<td style="text-align: right;">3.896970</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nissan</td>
<td style="text-align: left;">Altima</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">41.21406</td>
<td style="text-align: right;">4.793750</td>
<td style="text-align: right;">38131.33</td>
<td style="text-align: right;">3.482813</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">INFINITI</td>
<td style="text-align: left;">G37</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">36.94400</td>
<td style="text-align: right;">3.144000</td>
<td style="text-align: right;">23883.64</td>
<td style="text-align: right;">3.896000</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chevrolet</td>
<td style="text-align: left;">Impala</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">30.49630</td>
<td style="text-align: right;">2.703704</td>
<td style="text-align: right;">56683.44</td>
<td style="text-align: right;">3.311111</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Focus</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">44.11364</td>
<td style="text-align: right;">3.872727</td>
<td style="text-align: right;">51600.68</td>
<td style="text-align: right;">3.709091</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toyota</td>
<td style="text-align: left;">Camry</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">43.64286</td>
<td style="text-align: right;">5.735714</td>
<td style="text-align: right;">39723.24</td>
<td style="text-align: right;">3.280952</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Honda</td>
<td style="text-align: left;">Accord</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">40.65000</td>
<td style="text-align: right;">3.453125</td>
<td style="text-align: right;">40321.59</td>
<td style="text-align: right;">3.281250</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Escape</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">40.50000</td>
<td style="text-align: right;">6.360606</td>
<td style="text-align: right;">48104.48</td>
<td style="text-align: right;">3.906061</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nissan</td>
<td style="text-align: left;">Altima</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">39.35612</td>
<td style="text-align: right;">5.263265</td>
<td style="text-align: right;">40394.43</td>
<td style="text-align: right;">3.583674</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ford</td>
<td style="text-align: left;">Fusion</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">38.64286</td>
<td style="text-align: right;">6.714286</td>
<td style="text-align: right;">54026.71</td>
<td style="text-align: right;">3.592857</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">INFINITI</td>
<td style="text-align: left;">G37</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">38.01042</td>
<td style="text-align: right;">3.000000</td>
<td style="text-align: right;">35770.04</td>
<td style="text-align: right;">3.814583</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chevrolet</td>
<td style="text-align: left;">Impala</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">28.63704</td>
<td style="text-align: right;">2.137037</td>
<td style="text-align: right;">62979.44</td>
<td style="text-align: right;">3.307407</td>
<td style="text-align: right;">27</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Graph 5.2 shows that the most auctioned vehicles do not necessarily retain the best value. This may be due to an oversupply of these vehicles at auction, and with a higher supply, a lower price often follows.</p>
<p>Another reason could be low consumer sentiment toward these vehicles. After looking at the nature of the sellers, one can conclude that most of these vehicles are lease returns. Vehicles with high lease returns can imply a low consumer sentiment, therefore decreasing the long-term resale value.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>vol.p.models <span class="ot">&lt;-</span> vol.models.passenger<span class="sc">$</span>model <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>vol.vs.best.passenger <span class="ot">&lt;-</span> BVM <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model<span class="sc">==</span> vol.p.models)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>BVM <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>RV_percent), <span class="at">y=</span> RV_percent) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">fill=</span> <span class="st">"dark orange"</span> ) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Mean Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 5.2: Retained values of the Most Auctioned Models"</span> , <span class="at">subtitle =</span> <span class="st">"Mean Retained Value Percentage from Year 2 to 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="OwenTibbyFinalProject601_submission_files/figure-html/2.%20Models%20with%20best%20RV-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="best-mainstream-cars-to-buy-post-2015" class="level4">
<h4 class="anchored" data-anchor-id="best-mainstream-cars-to-buy-post-2015">Best mainstream cars to buy post-2015</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>best_value_models <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, odometer, condition, Segment) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),  <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(best_value_models, <span class="at">caption=</span> <span class="st">"Passengers Cars with Best RV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: Passengers Cars with Best RV

|make          |model             | Age_years| RV_percent|   Error %|  mileage| condition|   n|
|:-------------|:-----------------|---------:|----------:|---------:|--------:|---------:|---:|
|Jeep          |Wrangler          |         2|   86.01758| 4.3000000| 20580.66|  4.551648|  91|
|BMW           |4 Series          |         2|   77.63913| 3.4000000| 10463.70|  4.413043|  23|
|Jeep          |Cherokee          |         2|   75.13750| 2.5000000| 19183.85|  4.295833|  48|
|Toyota        |Corolla           |         2|   73.25143| 3.7000000| 22960.35|  3.816190| 105|
|GMC           |Acadia            |         2|   70.34545| 4.5000000| 24056.27|  4.281818|  22|
|Nissan        |Versa Note        |         2|   70.17021| 4.7000000| 17958.79|  4.031915|  47|
|Subaru        |Impreza           |         2|   70.00741| 2.9000000| 19390.85|  4.137037|  27|
|Subaru        |Forester          |         2|   69.92857| 3.7178571| 29487.36|  4.185714|  28|
|Subaru        |Outback           |         2|   69.26308| 3.8615385| 27320.11|  4.324615|  65|
|Mercedes-Benz |GLK-Class         |         2|   68.75676| 1.7945946| 24537.11|  4.237838|  37|
|Subaru        |Legacy            |         2|   68.14815| 4.5000000| 18589.44|  4.437037|  27|
|Dodge         |Durango           |         2|   67.41754| 3.8701754| 28284.00|  4.330702| 114|
|Honda         |CR-V              |         2|   66.99825| 4.6421053| 23874.30|  4.161403|  57|
|Ford          |Escape            |         2|   66.94753| 4.8000000| 28125.73|  4.154321| 162|
|Nissan        |Sentra            |         2|   66.43500| 4.9000000| 27945.42|  3.745000| 120|
|INFINITI      |Q50               |         2|   66.01951| 4.0000000| 16612.83|  4.075610|  41|
|Ford          |Expedition        |         2|   66.01094| 2.7125000| 30222.42|  4.381250|  64|
|FORD          |FUSION            |         2|   65.81795| 4.7000000| 32849.51|  4.120513|  39|
|INFINITI      |JX35              |         2|   65.78182| 0.0000000| 37006.95|  3.827273|  22|
|Honda         |Civic             |         2|   65.74870| 4.4000000| 20880.17|  3.703478| 115|
|Chevrolet     |Tahoe             |         2|   65.53418| 3.9341772| 43381.96|  3.941772|  79|
|Honda         |Pilot             |         2|   65.27895| 4.8000000| 26278.13|  4.405263|  38|
|Ford          |Explorer          |         2|   65.15935| 4.9000000| 37372.12|  4.013415| 248|
|Toyota        |RAV4              |         2|   64.64468| 4.9000000| 43028.23|  3.844681|  47|
|Jeep          |Compass           |         2|   63.02941| 3.1705882| 25850.37|  3.990196|  51|
|Toyota        |Venza             |         2|   62.92727| 2.3181818| 37372.82|  3.795454|  22|
|Lincoln       |MKX               |         2|   62.45714| 0.0000000| 24495.98|  4.382143|  56|
|Jeep          |Patriot           |         2|   61.94444| 3.2875000| 27918.83|  3.979167|  72|
|Honda         |Accord            |         2|   61.91981| 3.3000000| 21560.34|  3.904717| 106|
|HYUNDAI       |SANTA FE          |         2|   61.59630| 4.3000000| 22150.04|  4.066667|  27|
|Hyundai       |Accent            |         2|   60.31239| 2.7982301| 32131.84|  3.645133| 113|
|Hyundai       |Santa Fe          |         2|   60.24667| 2.9500000| 34383.43|  4.243333|  30|
|Ford          |Edge              |         2|   60.19865| 4.3407407| 29632.14|  4.168350| 297|
|BMW           |3 Series          |         2|   59.97794| 3.5441176| 21352.10|  4.235294|  68|
|Hyundai       |Veloster          |         2|   59.82917| 3.4250000| 19199.08|  3.962500|  24|
|Ford          |Fiesta            |         2|   59.62087| 4.0404348| 28080.17|  3.996957| 230|
|Chevrolet     |Cruze             |         2|   59.39677| 4.3705069| 32445.41|  3.726728| 434|
|Lincoln       |MKZ               |         2|   59.17288| 3.6135593| 27934.53|  3.993220|  59|
|Audi          |A4                |         2|   59.09655| 3.1000000| 23538.52|  4.113793|  29|
|Chevrolet     |Suburban          |         2|   58.27467| 3.4400000| 45680.87|  3.742667|  75|
|GMC           |Terrain           |         2|   58.20926| 2.9629630| 29662.24|  4.175926|  54|
|Toyota        |Camry Hybrid      |         2|   58.01724| 2.4551724| 52920.24|  3.827586|  29|
|Toyota        |Prius             |         2|   57.60000| 0.0000000| 39000.53|  3.828889|  45|
|Kia           |Rio               |         2|   57.48706| 3.3482353| 24315.29|  3.796471|  85|
|Ford          |Fusion            |         2|   56.95585| 4.7000000| 29392.94|  4.018729| 299|
|Kia           |Forte             |         2|   56.76382| 4.5197368| 25516.53|  3.965790| 152|
|Kia           |Soul              |         2|   56.64366| 4.4415493| 26490.04|  4.057042| 142|
|Nissan        |Xterra            |         2|   56.34545| 2.6060606| 29998.09|  4.275758|  33|
|Hyundai       |Elantra           |         2|   56.19311| 3.2101639| 32625.45|  3.751148| 305|
|Jeep          |Grand Cherokee    |         2|   56.14301| 4.6709677| 28248.74|  4.338710|  93|
|FIAT          |500L              |         2|   55.99667| 3.7000000| 15683.33|  3.946667|  30|
|Nissan        |Pathfinder        |         2|   55.98182| 4.9000000| 38281.15|  3.878788|  33|
|GMC           |SAVANA            |         2|   55.83457| 2.8000000|  9982.42|  4.019753|  81|
|Dodge         |Dart              |         2|   55.76623| 3.0870130| 23011.52|  3.833766|  77|
|Kia           |Sorento           |         2|   54.32987| 4.2000000| 37149.03|  4.176623|  77|
|Toyota        |Avalon            |         2|   53.99524| 2.7714286| 28262.24|  3.676191|  21|
|Chrysler      |300               |         2|   53.95328| 2.2934426| 20879.19|  4.071312| 122|
|Toyota        |Sienna            |         2|   52.97969| 4.9000000| 50011.92|  3.328125|  64|
|Dodge         |Charger           |         2|   52.67958| 3.9783784| 25396.25|  3.830931| 333|
|Mazda         |Mazda5            |         2|   52.32812| 3.7000000| 42385.16|  3.881250|  32|
|Lincoln       |Navigator         |         2|   52.25294| 0.0000000| 32941.73|  4.147059|  51|
|FIAT          |500               |         2|   51.46765| 4.7735294| 22999.85|  4.108823|  34|
|Chevrolet     |Sonic             |         2|   51.28548| 4.5612903| 30371.71|  3.675000| 124|
|Volkswagen    |Jetta             |         2|   51.22667| 4.8391667| 32209.28|  3.727500| 120|
|Kia           |Optima            |         2|   50.68600| 4.1000000| 36728.58|  3.728000| 100|
|Chevrolet     |Traverse          |         2|   49.00820| 4.8000000| 41554.28|  3.914754|  61|
|Chevrolet     |Equinox           |         2|   48.76236| 2.9528090| 47249.62|  3.961236| 178|
|GMC           |Yukon XL          |         2|   48.65833| 3.1750000| 51680.88|  3.704167|  24|
|Buick         |LaCrosse          |         2|   48.16296| 2.7444444| 37040.11|  3.759259|  27|
|Nissan        |Altima            |         2|   47.72500| 4.1000000| 35259.59|  3.787393| 468|
|Volkswagen    |Passat            |         2|   47.06605| 3.0715596| 39397.33|  3.747706| 109|
|FORD          |E-350             |         2|   47.00460| 1.5275862| 28985.15|  4.006897|  87|
|Volkswagen    |Beetle            |         2|   46.64167| 3.1666667| 25872.67|  3.904167|  24|
|CHEVROLET     |IMPALA            |         2|   45.22981| 4.1000000| 20998.53|  3.725961| 104|
|Chevrolet     |Camaro            |         2|   44.90741| 4.6000000| 34273.46|  3.477778|  54|
|Lincoln       |MKS               |         2|   44.73000| 4.5000000| 28769.10|  4.015000|  20|
|Nissan        |Maxima            |         2|   43.70693| 0.0000000| 40495.78|  3.629703| 101|
|Buick         |Regal             |         2|   43.63333| 2.2428571| 30861.29|  3.838095|  21|
|Chevrolet     |Malibu            |         2|   43.43846| 3.0000000| 41455.15|  3.652308| 130|
|Hyundai       |Sonata            |         2|   43.27382| 3.2000000| 36382.62|  3.816754| 191|
|Chevrolet     |Impala            |         2|   41.39091| 1.2263158| 41388.05|  3.441627| 211|
|INFINITI      |G37               |         2|   40.44035| 3.2000000| 21670.57|  4.022807| 342|
|Ford          |C-Max Energi      |         2|   33.81351| 0.0000000| 54144.97|  3.905405|  37|
|Jeep          |Wrangler          |         3|   71.61875| 3.7750000| 35712.94|  4.085417|  48|
|INFINITI      |JX35              |         3|   65.75714| 0.0000000| 38125.10|  3.980952|  21|
|Nissan        |Sentra            |         3|   64.52836| 4.9000000| 25291.78|  3.770149|  67|
|Toyota        |RAV4              |         3|   63.29111| 4.9000000| 43456.78|  3.857778|  45|
|Honda         |CR-V              |         3|   60.71282| 4.5358974| 36615.13|  4.100000|  39|
|Ford          |Explorer          |         3|   60.43046| 4.8072848| 43170.23|  3.885431| 151|
|Mercedes-Benz |GLK-Class         |         3|   58.55172| 1.8758621| 35145.90|  3.989655|  29|
|Toyota        |Sienna            |         3|   56.21071| 4.8571429| 47409.21|  3.385714|  28|
|Hyundai       |Accent            |         3|   55.46000| 2.6250000| 36618.82|  3.385000|  40|
|Hyundai       |Santa Fe          |         3|   55.39130| 3.4521739| 37180.09|  4.026087|  23|
|Chevrolet     |Tahoe             |         3|   55.35128| 4.1153846| 48663.49|  4.015385|  39|
|Lincoln       |MKX               |         3|   54.81290| 0.0000000| 29539.19|  3.925807|  31|
|Ford          |Edge              |         3|   54.52848| 4.6000000| 36691.99|  4.040000| 165|
|Honda         |Pilot             |         3|   54.51569| 4.8000000| 37825.63|  3.729412|  51|
|Honda         |Civic             |         3|   54.50256| 4.4807692| 32930.03|  3.392949| 156|
|Hyundai       |Elantra           |         3|   54.36608| 3.1699647| 30497.44|  3.709541| 283|
|Nissan        |Pathfinder        |         3|   52.74167| 4.9000000| 43492.21|  3.433333|  24|
|Dodge         |Dart              |         3|   52.73830| 2.8000000| 34579.32|  3.455319|  47|
|LEXUS         |ES                |         3|   51.63871| 0.0000000| 27737.00|  3.664516|  31|
|GMC           |Acadia            |         3|   50.96364| 4.5000000| 47060.68|  3.940909|  22|
|Dodge         |Durango           |         3|   50.93488| 3.8930233| 42862.72|  3.904651|  43|
|Mazda         |Mazda3            |         3|   49.81905| 4.3000000| 34426.67|  3.547619|  21|
|Kia           |Optima            |         3|   49.03590| 4.1000000| 37632.88|  3.642308|  78|
|Nissan        |Versa             |         3|   48.90952| 3.8000000| 47725.57|  3.247619|  21|
|Chevrolet     |Cruze             |         3|   48.42838| 4.4891892| 49285.97|  3.312162| 148|
|Ford          |Fiesta            |         3|   48.33125| 4.1500000| 43942.94|  3.900000|  48|
|Audi          |A4                |         3|   48.30625| 2.8500000| 31768.03|  3.518750|  32|
|Jeep          |Grand Cherokee    |         3|   48.27143| 4.0714286| 38348.69|  4.261905|  42|
|BMW           |3 Series          |         3|   47.76333| 3.9633333| 31383.45|  4.036667|  60|
|Acura         |TSX               |         3|   47.29722| 3.1972222| 33591.17|  3.686111|  36|
|Toyota        |Prius             |         3|   46.66500| 0.0000000| 48570.85|  3.675000|  20|
|Kia           |Soul              |         3|   46.65000| 4.3640000| 39954.70|  3.710000|  50|
|Chrysler      |300               |         3|   46.54146| 2.4268293| 40909.68|  3.963415|  41|
|Kia           |Sorento           |         3|   46.07667| 4.4166667| 42597.77|  4.010000|  30|
|Chevrolet     |Camaro            |         3|   45.67059| 4.4823529| 36956.50|  3.438235|  34|
|Volkswagen    |Jetta             |         3|   45.37532| 4.4883117| 38001.36|  3.358442|  77|
|Lincoln       |MKZ               |         3|   45.22394| 2.4661972| 28236.54|  3.898592|  71|
|Honda         |Accord            |         3|   44.64216| 3.4686486| 33459.25|  3.463243| 185|
|Dodge         |Charger           |         3|   44.60811| 3.7945946| 44637.21|  3.473874| 111|
|Nissan        |Altima            |         3|   44.50635| 4.1000000| 39511.74|  3.561905| 252|
|Cadillac      |SRX               |         3|   44.38500| 3.3000000| 43314.55|  4.205000|  20|
|Kia           |Forte             |         3|   43.51000| 4.6000000| 48393.67|  3.600000|  30|
|Hyundai       |Sonata            |         3|   43.47830| 3.2000000| 32270.52|  3.860377| 106|
|Acura         |TL                |         3|   43.32791| 3.1976744| 35469.05|  3.548837|  43|
|Chevrolet     |Equinox           |         3|   43.06573| 2.7825175| 55362.20|  3.783916| 143|
|Ford          |Focus             |         3|   42.85327| 3.4000000| 46549.72|  3.690654| 107|
|Mazda         |Mazda5            |         3|   42.20000| 3.6500000| 50315.96|  3.291667|  24|
|Chevrolet     |Malibu            |         3|   41.72375| 3.0000000| 46994.26|  3.345000|  80|
|Chevrolet     |Sonic             |         3|   41.24321| 4.7962963| 46250.40|  3.301235|  81|
|Nissan        |Maxima            |         3|   40.47798| 0.0000000| 44073.43|  3.494495| 109|
|Volkswagen    |Passat            |         3|   39.28133| 3.2573333| 44069.43|  3.406667|  75|
|INFINITI      |G37               |         3|   39.24766| 3.1437500| 24226.81|  3.978906| 256|
|Jeep          |Liberty           |         3|   39.12692| 3.6000000| 52681.38|  3.861538|  26|
|Chevrolet     |Traverse          |         3|   36.26923| 4.3615385| 55017.27|  3.776923|  26|
|Chevrolet     |Impala            |         3|   30.75497| 0.2251462| 55432.18|  3.361988| 171|
|Chevrolet     |Volt              |         3|   30.53810| 0.0000000| 54729.71|  3.857143|  21|
|Jeep          |Wrangler          |         4|   75.20741| 2.9888889| 42801.36|  4.300000|  81|
|Subaru        |Impreza           |         4|   67.69259| 3.6962963| 39555.85|  3.507407|  27|
|Toyota        |Venza             |         4|   61.15909| 2.0000000| 39317.82|  4.054545|  22|
|Ford          |Explorer          |         4|   58.60196| 4.5000000| 50376.91|  3.871569| 102|
|Lexus         |CT 200h           |         4|   57.79583| 0.0000000| 35932.88|  3.712500|  24|
|Audi          |Q5                |         4|   57.32059| 3.9000000| 51596.26|  4.023529|  34|
|Honda         |CR-V              |         4|   56.23788| 4.5431818| 40221.67|  3.818182| 132|
|Mercedes-Benz |GLK-Class         |         4|   55.13077| 2.2000000| 37288.62|  3.896154|  26|
|Subaru        |Forester          |         4|   54.71481| 3.8444444| 48844.67|  3.725926|  27|
|MINI          |Cooper Countryman |         4|   53.85217| 3.8347826| 44235.48|  4.069565|  23|
|Toyota        |RAV4              |         4|   53.72235| 3.3000000| 36436.60|  3.804706|  85|
|Ford          |Expedition        |         4|   53.00937| 2.8000000| 60793.34|  3.925000|  32|
|Toyota        |Sienna            |         4|   52.66667| 4.8000000| 53710.91|  3.372727|  33|
|Honda         |Civic             |         4|   52.57509| 4.4762264| 37476.50|  3.323774| 265|
|Scion         |tC                |         4|   52.50000| 2.5100000| 46759.65|  3.345000|  20|
|Hyundai       |Elantra           |         4|   52.22784| 3.4350515| 40491.87|  3.551546|  97|
|Toyota        |Prius             |         4|   51.12903| 0.0000000| 45233.87|  3.717742|  62|
|Ford          |Edge              |         4|   50.97045| 3.4761364| 43969.42|  3.969886| 176|
|INFINITI      |QX56              |         4|   50.61034| 0.0000000| 58183.31|  3.817241|  29|
|Jeep          |Compass           |         4|   50.58182| 2.7181818| 52089.86|  3.672727|  22|
|Toyota        |Yaris             |         4|   50.53226| 4.8000000| 50187.90|  3.235484|  31|
|Dodge         |Durango           |         4|   50.33409| 3.7113636| 52097.09|  3.777273|  44|
|Honda         |Pilot             |         4|   50.17882| 4.8000000| 47525.02|  3.737647|  85|
|Chevrolet     |Camaro            |         4|   49.75714| 3.9500000| 41388.69|  3.828571|  70|
|Chevrolet     |Tahoe             |         4|   49.31053| 4.0657895| 68148.87|  3.665789|  38|
|Jeep          |Grand Cherokee    |         4|   49.24959| 4.0024390| 47589.85|  4.069919| 123|
|LEXUS         |ES                |         4|   48.72388| 0.0000000| 33727.04|  3.425373|  67|
|Lincoln       |MKX               |         4|   48.10857| 0.0000000| 44200.06|  3.877143|  35|
|Subaru        |Outback           |         4|   48.09375| 3.7468750| 63853.06|  3.696875|  32|
|Ford          |Fiesta            |         4|   48.03623| 4.4405797| 48355.91|  3.775362|  69|
|Mazda         |Mazda3            |         4|   47.47419| 4.3000000| 44949.55|  3.351613|  62|
|GMC           |Acadia            |         4|   47.40779| 4.5441558| 48458.53|  3.864935|  77|
|Kia           |Optima            |         4|   47.14811| 4.1000000| 38191.49|  3.704717| 106|
|Hyundai       |Santa Fe          |         4|   46.72692| 4.3000000| 54209.92|  3.776923|  26|
|Acura         |TSX               |         4|   46.55806| 3.2338710| 35527.16|  3.601613|  62|
|Kia           |Soul              |         4|   46.52222| 3.7698413| 47183.29|  3.549206|  63|
|Chevrolet     |Cruze             |         4|   46.50952| 4.2000000| 50090.81|  3.493651| 126|
|GMC           |Terrain           |         4|   46.19615| 2.4673077| 59465.44|  4.036538|  52|
|Dodge         |Charger           |         4|   45.67246| 3.5434783| 57199.70|  3.581159|  69|
|Cadillac      |SRX               |         4|   45.38431| 3.6764706| 39831.75|  3.803922|  51|
|Hyundai       |Accent            |         4|   45.34324| 3.0621622| 52956.81|  3.121622|  37|
|Audi          |A4                |         4|   44.86735| 2.5204082| 38563.92|  3.542857|  49|
|BMW           |3 Series          |         4|   44.27928| 3.4432432| 36599.33|  3.978679| 333|
|Jeep          |Patriot           |         4|   44.02500| 3.0250000| 58410.16|  3.381250|  32|
|Nissan        |Versa             |         4|   43.88049| 3.8878049| 55532.85|  3.086585|  82|
|Nissan        |Maxima            |         4|   43.59048| 0.0000000| 38026.68|  3.641604| 399|
|Buick         |Enclave           |         4|   43.54242| 3.6969697| 56386.21|  3.875758|  33|
|Ford          |Focus             |         4|   43.50830| 3.4000000| 45173.65|  3.722707| 229|
|Acura         |TL                |         4|   43.22727| 3.2136364| 36481.30|  3.693939|  66|
|BMW           |5 Series          |         4|   42.88000| 4.2000000| 48081.27|  3.886667|  30|
|Chrysler      |300               |         4|   42.42273| 3.1000000| 49107.95|  3.527273|  22|
|Honda         |Accord            |         4|   42.41246| 3.4483283| 38273.13|  3.450456| 329|
|Volkswagen    |Jetta             |         4|   42.33014| 4.2506849| 51149.84|  3.064384| 146|
|Kia           |Rio               |         4|   42.14500| 3.1300000| 52014.50|  3.360000|  20|
|Chevrolet     |Equinox           |         4|   40.78000| 2.6700000| 63188.88|  3.845625| 160|
|Cadillac      |CTS               |         4|   40.33673| 2.5346939| 38945.00|  3.934694|  49|
|Buick         |LaCrosse          |         4|   40.19730| 3.1729730| 52565.89|  3.881081|  37|
|BMW           |6 Series          |         4|   40.18837| 1.6000000| 32316.05|  4.048837|  43|
|Jeep          |Liberty           |         4|   39.92308| 3.4153846| 57545.36|  3.898718|  78|
|Kia           |Forte             |         4|   39.80517| 4.5120690| 53322.69|  3.232759|  58|
|Kia           |Sorento           |         4|   39.73827| 3.6876543| 63941.74|  3.790123|  81|
|INFINITI      |G37               |         4|   37.71002| 3.0000000| 35357.35|  3.795918| 539|
|Volkswagen    |Passat            |         4|   37.59808| 3.3000000| 39239.24|  3.173077| 104|
|Chevrolet     |Sonic             |         4|   36.81333| 4.2000000| 52144.40|  3.526667|  30|
|Lincoln       |MKZ               |         4|   36.78070| 1.7210526| 30884.04|  3.722807|  57|
|Chevrolet     |Traverse          |         4|   36.68434| 4.2000000| 56128.76|  3.781928|  83|
|Lincoln       |MKS               |         4|   35.97826| 3.3652174| 48471.30|  3.721739|  23|
|Hyundai       |Sonata            |         4|   35.90896| 4.7000000| 67052.13|  3.322388|  67|
|Nissan        |Altima            |         4|   35.44706| 4.9000000| 57169.67|  3.390588|  85|
|Buick         |Regal             |         4|   35.15000| 2.2681818| 40792.77|  3.490909|  22|
|Chevrolet     |Aveo              |         4|   29.87000| 3.5000000| 71829.75|  2.920000|  20|
|Chevrolet     |Volt              |         4|   29.78148| 0.0000000| 52625.59|  3.785185|  27|
|Chevrolet     |Impala            |         4|   27.49082| 1.6990338| 71288.84|  3.237198| 207|
|Chevrolet     |HHR               |         4|   26.44483| 3.3000000| 83317.52|  3.172414|  29|
|NISSAN        |LEAF              |         4|   26.13492| 2.0000000| 20135.89|  4.234921|  63|
|Jeep          |Wrangler          |         5|   78.32105| 2.9947368| 55195.53|  4.057895|  38|
|Chevrolet     |Camaro            |         5|   52.46944| 4.0666667| 51603.28|  3.494444|  36|
|Chevrolet     |Tahoe             |         5|   51.20909| 3.9318182| 81026.32|  3.740909|  22|
|Honda         |CR-V              |         5|   50.10714| 4.6000000| 62472.29|  3.685714|  28|
|Toyota        |RAV4              |         5|   50.08667| 3.2333333| 49581.80|  3.553333|  30|
|Honda         |Civic             |         5|   45.74762| 3.6761905| 67440.90|  2.952381|  21|
|Jeep          |Grand Cherokee    |         5|   43.58000| 3.9100000| 71344.35|  3.775000|  20|
|Nissan        |Maxima            |         5|   41.72857| 0.3857143| 45851.00|  3.307936|  63|
|BMW           |3 Series          |         5|   39.89468| 2.8148936| 46153.87|  3.747872|  94|
|Chevrolet     |Equinox           |         5|   39.25789| 2.8657895| 80041.71|  3.647368|  38|
|INFINITI      |G37               |         5|   39.16471| 3.0191176| 37705.79|  3.848529|  68|
|Kia           |Soul              |         5|   39.04412| 3.3000000| 80797.09|  3.264706|  34|
|Honda         |Accord            |         5|   37.88077| 2.8615385| 70439.73|  3.084615|  26|
|Volkswagen    |Jetta             |         5|   37.68667| 3.5800000| 68689.33|  2.860000|  30|
|Ford          |Edge              |         5|   36.96667| 0.9800000| 71057.47|  3.653333|  30|
|Kia           |Sorento           |         5|   36.25862| 2.7000000| 88477.97|  3.703448|  29|
|BMW           |5 Series          |         5|   35.42000| 4.1800000| 58319.00|  3.495000|  20|
|Chevrolet     |Traverse          |         5|   34.70000| 4.2000000| 70663.95|  3.463636|  22|
|Hyundai       |Sonata            |         5|   34.47755| 4.6510204| 76378.59|  3.234694|  49|
|Dodge         |Charger           |         5|   33.86207| 2.7344828| 78959.48|  2.924138|  29|
|Nissan        |Altima            |         5|   33.25417| 4.8500000| 86557.52|  3.175000|  48|
|Chevrolet     |HHR               |         5|   29.40500| 3.3000000| 77872.90|  3.275000|  20|
|Chevrolet     |Impala            |         5|   25.73364| 2.0439252| 85397.18|  3.039252| 107|</code></pre>
</div>
</div>
<p>While I won’t be making any formal recommendations in this paper, the above table provides a guide on which vehicles can be expected to retain good value in the future. Please pay close attention to the error rating and the sample size.</p>
</section>
</section>
</section>
<section id="reflection" class="level1">
<h1><strong>Reflection</strong></h1>
<p>This project, though very time-consuming, has truly been worth every moment spent working on it. Possessing a solid foundation in MS Excel (my daily tool for analysis at work), it took some getting used to, and at times felt counterproductive trying to accomplish the same things in R. Although I’m new to programming, I intentionally chose to do as challenging a project as I possibly could with the knowledge I’ve learned in this course. The data that I used is almost identical to the type of data I analyze at work and is an area of great interest for me- the used car market. Despite the intrigue, I was a bit overwhelmed with the amount of tidying that was needed to complete the analysis. In truth, more time was spent on cleaning the data than anything else.</p>
<p>An issue I had to contend with was that Canadian vehicle trims do not always have the same naming conventions as US trims. For example, a 2021 VW Jetta Highline in Canada may be listed as a 2021 VW Jetta SE/ SEL in the US. This, however, simplified the joining of the datasets because I was better able to match the YMM in both the auction data (carprices.csv) and the catalog now in USD (us_catalog).</p>
<p>However, after joining the catalog I had 50,342 unmatched records that would be later passed through an iteration map function using the vindecoder() package. Subsequently, I still had to contend with 20,826 (out of 50,342 records) missing unmatched keys/MSRP values. Observing the distribution of vehicles in unmatched_keys (see appendix E), I was able to identify which models had a low map rate in the VIN decoder. After about 12 lines of code, I was able to clean an additional 6,860 records, leaving the total unmatched at 13,965.</p>
<p>Instead of deleting them entirely, I saved them in a CSV file named ‘unmatched_keys.csv’. As I progress through the DACSS program, I aim to practice more advanced ways to handle these situations. If time permits, my strategy to handle these untidy fields and unmatched_keys would be to use functions str_detect() and advanced mapping functions to clean the data as best as possible.</p>
<p>Despite 13,965 out of 457,588 records (3%) of records not being matched, I do not believe that it will have a significant impact on the results. The unmatched records were due to the unavailability in the Canadian market of some US models as well as naming inconsistencies across YMM fields. Due to the fact I am mainly conducting my analysis on high-volume vehicle segments and models, this will only have a marginal to negligible effect on the quality of results.</p>
<p>There are far more insights that can be drawn from this data. For example, comparing the average yearly mileage by state, comparing resale values for vehicles in colder states vs warmer states, as well as the popularity and distribution of various makes across the US. Those are just a few of the burning questions that I have not been able to address in this project. What is certain is that I will be continuing to work on this data with the hope to manipulate similar vehicle data for the Canadian wholesale marketplace for more work-related reasons.</p>
</section>
<section id="conclusion" class="level1">
<h1><strong>Conclusion</strong></h1>
<p>The data analyzed was able to substantially answer the research question. Indeed factors like body type, vehicle condition, mileage, and age affect the retained value of vehicles. Excluding age for trivial reasons, overall, the condition had the largest impact (positive) followed by mileage (negative) of all the variables on RV. However, some segments were more sensitive to this effect than others. For example, convertibles were slightly more sensitive to mileage than any other body type; a stark contrast when compared to pickups and SUVs.</p>
<p>Bearing in mind the key assumptions made when converting the MSRP from CAD to USD, I was quite surprised at how accurate the results were compared to actual public residual value data. It seems as though the pricing for Canadian trims coincides greatly with their US counterparts. Another observation was that the most auctioned/sold vehicles do not necessarily retain the best value. Despite, the higher error rating among various segments, I believe the estimation of RV% (based on dividing the auction price by mean MSRP), provides a solid understanding, once analyzed on aggregate and in context.</p>
<p>The data suggests that except for pickups, SUVs- subcompact, compact and midsize, hold better value than standard passenger car body types. There seems to also be a resistance to price as vehicles with higher MSRPs tend to retain less value over time. This was evident when looking at graphs 4.1 and 4.2, where a clear hierarchy among body types and segments is observed.</p>
</section>
<section id="bibliography" class="level1">
<h1><strong>Bibliography</strong></h1>
<section id="data-sources" class="level4">
<h4 class="anchored" data-anchor-id="data-sources"><em>Data Sources:</em></h4>
<p>Kaggle: <a href="https://www.kaggle.com/datasets/tunguz/used-car-auction-prices">Used Car Auction Prices | Kaggle</a></p>
<p>WSJ Markets: <a href="https://www.wsj.com/market-data/quotes/fx/USDCAD/historical-prices">USD to CAD | Canadian Dollar Historical Prices - WSJ</a></p>
</section>
<section id="methodology" class="level4">
<h4 class="anchored" data-anchor-id="methodology"><em>Methodology:</em></h4>
<p><em>DACSS Faculty</em>, University of Massachusetts, Amherst</p>
<p>Grolemund, G., &amp; Wickham, H. (2017). <em>R for Data Science</em>. O’Reilly Media.</p>
<p>The National Highway Traffic Safety Administration: <a href="https://www.nhtsa.gov/vin-decoder">VIN Decoder | NHTSA</a></p>
<p><a href="https://www.yan-holtz.com/">Yan Holtz</a> <a href="https://r-graph-gallery.com/">The R Graph Gallery</a></p>
</section>
<section id="supporting-tools-publications" class="level4">
<h4 class="anchored" data-anchor-id="supporting-tools-publications"><em>Supporting Tools &amp; Publications:</em></h4>
<p>Auto Trader <a href="https://www.autotrader.com/cars-for-sale">Used Cars for Sale - Autotrader</a></p>
<p>Edmonds <a href="https://www.edmunds.com/car-reviews/top-10/top-10-best-selling-vehicles-for-2013.html">Top 10 Best-Selling Vehicles for 2013 on Edmunds.com</a></p>
<p>J.D. Power: <a href="https://www.jdpower.com/Cars/Ratings/Depreciation/2018">2018 Resale Awards and Ratings | J.D. Power</a></p>
<p>Kelley Blue Book <a href="https://www.kbb.com/">Kelley Blue Book</a></p>
<p>VIN Decoder: <a href="https://www.decodethis.com/">Decode This</a></p>
</section>
</section>
<section id="appendix" class="level1">
<h1><strong>Appendix</strong></h1>
<section id="appendix-a" class="level2">
<h2 class="anchored" data-anchor-id="appendix-a">Appendix A:</h2>
<p>Original data set: car_prices.csv</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
df  
Dimensions: 514613 x 16  
Duplicates: 0  

-----------------------------------------------------------------------------------------------------------------------
No   Variable       Stats / Values                  Freqs (% of Valid)       Graph                 Valid      Missing  
---- -------------- ------------------------------- ------------------------ --------------------- ---------- ---------
1    year           1. 2012                         102315 (19.9%)           III                   514613     0        
     [character]    2. 2013                          98168 (19.1%)           III                   (100.0%)   (0.0%)   
                    3. 2014                          81070 (15.8%)           III                                       
                    4. 2011                          48548 ( 9.4%)           I                                         
                    5. 2008                          31502 ( 6.1%)           I                                         
                    6. 2007                          30845 ( 6.0%)           I                                         
                    7. 2006                          26913 ( 5.2%)           I                                         
                    8. 2010                          26485 ( 5.1%)           I                                         
                    9. 2005                          21394 ( 4.2%)                                                     
                    10. 2009                         20594 ( 4.0%)                                                     
                    [ 2 others ]                     26779 ( 5.2%)           I                                         

2    make           1. Ford                          87687 (17.3%)           III                   506671     7942     
     [character]    2. Chevrolet                     56022 (11.1%)           II                    (98.5%)    (1.5%)   
                    3. Nissan                        51594 (10.2%)           II                                        
                    4. Toyota                        36029 ( 7.1%)           I                                         
                    5. Dodge                         29544 ( 5.8%)           I                                         
                    6. Honda                         23220 ( 4.6%)                                                     
                    7. Hyundai                       21155 ( 4.2%)                                                     
                    8. BMW                           18983 ( 3.7%)                                                     
                    9. Kia                           17786 ( 3.5%)                                                     
                    10. Chrysler                     16613 ( 3.3%)                                                     
                    [ 76 others ]                   148038 (29.2%)           IIIII                                     

3    model          1. Altima                        18638 ( 3.7%)                                 506659     7954     
     [character]    2. F-150                         13584 ( 2.7%)                                 (98.5%)    (1.5%)   
                    3. Fusion                        12946 ( 2.6%)                                                     
                    4. Escape                        11578 ( 2.3%)                                                     
                    5. Camry                         11226 ( 2.2%)                                                     
                    6. Focus                          9999 ( 2.0%)                                                     
                    7. Grand Caravan                  7769 ( 1.5%)                                                     
                    8. Impala                         7505 ( 1.5%)                                                     
                    9. G Sedan                        7417 ( 1.5%)                                                     
                    10. 3 Series                      7394 ( 1.5%)                                                     
                    [ 782 others ]                  398603 (78.7%)           IIIIIIIIIIIIIII                           

4    trim           1. Base                          48584 ( 9.6%)           I                     506394     8219     
     [character]    2. SE                            41841 ( 8.3%)           I                     (98.4%)    (1.6%)   
                    3. LX                            18863 ( 3.7%)                                                     
                    4. Limited                       17396 ( 3.4%)                                                     
                    5. LT                            16636 ( 3.3%)                                                     
                    6. XLT                           15169 ( 3.0%)                                                     
                    7. LE                            11748 ( 2.3%)                                                     
                    8. S                             11647 ( 2.3%)                                                     
                    9. GLS                           11587 ( 2.3%)                                                     
                    10. LS                           11360 ( 2.2%)                                                     
                    [ 1524 others ]                 301563 (59.6%)           IIIIIIIIIII                               

5    body           1. Sedan                        183305 (36.3%)           IIIIIII               504678     9935     
     [character]    2. SUV                          110102 (21.8%)           IIII                  (98.1%)    (1.9%)   
                    3. sedan                         39476 ( 7.8%)           I                                         
                    4. suv                           23120 ( 4.6%)                                                     
                    5. Hatchback                     20382 ( 4.0%)                                                     
                    6. Minivan                       20051 ( 4.0%)                                                     
                    7. Crew Cab                      12699 ( 2.5%)                                                     
                    8. Wagon                         12646 ( 2.5%)                                                     
                    9. Coupe                         12572 ( 2.5%)                                                     
                    10. Convertible                   7372 ( 1.5%)                                                     
                    [ 74 others ]                    62953 (12.5%)           II                                        

6    transmission   1. automatic                    440307 (96.8%)           IIIIIIIIIIIIIIIIIII   454932     59681    
     [character]    2. manual                        14599 ( 3.2%)                                 (88.4%)    (11.6%)  
                    3. sedan                            15 ( 0.0%)                                                     
                    4. Sedan                            11 ( 0.0%)                                                     

7    vin            1. automatic                        22 (  0.0%)                                514609     4        
     [character]    2. wbanv13588cz57827                 5 (  0.0%)                                (100.0%)   (0.0%)   
                    3. 1ftfw1cv5afb30053                 4 (  0.0%)                                                    
                    4. 5n1ar1nn2bc632869                 4 (  0.0%)                                                    
                    5. 5uxfe43579l274932                 4 (  0.0%)                                                    
                    6. trusc28n241022003                 4 (  0.0%)                                                    
                    7. wddgf56x78f009940                 4 (  0.0%)                                                    
                    8. 1c3bcbeb9dn526808                 3 (  0.0%)                                                    
                    9. 1c4pjlak8cw134088                 3 (  0.0%)                                                    
                    10. 1c4pjlak9cw151871                3 (  0.0%)                                                    
                    [ 506479 others ]               514553 (100.0%)          IIIIIIIIIIIIIIIIIII                       

8    state          1. fl                            76001 (14.8%)           II                    514613     0        
     [character]    2. ca                            66121 (12.8%)           II                    (100.0%)   (0.0%)   
                    3. pa                            51776 (10.1%)           II                                        
                    4. tx                            43185 ( 8.4%)           I                                         
                    5. ga                            31731 ( 6.2%)           I                                         
                    6. nj                            25933 ( 5.0%)           I                                         
                    7. il                            22648 ( 4.4%)                                                     
                    8. tn                            20312 ( 3.9%)                                                     
                    9. oh                            20028 ( 3.9%)                                                     
                    10. nc                           18478 ( 3.6%)                                                     
                    [ 54 others ]                   138400 (26.9%)           IIIII                                     

9    condition      Mean (sd) : 3.5 (0.9)           41 distinct values                   : .       506371     8242     
     [numeric]      min &lt; med &lt; max:                                                     : : :     (98.4%)    (1.6%)   
                    1 &lt; 3.7 &lt; 5                                                  :   : . : : : .                       
                    IQR (CV) : 1.4 (0.3)                                         : : : : : : : :                       
                                                                             .   : : : : : : : :                       

10   odometer       Mean (sd) : 61323 (46816.3)     154189 distinct values   :                     514573     40       
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    1 &lt; 47172 &lt; 999999                                       :                                         
                    IQR (CV) : 61684 (0.8)                                   :                                         
                                                                             : :                                       

11   color          1. black                        104598 (20.4%)           IIII                  513921     692      
     [character]    2. white                         99846 (19.4%)           III                   (99.9%)    (0.1%)   
                    3. gray                          78945 (15.4%)           III                                       
                    4. silver                        75627 (14.7%)           II                                        
                    5. blue                          46293 ( 9.0%)           I                                         
                    6. red                           39932 ( 7.8%)           I                                         
                    7. â€”                           24323 ( 4.7%)                                                     
                    8. gold                           8547 ( 1.7%)                                                     
                    9. burgundy                       7947 ( 1.5%)                                                     
                    10. green                         7723 ( 1.5%)                                                     
                    [ 36 others ]                    20140 ( 3.9%)                                                     

12   interior       1. black                        237563 (46.2%)           IIIIIIIII             513921     692      
     [character]    2. gray                         159295 (31.0%)           IIIIII                (99.9%)    (0.1%)   
                    3. beige                         53104 (10.3%)           II                                        
                    4. tan                           37782 ( 7.4%)           I                                         
                    5. â€”                           13575 ( 2.6%)                                                     
                    6. brown                          7925 ( 1.5%)                                                     
                    7. red                            1256 ( 0.2%)                                                     
                    8. silver                          972 ( 0.2%)                                                     
                    9. blue                            648 ( 0.1%)                                                     
                    10. off-white                      478 ( 0.1%)                                                     
                    [ 7 others ]                      1323 ( 0.3%)                                                     

13   seller         1. nissan-infiniti lt            19693 ( 3.8%)                                 514613     0        
     [character]    2. ford motor credit company     19160 ( 3.7%)                                 (100.0%)   (0.0%)   
                    3. the hertz corporation         18236 ( 3.5%)                                                     
                    4. santander consumer            15078 ( 2.9%)                                                     
                    5. avis corporation              12540 ( 2.4%)                                                     
                    6. nissan infiniti lt             9962 ( 1.9%)                                                     
                    7. wells fargo dealer servic      8457 ( 1.6%)                                                     
                    8. tdaf remarketing               6897 ( 1.3%)                                                     
                    9. enterprise veh exchange/r      6810 ( 1.3%)                                                     
                    10. hyundai motor finance         6660 ( 1.3%)                                                     
                    [ 13125 others ]                391120 (76.0%)           IIIIIIIIIIIIIII                           

14   mmr            Mean (sd) : 14740.9 (9452.6)    1101 distinct values     :                     514587     26       
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    25 &lt; 12900 &lt; 182000                                      :                                         
                    IQR (CV) : 10375 (0.6)                                   : .                                       
                                                                             : :                                       

15   sellingprice   Mean (sd) : 14573.8 (9537.2)    1869 distinct values     :                     514613     0        
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    1 &lt; 12900 &lt; 230000                                       :                                         
                    IQR (CV) : 10500 (0.7)                                   :                                         
                                                                             : :                                       

16   saledate       1. Tue Feb 10 2015 01:30:00       4984 ( 1.0%)                                 514613     0        
     [character]    2. Tue Feb 17 2015 01:30:00       4760 ( 0.9%)                                 (100.0%)   (0.0%)   
                    3. Tue Jan 27 2015 01:30:00       4729 ( 0.9%)                                                     
                    4. Tue Jan 20 2015 01:30:00       4464 ( 0.9%)                                                     
                    5. Tue Mar 03 2015 01:30:00       4409 ( 0.9%)                                                     
                    6. Tue Feb 03 2015 01:30:00       4301 ( 0.8%)                                                     
                    7. Tue Jun 02 2015 02:30:00       4114 ( 0.8%)                                                     
                    8. Tue Jun 16 2015 02:30:00       3983 ( 0.8%)                                                     
                    9. Tue Mar 10 2015 02:30:00       3806 ( 0.7%)                                                     
                    10. Tue Feb 24 2015 01:30:00      3448 ( 0.7%)                                                     
                    [ 3619 others ]                 471615 (91.6%)           IIIIIIIIIIIIIIIIII                        
-----------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="appendix-b" class="level2">
<h2 class="anchored" data-anchor-id="appendix-b">Appendix B:</h2>
<p>Canadian vehicle catalog</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(ca_catalog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
ca_catalog  
Dimensions: 5268 x 10  
Duplicates: 0  

------------------------------------------------------------------------------------------------------------------------
No   Variable          Stats / Values                  Freqs (% of Valid)     Graph                 Valid      Missing  
---- ----------------- ------------------------------- ---------------------- --------------------- ---------- ---------
1    Combined          1. 2002 Cadillac DeVille           2 ( 0.0%)                                 5268       0        
     [character]       2. 2002 Chevrolet Impala           2 ( 0.0%)                                 (100.0%)   (0.0%)   
                       3. 2002 Chevrolet Silverado        2 ( 0.0%)                                                     
                       4. 2002 Chevrolet Silverado        2 ( 0.0%)                                                     
                       5. 2002 Chrysler Intrepid          2 ( 0.0%)                                                     
                       6. 2002 Ford Excursion             2 ( 0.0%)                                                     
                       7. 2002 Ford Super Duty F-35       2 ( 0.0%)                                                     
                       8. 2002 Ford Super Duty F-35       2 ( 0.0%)                                                     
                       9. 2002 GMC Savana Passenger       2 ( 0.0%)                                                     
                       10. 2002 GMC Sierra 2500           2 ( 0.0%)                                                     
                       [ 5037 others ]                 5248 (99.6%)           IIIIIIIIIIIIIIIIIII                       

2    YearOfLaunch      Mean (sd) : 2007.6 (4.8)        17 distinct values           . .   .   . :   5268       0        
     [numeric]         min &lt; med &lt; max:                                         :   : :   :   : :   (100.0%)   (0.0%)   
                       1999 &lt; 2008 &lt; 2015                                     : :   : : . : . : :                       
                       IQR (CV) : 8 (0)                                       : : : : : : : : : :                       
                                                                              : : : : : : : : : :                       

3    Segment           1. Compact Car                  721 (16.8%)            III                   4295       973      
     [character]       2. Mid-Size Car                 638 (14.9%)            II                    (81.5%)    (18.5%)  
                       3. Mid-Size SUV/Crossover       501 (11.7%)            II                                        
                       4. Compact SUV/Crossover        372 ( 8.7%)            I                                         
                       5. Minivan                      354 ( 8.2%)            I                                         
                       6. Full-Size Car                338 ( 7.9%)            I                                         
                       7. Subcompact Car               324 ( 7.5%)            I                                         
                       8. Sports Car                   266 ( 6.2%)            I                                         
                       9. Full-Size SUV/Crossover      260 ( 6.1%)            I                                         
                       10. HD Full-Size Pickup         155 ( 3.6%)                                                      
                       [ 3 others ]                    366 ( 8.5%)            I                                         

4    Trim_Count        Mean (sd) : 16.2 (58.3)         172 distinct values    :                     5268       0        
     [numeric]         min &lt; med &lt; max:                                       :                     (100.0%)   (0.0%)   
                       1 &lt; 5 &lt; 2524                                           :                                         
                       IQR (CV) : 8 (3.6)                                     :                                         
                                                                              :                                         

5    AVG_MSRP_CAD      Mean (sd) : 46772.7 (27047)     3695 distinct values     :                   5268       0        
     [numeric]         min &lt; med &lt; max:                                         :                   (100.0%)   (0.0%)   
                       15 &lt; 39895 &lt; 251165                                      :                                       
                       IQR (CV) : 25285.8 (0.6)                                 : .                                     
                                                                              : : : .                                   

6    MSRP_Range_CAD    Mean (sd) : 13307.5 (16252.5)   554 distinct values    :                     5268       0        
     [numeric]         min &lt; med &lt; max:                                       :                     (100.0%)   (0.0%)   
                       0 &lt; 9600 &lt; 211900                                      :                                         
                       IQR (CV) : 12200 (1.2)                                 :                                         
                                                                              : :                                       

7    StdDev_MSRP_CAD   Mean (sd) : 5559.8 (6429.4)     3764 distinct values   :                     4674       594      
     [numeric]         min &lt; med &lt; max:                                       :                     (88.7%)    (11.3%)  
                       0 &lt; 3988.3 &lt; 63828                                     :                                         
                       IQR (CV) : 3664.6 (1.2)                                :                                         
                                                                              : :                                       

8    Error.MSRP_CAD    Mean (sd) : 2290.2 (3396.2)     3695 distinct values   :                     4674       594      
     [numeric]         min &lt; med &lt; max:                                       :                     (88.7%)    (11.3%)  
                       0 &lt; 1396.9 &lt; 36851.1                                   :                                         
                       IQR (CV) : 1443.9 (1.5)                                :                                         
                                                                              : .                                       

9    Date              1. 08/29/08                     345 (10.2%)            II                    3370       1898     
     [character]       2. 08/29/14                     354 (10.5%)            II                    (64.0%)    (36.0%)  
                       3. 08/30/13                     342 (10.1%)            II                                        
                       4. 08/31/06                     340 (10.1%)            II                                        
                       5. 08/31/07                     335 ( 9.9%)            I                                         
                       6. 08/31/09                     319 ( 9.5%)            I                                         
                       7. 08/31/10                     318 ( 9.4%)            I                                         
                       8. 08/31/11                     327 ( 9.7%)            I                                         
                       9. 08/31/12                     332 ( 9.9%)            I                                         
                       10. 08/31/15                    358 (10.6%)            II                                        

10   Close             Mean (sd) : 1.1 (0.1)           10 distinct values     I                     3370       1898     
     [numeric]         min &lt; med &lt; max:                                       I                     (64.0%)    (36.0%)  
                       1 &lt; 1.1 &lt; 1.3                                          II                                        
                       IQR (CV) : 0 (0.1)                                     I                                         
                                                                              II                                        
                                                                              I                                         
                                                                              II                                        
                                                                              I                                         
                                                                              II                                        
                                                                              II                                        
------------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="appendix-c" class="level2">
<h2 class="anchored" data-anchor-id="appendix-c">Appendix C:</h2>
<p>First iteration of unmatched records labelled as <em>false_keys</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(false_keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
false_keys  
Dimensions: 57328 x 14  
Duplicates: 0  

----------------------------------------------------------------------------------------------------------------------
No   Variable       Stats / Values                  Freqs (% of Valid)      Graph                 Valid      Missing  
---- -------------- ------------------------------- ----------------------- --------------------- ---------- ---------
1    trim           1. Base                         13031 (24.7%)           IIII                  52679      4649     
     [character]    2. Touring                       4393 ( 8.3%)           I                     (91.9%)    (8.1%)   
                    3. G37x                          4172 ( 7.9%)           I                                         
                    4. G37 Journey                   2902 ( 5.5%)           I                                         
                    5. E-250                         1557 ( 3.0%)                                                     
                    6. 2500                          1097 ( 2.1%)                                                     
                    7. Lariat                        1064 ( 2.0%)                                                     
                    8. S                             1003 ( 1.9%)                                                     
                    9. SL                             993 ( 1.9%)                                                     
                    10. LT Fleet                      963 ( 1.8%)                                                     
                    [ 418 others ]                  21504 (40.8%)           IIIIIIII                                  

2    body           1. SEDAN                        11677 (22.5%)           IIII                  51866      5462     
     [character]    2. SUV                           8030 (15.5%)           III                   (90.5%)    (9.5%)   
                    3. G SEDAN                       7417 (14.3%)           II                                        
                    4. MINIVAN                       6020 (11.6%)           II                                        
                    5. HATCHBACK                     4448 ( 8.6%)           I                                         
                    6. VAN                           3291 ( 6.3%)           I                                         
                    7. CREW CAB                      2614 ( 5.0%)           I                                         
                    8. E-SERIES VAN                  1822 ( 3.5%)                                                     
                    9. G COUPE                       1593 ( 3.1%)                                                     
                    10. QUAD CAB                      974 ( 1.9%)                                                     
                    [ 25 others ]                    3980 ( 7.7%)           I                                         

3    Body_Type      1. Convertible                   1293 ( 2.5%)                                 51866      5462     
     [character]    2. Coupe                         2744 ( 5.3%)           I                     (90.5%)    (9.5%)   
                    3. Hatchback                     4448 ( 8.6%)           I                                         
                    4. Minivan                      11211 (21.6%)           IIII                                      
                    5. Pickup                        4294 ( 8.3%)           I                                         
                    6. Sedan                        19094 (36.8%)           IIIIIII                                   
                    7. SUV                           8030 (15.5%)           III                                       
                    8. Wagon                          752 ( 1.4%)                                                     

4    transmission   1. automatic                    48340 (96.6%)           IIIIIIIIIIIIIIIIIII   50066      7262     
     [character]    2. manual                        1726 ( 3.4%)                                 (87.3%)    (12.7%)  

5    vin            1. 1FBSS3BL7CDA01868                3 ( 0.0%)                                 57328      0        
     [character]    2. 1FT7W2BTXDEA03416                3 ( 0.0%)                                 (100.0%)   (0.0%)   
                    3. 1FT8W3DT1CEB32666                3 ( 0.0%)                                                     
                    4. 1FTSW21568EA33810                3 ( 0.0%)                                                     
                    5. 1FTSW21R48EB47680                3 ( 0.0%)                                                     
                    6. 1FTXW43R28EA88031                3 ( 0.0%)                                                     
                    7. 1GYEE637780184619                3 ( 0.0%)                                                     
                    8. 1ZVBP8JZ2E5263940                3 ( 0.0%)                                                     
                    9. 2C4RC1BG2DR821210                3 ( 0.0%)                                                     
                    10. 2FABP7BV5AX113795               3 ( 0.0%)                                                     
                    [ 56475 others ]                57298 (99.9%)           IIIIIIIIIIIIIIIIIII                       

6    state          1. FL                           10682 (18.6%)           III                   57328      0        
     [character]    2. CA                            8762 (15.3%)           III                   (100.0%)   (0.0%)   
                    3. PA                            4972 ( 8.7%)           I                                         
                    4. TX                            4545 ( 7.9%)           I                                         
                    5. GA                            3274 ( 5.7%)           I                                         
                    6. IL                            3051 ( 5.3%)           I                                         
                    7. TN                            2925 ( 5.1%)           I                                         
                    8. NJ                            2816 ( 4.9%)                                                     
                    9. OH                            1667 ( 2.9%)                                                     
                    10. MO                           1518 ( 2.6%)                                                     
                    [ 28 others ]                   13116 (22.9%)           IIII                                      

7    condition      Mean (sd) : 3.7 (0.9)           41 distinct values                  . : .     56763      565      
     [numeric]      min &lt; med &lt; max:                                                    : : :     (99.0%)    (1.0%)   
                    1 &lt; 3.8 &lt; 5                                                     .   : : : .                       
                    IQR (CV) : 1.3 (0.2)                                        : . : : : : : :                       
                                                                                : : : : : : : :                       

8    odometer       Mean (sd) : 51493.7 (44181.5)   43772 distinct values   :                     57325      3        
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)   
                    1 &lt; 35757 &lt; 999999                                      :                                         
                    IQR (CV) : 50951 (0.9)                                  :                                         
                                                                            : .                                       

9    color          1. white                        16292 (28.4%)           IIIII                 57267      61       
     [character]    2. black                        11733 (20.5%)           IIII                  (99.9%)    (0.1%)   
                    3. gray                          8879 (15.5%)           III                                       
                    4. silver                        6166 (10.8%)           II                                        
                    5. blue                          4576 ( 8.0%)           I                                         
                    6. red                           3244 ( 5.7%)           I                                         
                    7. â€”                           2798 ( 4.9%)                                                     
                    8. gold                           817 ( 1.4%)                                                     
                    9. burgundy                       656 ( 1.1%)                                                     
                    10. beige                         569 ( 1.0%)                                                     
                    [ 9 others ]                     1537 ( 2.7%)                                                     

10   interior       1. black                        27397 (47.8%)           IIIIIIIII             57267      61       
     [character]    2. gray                         17084 (29.8%)           IIIII                 (99.9%)    (0.1%)   
                    3. beige                         6468 (11.3%)           II                                        
                    4. tan                           3547 ( 6.2%)           I                                         
                    5. brown                         1155 ( 2.0%)                                                     
                    6. â€”                           1062 ( 1.9%)                                                     
                    7. red                            191 ( 0.3%)                                                     
                    8. silver                         116 ( 0.2%)                                                     
                    9. blue                            68 ( 0.1%)                                                     
                    10. white                          46 ( 0.1%)                                                     
                    [ 7 others ]                      133 ( 0.2%)                                                     

11   seller         1. nissan infiniti lt            9958 (17.4%)           III                   57328      0        
     [character]    2. lexus financial services      3627 ( 6.3%)           I                     (100.0%)   (0.0%)   
                    3. u-haul                        1439 ( 2.5%)                                                     
                    4. nissan-infiniti lt            1420 ( 2.5%)                                                     
                    5. gm remarketing                1241 ( 2.2%)                                                     
                    6. the hertz corporation         1053 ( 1.8%)                                                     
                    7. ge fleet services for its     1015 ( 1.8%)                                                     
                    8. enterprise veh exchange/r     1009 ( 1.8%)                                                     
                    9. santander consumer             874 ( 1.5%)                                                     
                    10. avis corporation              830 ( 1.4%)                                                     
                    [ 4601 others ]                 34862 (60.8%)           IIIIIIIIIIII                              

12   mmr            Mean (sd) : 19003.7 (10836)     1062 distinct values    : :                   57328      0        
     [numeric]      min &lt; med &lt; max:                                        : :                   (100.0%)   (0.0%)   
                    175 &lt; 18600 &lt; 182000                                    : :                                       
                    IQR (CV) : 10600 (0.6)                                  : :                                       
                                                                            : : .                                     

13   sellingprice   Mean (sd) : 18860 (10893.5)     1083 distinct values    : .                   57328      0        
     [numeric]      min &lt; med &lt; max:                                        : :                   (100.0%)   (0.0%)   
                    300 &lt; 18400 &lt; 183000                                    : :                                       
                    IQR (CV) : 11100 (0.6)                                  : :                                       
                                                                            : : .                                     

14   saledate       1. Tue Jan 27 2015 01:30:00       633 ( 1.1%)                                 57328      0        
     [character]    2. Tue Feb 17 2015 01:30:00       628 ( 1.1%)                                 (100.0%)   (0.0%)   
                    3. Tue Feb 03 2015 01:30:00       604 ( 1.1%)                                                     
                    4. Tue Mar 03 2015 01:30:00       577 ( 1.0%)                                                     
                    5. Tue Jan 20 2015 01:30:00       570 ( 1.0%)                                                     
                    6. Tue Jun 16 2015 02:30:00       562 ( 1.0%)                                                     
                    7. Tue Feb 10 2015 01:30:00       550 ( 1.0%)                                                     
                    8. Tue Jun 02 2015 02:30:00       476 ( 0.8%)                                                     
                    9. Thu Jan 15 2015 04:30:00       452 ( 0.8%)                                                     
                    10. Tue Jan 06 2015 01:30:00      436 ( 0.8%)                                                     
                    [ 2131 others ]                 51840 (90.4%)           IIIIIIIIIIIIIIIIII                        
----------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>This dataset contains all the YMM keys from <em>carprices</em> that failed to map to the <em>us_catalog.</em></p>
</section>
<section id="appendix-d" class="level2">
<h2 class="anchored" data-anchor-id="appendix-d">Appendix D:</h2>
<p>All records cleaned through NHTSA’s <em>vindecodr</em> package lablled as <em>cleaned_keys</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(cleaned_keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
cleaned_keys  
Dimensions: 38208 x 26  
Duplicates: 1090  

----------------------------------------------------------------------------------------------------------------------
No   Variable       Stats / Values                  Freqs (% of Valid)      Graph                 Valid      Missing  
---- -------------- ------------------------------- ----------------------- --------------------- ---------- ---------
1    year           Mean (sd) : 2011.5 (2.2)        2007 : 3684 ( 9.6%)     I                     38208      0        
     [numeric]      min &lt; med &lt; max:                2008 : 2518 ( 6.6%)     I                     (100.0%)   (0.0%)   
                    2007 &lt; 2012 &lt; 2015              2009 : 1194 ( 3.1%)                                               
                    IQR (CV) : 2 (0)                2010 : 1856 ( 4.9%)                                               
                                                    2011 : 4979 (13.0%)     II                                        
                                                    2012 : 8787 (23.0%)     IIII                                      
                                                    2013 : 8609 (22.5%)     IIII                                      
                                                    2014 : 6340 (16.6%)     III                                       
                                                    2015 :  241 ( 0.6%)                                               

2    make           1. INFINITI                     13977 (36.6%)           IIIIIII               38208      0        
     [character]    2. LEXUS                         9007 (23.6%)           IIII                  (100.0%)   (0.0%)   
                    3. FORD                          4012 (10.5%)           II                                        
                    4. CHEVROLET                     3208 ( 8.4%)           I                                         
                    5. NISSAN                        2272 ( 5.9%)           I                                         
                    6. GMC                            686 ( 1.8%)                                                     
                    7. MAZDA                          661 ( 1.7%)                                                     
                    8. HYUNDAI                        538 ( 1.4%)                                                     
                    9. VOLKSWAGEN                     505 ( 1.3%)                                                     
                    10. DODGE                         474 ( 1.2%)                                                     
                    [ 25 others ]                    2868 ( 7.5%)           I                                         

3    model          1. G37                           8779 (23.0%)           IIII                  38208      0        
     [character]    2. RX                            2727 ( 7.1%)           I                     (100.0%)   (0.0%)   
                    3. IS                            2213 ( 5.8%)           I                                         
                    4. ES                            2055 ( 5.4%)           I                                         
                    5. E-350                         1651 ( 4.3%)                                                     
                    6. IMPALA                        1406 ( 3.7%)                                                     
                    7. LEAF                          1359 ( 3.6%)                                                     
                    8. G25                            995 ( 2.6%)                                                     
                    9. M37                            964 ( 2.5%)                                                     
                    10. EXPRESS                       885 ( 2.3%)                                                     
                    [ 170 others ]                  15174 (39.7%)           IIIIIII                                   

4    trim           1. Base                         11399 (32.9%)           IIIIII                34646      3562     
     [character]    2. G37x                          4250 (12.3%)           II                    (90.7%)    (9.3%)   
                    3. G37 Journey                   2956 ( 8.5%)           I                                         
                    4. 2500                          1108 ( 3.2%)                                                     
                    5. E-350 Super Duty XLT           956 ( 2.8%)                                                     
                    6. G37                            906 ( 2.6%)                                                     
                    7. SL                             843 ( 2.4%)                                                     
                    8. SV                             607 ( 1.8%)                                                     
                    9. LT Fleet                       583 ( 1.7%)                                                     
                    10. SE                            579 ( 1.7%)                                                     
                    [ 276 others ]                  10459 (30.2%)           IIIIII                                    

5    body           1. SEDAN                        10160 (30.0%)           IIIII                 33919      4289     
     [character]    2. G SEDAN                       7567 (22.3%)           IIII                  (88.8%)    (11.2%)  
                    3. SUV                           6266 (18.5%)           III                                       
                    4. VAN                           3128 ( 9.2%)           I                                         
                    5. HATCHBACK                     2423 ( 7.1%)           I                                         
                    6. G COUPE                       1617 ( 4.8%)                                                     
                    7. CONVERTIBLE                    593 ( 1.7%)                                                     
                    8. E-SERIES VAN                   454 ( 1.3%)                                                     
                    9. COUPE                          403 ( 1.2%)                                                     
                    10. G CONVERTIBLE                 329 ( 1.0%)                                                     
                    [ 15 others ]                     979 ( 2.9%)                                                     

6    transmission   1. automatic                    32662 (97.0%)           IIIIIIIIIIIIIIIIIII   33672      4536     
     [character]    2. manual                        1010 ( 3.0%)                                 (88.1%)    (11.9%)  

7    vin            1. 1FBSS3BL7CDA01868                9 ( 0.0%)                                 38208      0        
     [character]    2. 1GYEE637780184619                9 ( 0.0%)                                 (100.0%)   (0.0%)   
                    3. 1ZVBP8JZ2E5263940                9 ( 0.0%)                                                     
                    4. 2FABP7BV5AX113795                9 ( 0.0%)                                                     
                    5. 2T2HK31U67C016215                9 ( 0.0%)                                                     
                    6. JN1CV6AP0DM715990                9 ( 0.0%)                                                     
                    7. JN1CV6APXCM936687                9 ( 0.0%)                                                     
                    8. JN1DV6AR6CM860083                9 ( 0.0%)                                                     
                    9. JNKBV61F67M805602                9 ( 0.0%)                                                     
                    10. JTHBK1EG6B2428322               9 ( 0.0%)                                                     
                    [ 35968 others ]                38118 (99.8%)           IIIIIIIIIIIIIIIIIII                       

8    state          1. FL                           8073 (21.1%)            IIII                  38208      0        
     [character]    2. CA                           6531 (17.1%)            III                   (100.0%)   (0.0%)   
                    3. PA                           2950 ( 7.7%)            I                                         
                    4. TX                           2498 ( 6.5%)            I                                         
                    5. TN                           2482 ( 6.5%)            I                                         
                    6. GA                           2374 ( 6.2%)            I                                         
                    7. NJ                           2087 ( 5.5%)            I                                         
                    8. IL                           2039 ( 5.3%)            I                                         
                    9. MO                           1119 ( 2.9%)                                                      
                    10. OH                          1040 ( 2.7%)                                                      
                    [ 28 others ]                   7015 (18.4%)            III                                       

9    condition      Mean (sd) : 3.7 (0.8)           41 distinct values                  . : :     37891      317      
     [numeric]      min &lt; med &lt; max:                                                    : : :     (99.2%)    (0.8%)   
                    1 &lt; 3.9 &lt; 5                                                     .   : : : :                       
                    IQR (CV) : 1.1 (0.2)                                        : . : : : : : :                       
                                                                                : : : : : : : :                       

10   odometer       Mean (sd) : 48049.3 (42571.8)   29571 distinct values   :                     38203      5        
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)   
                    1 &lt; 32961 &lt; 999999                                      :                                         
                    IQR (CV) : 41625 (0.9)                                  :                                         
                                                                            : .                                       

11   color          1. white                        10119 (26.5%)           IIIII                 38176      32       
     [character]    2. black                         8876 (23.3%)           IIII                  (99.9%)    (0.1%)   
                    3. gray                          6824 (17.9%)           III                                       
                    4. silver                        3821 (10.0%)           II                                        
                    5. blue                          2699 ( 7.1%)           I                                         
                    6. â€”                           2108 ( 5.5%)           I                                         
                    7. red                           1671 ( 4.4%)                                                     
                    8. gold                           390 ( 1.0%)                                                     
                    9. burgundy                       351 ( 0.9%)                                                     
                    10. beige                         294 ( 0.8%)                                                     
                    [ 9 others ]                     1023 ( 2.7%)                                                     

12   interior       1. black                        18588 (48.7%)           IIIIIIIII             38176      32       
     [character]    2. gray                         10169 (26.6%)           IIIII                 (99.9%)    (0.1%)   
                    3. beige                         5328 (14.0%)           II                                        
                    4. tan                           2450 ( 6.4%)           I                                         
                    5. brown                          647 ( 1.7%)                                                     
                    6. â€”                            614 ( 1.6%)                                                     
                    7. red                            136 ( 0.4%)                                                     
                    8. silver                          80 ( 0.2%)                                                     
                    9. blue                            37 ( 0.1%)                                                     
                    10. white                          36 ( 0.1%)                                                     
                    [ 7 others ]                       91 ( 0.2%)                                                     

13   seller         1. nissan infiniti lt           10064 (26.3%)           IIIII                 38208      0        
     [character]    2. lexus financial services      3674 ( 9.6%)           I                     (100.0%)   (0.0%)   
                    3. nissan-infiniti lt            1268 ( 3.3%)                                                     
                    4. gm remarketing                 885 ( 2.3%)                                                     
                    5. avis budget group              688 ( 1.8%)                                                     
                    6. infiniti financial servic      683 ( 1.8%)                                                     
                    7. nissan north america inc.      630 ( 1.6%)                                                     
                    8. ge fleet services for its      594 ( 1.6%)                                                     
                    9. r hollenshead auto sales       518 ( 1.4%)                                                     
                    10. u-haul                        486 ( 1.3%)                                                     
                    [ 3213 others ]                 18718 (49.0%)           IIIIIIIII                                 

14   mmr            Mean (sd) : 19735.9 (9262.3)    989 distinct values       :                   38208      0        
     [numeric]      min &lt; med &lt; max:                                          : .                 (100.0%)   (0.0%)   
                    250 &lt; 19700 &lt; 106000                                      : :                                     
                    IQR (CV) : 10400 (0.5)                                  : : :                                     
                                                                            : : : .                                   

15   sellingprice   Mean (sd) : 19619.4 (9364.1)    878 distinct values       :                   38208      0        
     [numeric]      min &lt; med &lt; max:                                          :                   (100.0%)   (0.0%)   
                    325 &lt; 19500 &lt; 113000                                      : .                                     
                    IQR (CV) : 10600 (0.5)                                  : : :                                     
                                                                            : : : .                                   

16   saledate       1. Tue Jan 27 2015 01:30:00       507 ( 1.3%)                                 38208      0        
     [character]    2. Tue Feb 17 2015 01:30:00       492 ( 1.3%)                                 (100.0%)   (0.0%)   
                    3. Tue Jan 20 2015 01:30:00       487 ( 1.3%)                                                     
                    4. Tue Feb 03 2015 01:30:00       471 ( 1.2%)                                                     
                    5. Tue Jun 16 2015 02:30:00       444 ( 1.2%)                                                     
                    6. Tue Mar 03 2015 01:30:00       430 ( 1.1%)                                                     
                    7. Thu Jan 15 2015 04:30:00       412 ( 1.1%)                                                     
                    8. Tue Feb 10 2015 01:30:00       404 ( 1.1%)                                                     
                    9. Tue Jan 06 2015 01:30:00       367 ( 1.0%)                                                     
                    10. Tue Jun 02 2015 02:30:00      365 ( 1.0%)                                                     
                    [ 1756 others ]                 33829 (88.5%)           IIIIIIIIIIIIIIIII                         

17   Body_Type      1. Convertible                   1043 ( 3.1%)                                 33919      4289     
     [character]    2. Coupe                         2374 ( 7.0%)           I                     (88.8%)    (11.2%)  
                    3. Hatchback                     2423 ( 7.1%)           I                                         
                    4. Minivan                       3614 (10.7%)           II                                        
                    5. Pickup                          95 ( 0.3%)                                                     
                    6. Sedan                        17727 (52.3%)           IIIIIIIIII                                
                    7. SUV                           6266 (18.5%)           III                                       
                    8. Wagon                          377 ( 1.1%)                                                     

18   YMM            1. 2013 INFINITI G37             3669 ( 9.6%)           I                     38208      0        
     [character]    2. 2012 INFINITI G37             2812 ( 7.4%)           I                     (100.0%)   (0.0%)   
                    3. 2011 INFINITI G37             2037 ( 5.3%)           I                                         
                    4. 2014 CHEVROLET IMPALA         1116 ( 2.9%)                                                     
                    5. 2012 LEXUS RX                 1000 ( 2.6%)                                                     
                    6. 2014 FORD E-350                859 ( 2.2%)                                                     
                    7. 2012 LEXUS IS                  802 ( 2.1%)                                                     
                    8. 2013 NISSAN LEAF               802 ( 2.1%)                                                     
                    9. 2012 INFINITI M37              766 ( 2.0%)                                                     
                    10. 2013 LEXUS RX                 705 ( 1.8%)                                                     
                    [ 483 others ]                  23640 (61.9%)           IIIIIIIIIIII                              

19   Segment        1. Mid-Size Car                 14266 (39.6%)           IIIIIII               36048      2160     
     [character]    2. Compact Car                   6068 (16.8%)           III                   (94.3%)    (5.7%)   
                    3. Compact SUV/Crossover         4214 (11.7%)           II                                        
                    4. Minivan                       2715 ( 7.5%)           I                                         
                    5. Full-Size Car                 2180 ( 6.0%)           I                                         
                    6. Subcompact Car                1715 ( 4.8%)                                                     
                    7. Mid-Size SUV/Crossover        1669 ( 4.6%)                                                     
                    8. Subcompact SUV/Crossover      1200 ( 3.3%)                                                     
                    9. Full-Size SUV/Crossover       1145 ( 3.2%)                                                     
                    10. Sports Car                    404 ( 1.1%)                                                     
                    [ 2 others ]                      472 ( 1.3%)                                                     

20   AVG_MSRP       Mean (sd) : 45858.3 (14383)     511 distinct values         . :               38208      0        
     [numeric]      min &lt; med &lt; max:                                            : :               (100.0%)   (0.0%)   
                    14 &lt; 45530 &lt; 151762                                         : :                                   
                    IQR (CV) : 18086 (0.3)                                    . : :                                   
                                                                              : : : .                                 

21   MSRP_Range     Mean (sd) : 12627 (8787.1)      415 distinct values     :                     38208      0        
     [numeric]      min &lt; med &lt; max:                                        : .                   (100.0%)   (0.0%)   
                    0 &lt; 11672 &lt; 116984                                      : :                                       
                    IQR (CV) : 12425 (0.7)                                  : : .                                     
                                                                            : : :                                     

22   Trim_Count     Mean (sd) : 8.3 (8.4)           30 distinct values      :                     38208      0        
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)   
                    1 &lt; 7 &lt; 131                                             :                                         
                    IQR (CV) : 11 (1)                                       :                                         
                                                                            : :                                       

23   StdDev_MSRP    Mean (sd) : 5388.7 (3148.9)     453 distinct values       :                   35115      3093     
     [numeric]      min &lt; med &lt; max:                                        : :                   (91.9%)    (8.1%)   
                    0 &lt; 5693.7 &lt; 47165.7                                    : :                                       
                    IQR (CV) : 3900.9 (0.6)                                 : :                                       
                                                                            : : .                                     

24   Error.MSRP     Mean (sd) : 2234.8 (1857.4)     453 distinct values     :                     35115      3093     
     [numeric]      min &lt; med &lt; max:                                        :                     (91.9%)    (8.1%)   
                    0 &lt; 1683.4 &lt; 21093.1                                    :                                         
                    IQR (CV) : 1199 (0.8)                                   : .                                       
                                                                            : : . .                                   

25   Error %        Mean (sd) : 4.7 (2.8)           103 distinct values       : :                 35115      3093     
     [numeric]      min &lt; med &lt; max:                                          : : .               (91.9%)    (8.1%)   
                    0 &lt; 4.1 &lt; 15.1                                            : : : .                                 
                    IQR (CV) : 3.1 (0.6)                                      : : : :                                 
                                                                            : : : : : : . .   .                       

26   %MSRP_Range    Mean (sd) : 28.1 (17.1)         310 distinct values           :               38208      0        
     [numeric]      min &lt; med &lt; max:                                              :               (100.0%)   (0.0%)   
                    0 &lt; 30.8 &lt; 107.2                                        :   . :                                   
                    IQR (CV) : 25.9 (0.6)                                   : : : :                                   
                                                                            : : : : : .                               
----------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="appendix-e" class="level2">
<h2 class="anchored" data-anchor-id="appendix-e">Appendix E:</h2>
<p>Remaining records from false_keys that failed to map after decoding VINs labelled as unmatched_keys.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(unmatched_keys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
unmatched_keys  
Dimensions: 20826 x 26  
Duplicates: 0  

-----------------------------------------------------------------------------------------------------------------------
No   Variable       Stats / Values                  Freqs (% of Valid)      Graph                 Valid      Missing   
---- -------------- ------------------------------- ----------------------- --------------------- ---------- ----------
1    year           1. 2007                         1612 ( 7.7%)            I                     20826      0         
     [character]    2. 2008                         3207 (15.4%)            III                   (100.0%)   (0.0%)    
                    3. 2009                          803 ( 3.9%)                                                       
                    4. 2010                         1817 ( 8.7%)            I                                          
                    5. 2011                         1847 ( 8.9%)            I                                          
                    6. 2012                         2605 (12.5%)            II                                         
                    7. 2013                         2676 (12.8%)            II                                         
                    8. 2014                         5654 (27.1%)            IIIII                                      
                    9. 2015                          605 ( 2.9%)                                                       

2    make           1. CHRYSLER                     5334 (27.7%)            IIIII                 19287      1539      
     [character]    2. FORD                         5026 (26.1%)            IIIII                 (92.6%)    (7.4%)    
                    3. DODGE                        1343 ( 7.0%)            I                                          
                    4. CHEVROLET                    1066 ( 5.5%)            I                                          
                    5. MITSUBISHI                    705 ( 3.7%)                                                       
                    6. MINI                          663 ( 3.4%)                                                       
                    7. MERCURY                       646 ( 3.3%)                                                       
                    8. VOLKSWAGEN                    593 ( 3.1%)                                                       
                    9. NISSAN                        565 ( 2.9%)                                                       
                    10. SCION                        540 ( 2.8%)                                                       
                    [ 31 others ]                   2806 (14.5%)            II                                         

3    model          1. TOWN AND COUNTRY             5319 (27.6%)            IIIII                 19287      1539      
     [character]    2. F-250 SUPER DUTY             1946 (10.1%)            II                    (92.6%)    (7.4%)    
                    3. E-SERIES VAN                 1372 ( 7.1%)            I                                          
                    4. CAPTIVA SPORT                1016 ( 5.3%)            I                                          
                    5. RAM PICKUP 1500               996 ( 5.2%)            I                                          
                    6. F-350 SUPER DUTY              853 ( 4.4%)                                                       
                    7. COOPER                        663 ( 3.4%)                                                       
                    8. TRANSIT CONNECT               555 ( 2.9%)                                                       
                    9. OUTLANDER SPORT               381 ( 2.0%)                                                       
                    10. TC                           327 ( 1.7%)                                                       
                    [ 125 others ]                  5859 (30.4%)            IIIIII                                     

4    trim           1. Touring                      4333 (22.5%)            IIII                  19273      1553      
     [character]    2. Base                         2131 (11.1%)            II                    (92.5%)    (7.5%)    
                    3. E-250                        1550 ( 8.0%)            I                                          
                    4. Lariat                       1064 ( 5.5%)            I                                          
                    5. XLT                           815 ( 4.2%)                                                       
                    6. SLT                           760 ( 3.9%)                                                       
                    7. XL                            715 ( 3.7%)                                                       
                    8. S                             584 ( 3.0%)                                                       
                    9. Touring-L                     564 ( 2.9%)                                                       
                    10. LX                           411 ( 2.1%)                                                       
                    [ 171 others ]                  6346 (32.9%)            IIIIII                                     

5    body           1. MINIVAN                      5988 (31.4%)            IIIIII                19085      1741      
     [character]    2. CREW CAB                     2550 (13.4%)            II                    (91.6%)    (8.4%)    
                    3. HATCHBACK                    2129 (11.2%)            II                                         
                    4. SUV                          2052 (10.8%)            II                                         
                    5. SEDAN                        1816 ( 9.5%)            I                                          
                    6. E-SERIES VAN                 1372 ( 7.2%)            I                                          
                    7. QUAD CAB                      974 ( 5.1%)            I                                          
                    8. SUPERCAB                      438 ( 2.3%)                                                       
                    9. WAGON                         383 ( 2.0%)                                                       
                    10. VAN                          322 ( 1.7%)                                                       
                    [ 10 others ]                   1061 ( 5.6%)            I                                          

6    transmission   1. automatic                    17115 (95.6%)           IIIIIIIIIIIIIIIIIII   17912      2914      
     [character]    2. manual                         797 ( 4.4%)                                 (86.0%)    (14.0%)   

7    vin            1. 1FT7W2BTXDEA03416                3 ( 0.0%)                                 20826      0         
     [character]    2. 1FT8W3DT1CEB32666                3 ( 0.0%)                                 (100.0%)   (0.0%)    
                    3. 1FTSW21568EA33810                3 ( 0.0%)                                                      
                    4. 1FTSW21R48EB47680                3 ( 0.0%)                                                      
                    5. 1FTXW43R28EA88031                3 ( 0.0%)                                                      
                    6. 2C4RC1BG2DR821210                3 ( 0.0%)                                                      
                    7. 2G4WD582571126964                3 ( 0.0%)                                                      
                    8. 1D3HU18268J106114                2 ( 0.0%)                                                      
                    9. 1D7HA16N28J150504                2 ( 0.0%)                                                      
                    10. 1D7HA18278J186420               2 ( 0.0%)                                                      
                    [ 20497 others ]                20799 (99.9%)           IIIIIIIIIIIIIIIIIII                        

8    state          1. FL                           2926 (14.0%)            II                    20826      0         
     [character]    2. CA                           2470 (11.9%)            II                    (100.0%)   (0.0%)    
                    3. TX                           2208 (10.6%)            II                                         
                    4. PA                           2134 (10.2%)            II                                         
                    5. IL                           1063 ( 5.1%)            I                                          
                    6. GA                           1027 ( 4.9%)                                                       
                    7. MI                            959 ( 4.6%)                                                       
                    8. NJ                            800 ( 3.8%)                                                       
                    9. OH                            670 ( 3.2%)                                                       
                    10. MN                           621 ( 3.0%)                                                       
                    [ 27 others ]                   5948 (28.6%)            IIIII                                      

9    condition      Mean (sd) : 3.5 (0.9)           40 distinct values                    :       20543      283       
     [numeric]      min &lt; med &lt; max:                                                    : :       (98.6%)    (1.4%)    
                    1 &lt; 3.7 &lt; 5                                                 .   :   : : : .                        
                    IQR (CV) : 1.4 (0.3)                                        : . : : : : : :                        
                                                                                : : : : : : : :                        

10   odometer       Mean (sd) : 59768.7 (47714.6)   19162 distinct values   :                     20825      1         
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)    
                    1 &lt; 46884 &lt; 397857                                      : :                                        
                    IQR (CV) : 64874 (0.8)                                  : : :                                      
                                                                            : : : : .                                  

11   color          1. white                        6646 (32.0%)            IIIIII                20796      30        
     [character]    2. black                        3286 (15.8%)            III                   (99.9%)    (0.1%)    
                    3. silver                       2522 (12.1%)            II                                         
                    4. gray                         2247 (10.8%)            II                                         
                    5. blue                         1991 ( 9.6%)            I                                          
                    6. red                          1653 ( 7.9%)            I                                          
                    7. â€”                           772 ( 3.7%)                                                       
                    8. gold                          454 ( 2.2%)                                                       
                    9. burgundy                      328 ( 1.6%)                                                       
                    10. beige                        301 ( 1.4%)                                                       
                    [ 8 others ]                     596 ( 2.9%)                                                       

12   interior       1. black                        9610 (46.2%)            IIIIIIIII             20796      30        
     [character]    2. gray                         7364 (35.4%)            IIIIIII               (99.9%)    (0.1%)    
                    3. beige                        1356 ( 6.5%)            I                                          
                    4. tan                          1259 ( 6.1%)            I                                          
                    5. brown                         527 ( 2.5%)                                                       
                    6. â€”                           489 ( 2.4%)                                                       
                    7. red                            57 ( 0.3%)                                                       
                    8. silver                         44 ( 0.2%)                                                       
                    9. blue                           34 ( 0.2%)                                                       
                    10. purple                        15 ( 0.1%)                                                       
                    [ 6 others ]                      41 ( 0.2%)                                                       

13   seller         1. u-haul                         958 ( 4.6%)                                 20826      0         
     [character]    2. enterprise veh exchange/r      679 ( 3.3%)                                 (100.0%)   (0.0%)    
                    3. the hertz corporation          630 ( 3.0%)                                                      
                    4. avis corporation               544 ( 2.6%)                                                      
                    5. santander consumer             517 ( 2.5%)                                                      
                    6. enterprise holdings/gdp        503 ( 2.4%)                                                      
                    7. chrysler capital               497 ( 2.4%)                                                      
                    8. hertz corporation/gdp          485 ( 2.3%)                                                      
                    9. pv holding inc/gdp             454 ( 2.2%)                                                      
                    10. ge fleet services for its     432 ( 2.1%)                                                      
                    [ 2945 others ]                 15127 (72.6%)           IIIIIIIIIIIIII                             

14   mmr            Mean (sd) : 17493.5 (13122.6)   1032 distinct values    :                     20826      0         
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)    
                    175 &lt; 16050 &lt; 182000                                    : .                                        
                    IQR (CV) : 11100 (0.8)                                  : :                                        
                                                                            : : .                                      

15   sellingprice   Mean (sd) : 17296.7 (13121.9)   907 distinct values     :                     20826      0         
     [numeric]      min &lt; med &lt; max:                                        :                     (100.0%)   (0.0%)    
                    300 &lt; 15900 &lt; 183000                                    : .                                        
                    IQR (CV) : 11200 (0.8)                                  : :                                        
                                                                            : : .                                      

16   saledate       1. Tue Feb 10 2015 01:30:00       165 ( 0.8%)                                 20826      0         
     [character]    2. Tue Mar 03 2015 01:30:00       164 ( 0.8%)                                 (100.0%)   (0.0%)    
                    3. Tue Feb 17 2015 01:30:00       151 ( 0.7%)                                                      
                    4. Tue Feb 03 2015 01:30:00       149 ( 0.7%)                                                      
                    5. Thu Feb 05 2015 01:30:00       148 ( 0.7%)                                                      
                    6. Thu Feb 26 2015 03:00:00       142 ( 0.7%)                                                      
                    7. Thu Jan 22 2015 01:30:00       141 ( 0.7%)                                                      
                    8. Tue Jan 27 2015 01:30:00       139 ( 0.7%)                                                      
                    9. Tue Jun 16 2015 02:30:00       127 ( 0.6%)                                                      
                    10. Thu Mar 05 2015 01:30:00      125 ( 0.6%)                                                      
                    [ 1675 others ]                 19375 (93.0%)           IIIIIIIIIIIIIIIIII                         

17   Body_Type      1. Convertible                   282 ( 1.5%)                                  19085      1741      
     [character]    2. Coupe                         438 ( 2.3%)                                  (91.6%)    (8.4%)    
                    3. Hatchback                    2129 (11.2%)            II                                         
                    4. Minivan                      7760 (40.7%)            IIIIIIII                                   
                    5. Pickup                       4225 (22.1%)            IIII                                       
                    6. Sedan                        1816 ( 9.5%)            I                                          
                    7. SUV                          2052 (10.8%)            II                                         
                    8. Wagon                         383 ( 2.0%)                                                       

18   YMM            1. 2014 Chrysler Town and Co     2829 (13.6%)           II                    20826      0         
     [character]    2. 2014 Ford E-Series Van        1114 ( 5.3%)           I                     (100.0%)   (0.0%)    
                    3. 2013 Chrysler Town and Co      897 ( 4.3%)                                                      
                    4. 2012 NA NA                     781 ( 3.8%)                                                      
                    5. 2014 Chevrolet Captiva Sp      509 ( 2.4%)                                                      
                    6. 2008 Ford F-250 Super Dut      474 ( 2.3%)                                                      
                    7. 2008 Dodge Ram Pickup 150      473 ( 2.3%)                                                      
                    8. 2013 Chevrolet Captiva Sp      406 ( 1.9%)                                                      
                    9. 2008 Chrysler Town and Co      384 ( 1.8%)                                                      
                    10. 2010 Dodge Ram Pickup 150     379 ( 1.8%)                                                      
                    [ 339 others ]                  12580 (60.4%)           IIIIIIIIIIII                               

19   Segment        All NA's                                                                      0          20826     
     [character]                                                                                  (0.0%)     (100.0%)  

20   AVG_MSRP       All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

21   MSRP_Range     All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

22   Trim_Count     All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

23   StdDev_MSRP    All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

24   Error.MSRP     All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

25   Error %        All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  

26   %MSRP_Range    All NA's                                                                      0          20826     
     [numeric]                                                                                    (0.0%)     (100.0%)  
-----------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="appendix-f" class="level2">
<h2 class="anchored" data-anchor-id="appendix-f">Appendix F:</h2>
<p>Finalized and cleaned auction data <em>carprices.</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(carprices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
carprices  
Dimensions: 440582 x 24  
Duplicates: 1043  

-----------------------------------------------------------------------------------------------------------------------
No   Variable       Stats / Values                  Freqs (% of Valid)       Graph                 Valid      Missing  
---- -------------- ------------------------------- ------------------------ --------------------- ---------- ---------
1    year           Mean (sd) : 2011.7 (2.1)        2007 :  29503 ( 6.7%)    I                     440582     0        
     [numeric]      min &lt; med &lt; max:                2008 :  28910 ( 6.6%)    I                     (100.0%)   (0.0%)   
                    2007 &lt; 2012 &lt; 2015              2009 :  20172 ( 4.6%)                                              
                    IQR (CV) : 2 (0)                2010 :  25510 ( 5.8%)    I                                         
                                                    2011 :  48099 (10.9%)    II                                        
                                                    2012 : 100873 (22.9%)    IIII                                      
                                                    2013 :  97936 (22.2%)    IIII                                      
                                                    2014 :  80986 (18.4%)    III                                       
                                                    2015 :   8593 ( 2.0%)                                              

2    make           1. Ford                          76396 (17.3%)           III                   440582     0        
     [character]    2. Chevrolet                     51555 (11.7%)           II                    (100.0%)   (0.0%)   
                    3. Nissan                        43409 ( 9.9%)           I                                         
                    4. Toyota                        31100 ( 7.1%)           I                                         
                    5. Dodge                         28416 ( 6.4%)           I                                         
                    6. Honda                         19364 ( 4.4%)                                                     
                    7. Hyundai                       18239 ( 4.1%)                                                     
                    8. Kia                           16219 ( 3.7%)                                                     
                    9. BMW                           15552 ( 3.5%)                                                     
                    10. INFINITI                     13916 ( 3.2%)                                                     
                    [ 59 others ]                   126416 (28.7%)           IIIII                                     

3    model          1. Altima                        17283 ( 3.9%)                                 440582     0        
     [character]    2. Fusion                        12607 ( 2.9%)                                 (100.0%)   (0.0%)   
                    3. Impala                        12084 ( 2.7%)                                                     
                    4. Focus                         11924 ( 2.7%)                                                     
                    5. F-150                         11780 ( 2.7%)                                                     
                    6. Escape                        10868 ( 2.5%)                                                     
                    7. Camry                         10407 ( 2.4%)                                                     
                    8. G37                            8765 ( 2.0%)                                                     
                    9. Charger                        7902 ( 1.8%)                                                     
                    10. Grand Caravan                 7134 ( 1.6%)                                                     
                    [ 508 others ]                  329828 (74.9%)           IIIIIIIIIIIIII                            

4    trim           1. SE                            43220 ( 9.9%)           I                     437241     3341     
     [character]    2. Base                          38248 ( 8.7%)           I                     (99.2%)    (0.8%)   
                    3. LX                            16546 ( 3.8%)                                                     
                    4. LT                            16386 ( 3.7%)                                                     
                    5. Limited                       15506 ( 3.5%)                                                     
                    6. XLT                           12476 ( 2.9%)                                                     
                    7. SXT                           10820 ( 2.5%)                                                     
                    8. GLS                           10553 ( 2.4%)                                                     
                    9. LE                            10456 ( 2.4%)                                                     
                    10. 2.5 S                        10374 ( 2.4%)                                                     
                    [ 1116 others ]                 252656 (57.8%)           IIIIIIIIIII                               

5    transmission   1. automatic                    380465 (97.3%)           IIIIIIIIIIIIIIIIIII   391040     49542    
     [character]    2. manual                        10575 ( 2.7%)                                 (88.8%)    (11.2%)  

6    Body_Type      1. Convertible                    7080 ( 1.6%)                                 436601     3981     
     [character]    2. Coupe                         14742 ( 3.4%)                                 (99.1%)    (0.9%)   
                    3. Hatchback                     22578 ( 5.2%)           I                                         
                    4. Minivan                       17672 ( 4.0%)                                                     
                    5. Pickup                        32990 ( 7.6%)           I                                         
                    6. Sedan                        213307 (48.9%)           IIIIIIIII                                 
                    7. SUV                          115740 (26.5%)           IIIII                                     
                    8. Wagon                         12492 ( 2.9%)                                                     

7    state          1. FL                            66449 (15.1%)           III                   440582     0        
     [character]    2. CA                            53754 (12.2%)           II                    (100.0%)   (0.0%)   
                    3. PA                            46643 (10.6%)           II                                        
                    4. TX                            37667 ( 8.5%)           I                                         
                    5. GA                            27253 ( 6.2%)           I                                         
                    6. NJ                            22365 ( 5.1%)           I                                         
                    7. IL                            20557 ( 4.7%)                                                     
                    8. TN                            19572 ( 4.4%)                                                     
                    9. OH                            17293 ( 3.9%)                                                     
                    10. MO                           14683 ( 3.3%)                                                     
                    [ 28 others ]                   114346 (26.0%)           IIIII                                     

8    condition      Mean (sd) : 3.6 (0.8)           36 distinct values                   . :       440582     0        
     [numeric]      min &lt; med &lt; max:                                                     : :       (100.0%)   (0.0%)   
                    1.5 &lt; 3.8 &lt; 5                                                  .   . : : : .                       
                    IQR (CV) : 1.3 (0.2)                                       :   : . : : : : :                       
                                                                               : : : : : : : : :                       

9    odometer       Mean (sd) : 51566.9 (37924.8)   125674 distinct values   :                     440569     13       
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    1 &lt; 40632 &lt; 999999                                       :                                         
                    IQR (CV) : 45156 (0.7)                                   :                                         
                                                                             : .                                       

10   color          1. black                        93179 (21.2%)            IIII                  439981     601      
     [character]    2. white                        86178 (19.6%)            III                   (99.9%)    (0.1%)   
                    3. gray                         69021 (15.7%)            III                                       
                    4. silver                       62762 (14.3%)            II                                        
                    5. blue                         36722 ( 8.3%)            I                                         
                    6. red                          34815 ( 7.9%)            I                                         
                    7. â€”                          24059 ( 5.5%)            I                                         
                    8. burgundy                      6431 ( 1.5%)                                                      
                    9. brown                         5583 ( 1.3%)                                                      
                    10. gold                         5469 ( 1.2%)                                                      
                    [ 10 others ]                   15762 ( 3.6%)                                                      

11   mmr            Mean (sd) : 16064.2 (9019.3)    1070 distinct values     :                     440582     0        
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    75 &lt; 13950 &lt; 176000                                      :                                         
                    IQR (CV) : 9900 (0.6)                                    : :                                       
                                                                             : :                                       

12   sellingprice   Mean (sd) : 15926 (9096.5)      1733 distinct values     :                     440582     0        
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    275 &lt; 13900 &lt; 173000                                     :                                         
                    IQR (CV) : 9900 (0.6)                                    : :                                       
                                                                             : :                                       

13   sale_year      1. 2014                          32075 ( 7.3%)           I                     440582     0        
     [character]    2. 2015                         408507 (92.7%)           IIIIIIIIIIIIIIIIII    (100.0%)   (0.0%)   

14   launch_date    1. 2006-09-01                   29503 ( 6.7%)            I                     440582     0        
     [Date]         2. 2007-09-01                   28910 ( 6.6%)            I                     (100.0%)   (0.0%)   
                    3. 2008-09-01                   20172 ( 4.6%)                                                      
                    4. 2009-09-01                   25510 ( 5.8%)            I                                         
                    5. 2010-09-01                   48099 (10.9%)            II                                        
                    6. 2011-09-01                   100873 (22.9%)           IIII                                      
                    7. 2012-09-01                   97936 (22.2%)            IIII                                      
                    8. 2013-09-01                   80986 (18.4%)            III                                       
                    9. 2014-09-01                   8593 ( 2.0%)                                                       

15   Date_Sold      min : 2014-01-01                168 distinct values                  . :       440582     0        
     [Date]         med : 2015-02-17                                                     : :   .   (100.0%)   (0.0%)   
                    max : 2015-07-21                                                     : :   :                       
                    range : 1y 6m 20d                                                    : :   :                       
                                                                                         : : . :                       

16   AVG_MSRP       Mean (sd) : 35480.9 (16141.4)   2166 distinct values     :                     440582     0        
     [numeric]      min &lt; med &lt; max:                                         : :                   (100.0%)   (0.0%)   
                    10478 &lt; 31287 &lt; 215813                                   : :                                       
                    IQR (CV) : 13329 (0.5)                                   : :                                       
                                                                             : : :                                     

17   Trim_Count     Mean (sd) : 14.1 (23.9)         81 distinct values       :                     440582     0        
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    1 &lt; 8 &lt; 224                                              :                                         
                    IQR (CV) : 7 (1.7)                                       :                                         
                                                                             :                                         

18   Error %        Mean (sd) : 4.7 (2.9)           159 distinct values      :                     440582     0        
     [numeric]      min &lt; med &lt; max:                                         :                     (100.0%)   (0.0%)   
                    0 &lt; 4.6 &lt; 99.9                                           :                                         
                    IQR (CV) : 2.7 (0.6)                                     :                                         
                                                                             :                                         

19   %MSRP_Range    Mean (sd) : 40.7 (22.7)         695 distinct values        : .                 440582     0        
     [numeric]      min &lt; med &lt; max:                                           : :                 (100.0%)   (0.0%)   
                    0 &lt; 39.1 &lt; 199.7                                           : :                                     
                    IQR (CV) : 20.2 (0.6)                                    : : :                                     
                                                                             : : : : . .                               

20   Segment        1. Mid-Size Car                 110030 (26.3%)           IIIII                 418309     22273    
     [character]    2. Compact Car                   80614 (19.3%)           III                   (94.9%)    (5.1%)   
                    3. Compact SUV/Crossover         51377 (12.3%)           II                                        
                    4. Mid-Size SUV/Crossover        45038 (10.8%)           II                                        
                    5. Full-Size Car                 26881 ( 6.4%)           I                                         
                    6. LD Full-Size Pickup           24419 ( 5.8%)           I                                         
                    7. Subcompact Car                20785 ( 5.0%)                                                     
                    8. Minivan                       16623 ( 4.0%)                                                     
                    9. Full-Size SUV/Crossover       13921 ( 3.3%)                                                     
                    10. Sports Car                   12985 ( 3.1%)                                                     
                    [ 3 others ]                     15636 ( 3.7%)                                                     

21   Age_months     Mean (sd) : 46.6 (25.8)         71 distinct values             :               440582     0        
     [numeric]      min &lt; med &lt; max:                                           . . :               (100.0%)   (0.0%)   
                    0 &lt; 42 &lt; 108                                               : : : :                                 
                    IQR (CV) : 29 (0.6)                                        : : : :       . .                       
                                                                             . : : : : : : : : :                       

22   Age_years      Mean (sd) : 3.9 (2.2)           0 :   3385 ( 0.8%)                             440582     0        
     [numeric]      min &lt; med &lt; max:                1 :  35432 ( 8.0%)       I                     (100.0%)   (0.0%)   
                    0 &lt; 4 &lt; 9                       2 : 112822 (25.6%)       IIIII                                     
                    IQR (CV) : 3 (0.6)              3 :  63738 (14.5%)       II                                        
                                                    4 : 103786 (23.6%)       IIII                                      
                                                    5 :  23061 ( 5.2%)       I                                         
                                                    6 :  30003 ( 6.8%)       I                                         
                                                    7 :  12962 ( 2.9%)                                                 
                                                    8 :  36563 ( 8.3%)       I                                         
                                                    9 :  18830 ( 4.3%)                                                 

23   RV_percent     Mean (sd) : 45.6 (17.7)         1230 distinct values           :               440582     0        
     [numeric]      min &lt; med &lt; max:                                             . : :             (100.0%)   (0.0%)   
                    0.7 &lt; 45.1 &lt; 124.7                                           : : :                                 
                    IQR (CV) : 23 (0.4)                                        : : : : :                               
                                                                             . : : : : : .                             

24   Annual_miles   Mean (sd) : Inf (NaN)           36291 distinct values                          440569     13       
     [numeric]      min &lt; med &lt; max:                                                               (100.0%)   (0.0%)   
                    0 &lt; 12375 &lt; Inf                                                                                    
                    IQR (CV) : 8504 (NaN)                                                                              
-----------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>More about the NHTSA’s vindecodr package:</p>
<p>Below is an example of the API call from the NHTSA’s website: <a href="https://vpic.nhtsa.dot.gov/api/Home/Index/LanguageExamples" class="uri">https://vpic.nhtsa.dot.gov/api/Home/Index/LanguageExamples</a></p>
<pre><code>require(RJSONIO)
# User-defined functions ----------------------------------
VehicleAPIrConnect &lt;- function(VINin){
    # Lookup VIN information from https://vpic.nhtsa.dot.gov/api
    #
    # Args:
    #   VINin: VIN
    #
    # Returns:
    #   Data frame with vehicle information.
    #
    # For Testing:
    # VINin &lt;- "5UXWX7C5*BA"
    tempCall &lt;- paste0("https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVinValues/", VINin, "?format=json")
    tempExtract &lt;- fromJSON(tempCall)
    dfOut &lt;- data.frame(t(unlist(tempExtract$Results)),stringsAsFactors=FALSE)
    dfOut
}
VehicleAPIrConnect("5UXWX7C5*BA")</code></pre>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Fall_2022" data-repo-id="R_kgDOH564Gw" data-category="Announcements" data-category-id="DIC_kwDOH564G84CRdBB" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Owen Tibby"</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Final Project"</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`" </span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> distill::distill_article</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Final Project (Second Submission)</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - Used Vehicle Data</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - Owen Tibby</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distill)</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vindecodr)</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) </span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">paged.print=</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Introduction**</span></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>Introduction &amp; Purpose of the Study:</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a>The automotive sector is a major part of the US economy and is among the hardest hit by the ripple effects of the COVID-19 pandemic. Factory closures and lockdowns led to a supply shortage of critical vehicle components necessary for new car production. Consequently, this has significantly increased the demand and value of used cars. However, some experts believe the market will return to 'normal' by the end of 2023. But what did the market look like before the pandemic?</span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>The purpose of this study is to explore the realm of the used car market, specifically, the wholesale sector. The primary data was gathered from a public domain and represents Manheim auction sales between wholesalers/ remarketers and wholesale buyers/ dealers of used vehicles. I am interested in exploring the retained value of vehicles based on their segment, body type, and age. Correlations between vehicle condition and mileage will also be analyzed.</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>Research Question: How do age, mileage, body style, and condition affect the retained value of a used vehicle?</span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Data &amp; Methodology:**</span></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Reading in the Data</span></span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Read In, message=FALSE, warning=FALSE}</span></span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="co"># # #RStudio Desktop</span></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"_data/car_prices2.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, </span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>,  <span class="st">"skip"</span>))</span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> carprices</span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>exchange_rate <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"_data/Historical_Prices.xlsx"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Second Read-In of ca_catalog (to make data fields private)</span></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/ca_catalog2.csv"</span>)</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a><span class="co">#Read-In from code chunk</span></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/decoded.keys1.csv"</span>)</span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Cloud Read In, message=FALSE, warning=FALSE, include=FALSE}</span></span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a><span class="co"># # # #RStudio Cloud</span></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a><span class="co">#  carprices &lt;-read_csv("/cloud/project/Final_project/car_prices.csv",</span></span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a><span class="co">#      col_types = cols(mmr = col_number(), year = col_character(), sellingprice = col_number(), ...17 = col_skip()))</span></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a><span class="co">#   ca_catalog &lt;- read_csv("/cloud/project/Final_project/ca_catalog.csv")</span></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a><span class="co">#  exchange_rate &lt;- read_excel("/cloud/project/Final_project/HistoricalPrices.xlsx",  col_types = c("numeric", "text", "skip", "skip", "skip", "numeric"))</span></span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a>**Description of Data:**</span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a>The primary data used in the analysis was the 'carprices.csv' data set from Kaggle (see appendix A). This data set contains historical used vehicle auction transactions that took place between 2014 and 2015. The data was collected from Manheim auction houses across the 34 states in the USA. Each observation details a wholesale auction transaction that includes: the vehicle information, state/province, selling price, sale date, and the market average price i.e., the Manheim Market Report price (MMR) and other specifics about the sale.</span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a><span class="fu">#### </span></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Primary Objectives**</span></span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>*Data Cleansing:*</span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Have consistency in the names of vehicle makes and models by using appropriate packages and joins.</span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Obtain MSRP from by joining with a catalog</span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a>*Data Analysis:*</span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Calculate vehicle age as a variable in both years and months.</span>
<span id="cb83-102"><a href="#cb83-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-103"><a href="#cb83-103" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Compute retained value as a percentage of each vehicle's MSRP</span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Compute standard error as a percentage of the mean MSRP for each model and filter transactions with a low error rating for deeper analysis.</span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Analyze the impact of age, mileage, condition, and segment on retained value</span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Determine the segments (eg. compact cars, midsize cars, etc.) and vehicles with the highest retained value percentage.\</span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Methods:**</span></span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a>Retained Value (RV) is calculated by dividing the selling price (auction value) by the vehicle's MSRP.</span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a>Retained Value% = Wholesale Price/ MSRP&nbsp;</span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>I was able to source MSRPs from a Canadian vehicle catalog *(Appendix B)* . To protect the data confidentiality, the MSRPs in the Canadian dollar catalog were averaged for each year, make, and model by trim level. In other words, I aggregated and derived the mean of the MSRPs of all trims belonging to a specific year, make and model, or YMM to reduce the level of detail. Therefore, MSRPs for trims belonging to a particular year, make and model shows the mean MSRP for the entire YMM group.&nbsp;</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/process_RV.jpg)</span>{fig-align="center"}</span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a>Using the YMM as a key common to the 'carprices' data as well as the ca_catalog, I can combine both and fetch the MSRP. Unsurprisingly, this left one more challenge, the MSRPs are listed in Canadian Dollars. In order to convert it to US Dollars, I will have to find and divide each vehicle MSRP by the USD: CAD exchange rate at the time of release. I was able to source the FX rate from 2006 and onwards using 'exchange_rate.csv' data obtained from WSJ Markets. Considering the below assumptions, I joined the exchange_rate.csv to carprices.csv using launch year as the common key between both data frames. Each MSRP was then divided by the daily close rate of the USD-CAD.&nbsp;</span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a>Important assumptions to get MSRP in USD:&nbsp;</span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Canadian vehicles &amp; trims are priced similarly with US trims.&nbsp;</span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>All vehicles were released in September of the previous year. i.e., a 2013 vehicle was available for sale in September 2012.&nbsp;</span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The exchange rate at the time of release was the closing FX rate at Aug-31st&nbsp;</span>
<span id="cb83-130"><a href="#cb83-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-131"><a href="#cb83-131" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Data Cleansing:**</span></span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a><span class="fu">##### **Observing the data**</span></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r results='hide'}</span></span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a>Table 1.0: Auction Data (Preview)</span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Intro, message=FALSE, warning=FALSE, echo= TRUE}</span></span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(carprices)))</span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, echo= TRUE, results='hide'}</span></span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing and removing all records for model year 2006 and older &amp; all erroneous prices</span></span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">&gt;</span> <span class="dv">2006</span>, sellingprice<span class="sc">&gt;</span><span class="dv">100</span>)</span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of states and body types</span></span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span>  <span class="fu">select</span>(state) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() </span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>state)</span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>body <span class="ot">&lt;-</span> <span class="fu">toupper</span>(carprices<span class="sc">$</span>body)</span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-157"><a href="#cb83-157" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Cleaning the Data: Mapping and Joining</span></span>
<span id="cb83-158"><a href="#cb83-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, echo=TRUE, results='hide'}</span></span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the consistency in the names of Body types}</span></span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> <span class="fu">select</span>(body) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Body Type column</span></span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Body_Type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(body, <span class="st">"EDAN"</span>)<span class="sc">~</span> <span class="st">"Sedan"</span>, <span class="fu">str_detect</span>(body, <span class="st">"SUV"</span>) <span class="sc">~</span> <span class="st">"SUV"</span>, <span class="fu">str_detect</span>(body, <span class="st">"AB"</span>) <span class="sc">~</span> <span class="st">"Pickup"</span>, <span class="fu">str_detect</span>(body, <span class="st">"OUP"</span>)<span class="sc">~</span> <span class="st">"Coupe"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>, <span class="st">"VAN"</span>)<span class="sc">~</span> <span class="st">"Minivan"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ONV"</span>)<span class="sc">~</span> <span class="st">"Convertible"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"AGO"</span>) <span class="sc">~</span> <span class="st">"Wagon"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"ATCH"</span>)<span class="sc">~</span> <span class="st">"Hatchback"</span>, <span class="fu">str_detect</span>(<span class="st">`</span><span class="at">body</span><span class="st">`</span>,<span class="st">"CREW"</span>)<span class="sc">~</span> <span class="st">"Pickup"</span> ))</span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a>Joining multiple files to get the MSRP from a historical catalog. The code below shows what I did to write a new CSV file (that does not include the original MSRP but rather the mean MSRP and the other useful fields like trim count and Error.</span>
<span id="cb83-170"><a href="#cb83-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-171"><a href="#cb83-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Creating a Join key, message=FALSE, warning=FALSE, eval=FALSE}</span></span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a Key in the CDN catalog</span></span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span>  ca_catalog <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">YearOfLaunch=</span> <span class="st">`</span><span class="at">Model Year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Catalog with MSRP in CAD</span></span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Combined</span><span class="st">`</span>, <span class="st">`</span><span class="at">YearOfLaunch</span><span class="st">`</span>, <span class="st">`</span><span class="at">Segment</span><span class="st">`</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>( <span class="at">Trim_Count=</span><span class="fu">n</span>(), <span class="at">AVG_MSRP_CAD=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">MSRP_Range_CAD=</span> (<span class="fu">max</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)<span class="sc">-</span> <span class="fu">min</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>)), <span class="at">StdDev_MSRP_CAD=</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>), <span class="at">Error.MSRP_CAD=</span> <span class="fu">std.error</span>(<span class="st">`</span><span class="at">MSRP</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">FALSE</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a><span class="co">#Writing CSV to exclude confidential MSRPs and only include the AVG_MSRP field</span></span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ca_catalog, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">ca_catalog.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a>Join #1</span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r First Join, , paged.print=TRUE , echo=TRUE}</span></span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining the data to convert CAD MSRP to USD MSRP later</span></span>
<span id="cb83-189"><a href="#cb83-189" aria-hidden="true" tabindex="-1"></a>ca_catalog <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ca_catalog, exchange_rate, <span class="fu">c</span>(<span class="st">"YearOfLaunch"</span><span class="ot">=</span> <span class="st">"Year"</span>))</span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating US$ Catalog and Converting to MSRP from CAD to USD</span></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> ca_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVG_MSRP=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">AVG_MSRP_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>), <span class="at">digits =</span> <span class="dv">0</span>), <span class="at">MSRP_Range=</span> <span class="st">`</span><span class="at">MSRP_Range_CAD</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">StdDev_MSRP=</span> <span class="st">`</span><span class="at">StdDev_MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span>, <span class="at">Error.MSRP=</span> <span class="st">`</span><span class="at">Error.MSRP_CAD</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">Close</span><span class="st">`</span> )</span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a><span class="co">#Finalizing US Catalog for Joining</span></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a>us_catalog <span class="ot">&lt;-</span> us_catalog <span class="sc">%&gt;%</span> </span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Combined, Segment, AVG_MSRP, MSRP_Range, Trim_Count, StdDev_MSRP, Error.MSRP) <span class="sc">%&gt;%</span> </span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">Error.MSRP</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">1</span>), <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>((<span class="st">`</span><span class="at">MSRP_Range</span><span class="st">`</span><span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>), <span class="at">digits=</span><span class="dv">1</span>))</span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-200"><a href="#cb83-200" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a common key to join carprices and us_catalog</span></span>
<span id="cb83-201"><a href="#cb83-201" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year2=</span>year, <span class="at">make2=</span>make, <span class="at">model2=</span>model)</span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(<span class="st">`</span><span class="at">YMM</span><span class="st">`</span>, <span class="st">`</span><span class="at">year2</span><span class="st">`</span>, <span class="st">`</span><span class="at">make2</span><span class="st">`</span>, <span class="st">`</span><span class="at">model2</span><span class="st">`</span>, <span class="at">sep=</span><span class="st">" "</span>)</span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a>Join #2</span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Second Join, message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining Data with us_catalog</span></span>
<span id="cb83-209"><a href="#cb83-209" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">left_join</span>(carprices, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) </span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a><span class="co">#saving our raw records before filtering</span></span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a>raw_carprices <span class="ot">&lt;-</span> carprices</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering NAs out the keys that were not mapped to an MSRP using YMM</span></span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a><span class="co">#(Will run these false keys through a vin decoder to get exact matches)</span></span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(AVG_MSRP))</span>
<span id="cb83-217"><a href="#cb83-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing the false_keys from main dataset</span></span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(AVG_MSRP)) </span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a>us_catalog<span class="sc">$</span>Combined <span class="ot">&lt;-</span> <span class="fu">toupper</span>(us_catalog<span class="sc">$</span>Combined)</span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>vin <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>vin)</span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>make <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>make)</span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a>false_keys<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">toupper</span>(false_keys<span class="sc">$</span>model)</span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Cleaning the Data: Decoding &amp; More Joining</span></span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a>Vin deocder function used to decode all VINs that were not matched. This was available from the vindecodr package in R contributed by the NHTSA.</span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a>The code below shows how I created the 'decoded_keys' csv file that I read in earlier. I have set eval=FALSE because of the lengthy run time.</span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Vin Decoder: cleaning unmtached records, eval=FALSE, echo=TRUE}</span></span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a><span class="co"># To clean Year, make, Model fields in false_keys (code run time = 3hrs + 13mins)</span></span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-236"><a href="#cb83-236" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span>false_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) </span>
<span id="cb83-237"><a href="#cb83-237" aria-hidden="true" tabindex="-1"></a>VinIn <span class="ot">&lt;-</span> VinIn<span class="sc">$</span>vin</span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a>decode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a> VIN<span class="ot">&lt;-</span> <span class="fu">decode_vin</span>(x)}</span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(VinIn,  decode)</span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a><span class="co">#Saving the above output as a CSV</span></span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(decoded_keys, <span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Owen-Matthew</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">Github</span><span class="sc">\\</span><span class="st">601_Fall_2022</span><span class="sc">\\</span><span class="st">posts</span><span class="sc">\\</span><span class="st">decoded_keys.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb83-246"><a href="#cb83-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Read-In decoded keys, eval=FALSE, message=FALSE, warning=FALSE, echo=TRUE}</span></span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a><span class="co"># # #R Studio Desktop Read In</span></span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a><span class="do">##Cleaned False keys (Imported at read in so I set eval= FALSE)</span></span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a>decoded_keys <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"decoded.keys.csv"</span>)</span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a><span class="co">#R Studio Cloud Read In</span></span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a><span class="co"># decoded_keys &lt;- read_csv("/cloud/project/Final_project/decoded.keys1.csv")</span></span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 1. Inner Join_Matching cleaned records with catalog, message=FALSE, warning=FALSE, echo=FALSE}</span></span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span> decoded_keys</span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a>action_keys<span class="sc">$</span>make <span class="ot">&lt;-</span> <span class="fu">toupper</span>(action_keys<span class="sc">$</span>make)</span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>action_keys<span class="sc">$</span>model <span class="ot">&lt;-</span> <span class="fu">toupper</span>(action_keys<span class="sc">$</span>model)</span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a>action_keys<span class="sc">$</span>VIN <span class="ot">&lt;-</span> <span class="fu">toupper</span>(action_keys<span class="sc">$</span>VIN)</span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span>  action_keys <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(model)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(VIN)) </span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> action_keys</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with Catalog</span></span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span>  a_keys <span class="sc">%&gt;%</span> </span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model_year, make,model, VIN) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">year=</span> model_year, <span class="at">make2=</span>make, <span class="at">model2=</span>model) <span class="sc">%&gt;%</span> <span class="fu">unite</span> (YMM, model_year, make2, model2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a>a_keys <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(a_keys, us_catalog, <span class="fu">c</span>(<span class="st">"YMM"</span><span class="ot">=</span> <span class="st">"Combined"</span> ))</span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 2. Inner Join_Matching cleaned records with catalog, message=FALSE, warning=FALSE, echo=FALSE, results='hide', include=FALSE, eval=FALSE}</span></span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking to see if a vehicle was auctioned multiple times, to see if we need to include sale date as a matching key</span></span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a>unique_check <span class="ot">&lt;-</span> a_keys <span class="sc">%&gt;%</span>  <span class="fu">select</span>(<span class="st">`</span><span class="at">VIN</span><span class="st">`</span>)</span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(<span class="fu">count</span>(unique_check)<span class="sc">-</span><span class="fu">count</span>(<span class="fu">unique</span>(unique_check)), <span class="st">" "</span>, <span class="st">"are multiple/ duplicated YMMs that failed to have a match with the catalog. These vehicles may have been auctioned multiple times. Possibly when the title was clean and again when salvaged. We can test this hypothesis by observing the vehicle condition. However, that is outside of the scope of this analysis. "</span>))</span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a>Join #3</span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 1. Tidying &amp; more Joining,echo=TRUE,message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting useful columns in false_keys</span></span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a>f_keys <span class="ot">&lt;-</span> false_keys</span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a>false_keys <span class="ot">&lt;-</span> false_keys <span class="sc">%&gt;%</span></span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate)</span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a><span class="co">#Join with false keys to get sale records</span></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a><span class="co">#cleaned_keys= inner_join(a_keys, false_keys, c("VIN" = "vin")) %&gt;% select(1:26) %&gt;% rename("vin" = "VIN")</span></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span>  <span class="fu">inner_join</span>(false_keys, a_keys, <span class="fu">c</span>(<span class="st">"vin"</span> <span class="ot">=</span> <span class="st">"VIN"</span>))</span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a><span class="co">#saving unmatched NAs for future wrangling</span></span>
<span id="cb83-292"><a href="#cb83-292" aria-hidden="true" tabindex="-1"></a>action_keys <span class="ot">&lt;-</span> action_keys <span class="sc">%&gt;%</span>   <span class="fu">select</span>(model_year, make,model, VIN) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">year=</span> model_year, <span class="at">make2=</span>make, <span class="at">model2=</span>model) <span class="sc">%&gt;%</span> <span class="fu">unite</span> (YMM, model_year, make2, model2, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb83-293"><a href="#cb83-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a><span class="co">#saving unmatched keys</span></span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a>unmatched_keys <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(f_keys, cleaned_keys, <span class="fu">c</span>(<span class="st">"vin"</span><span class="ot">=</span> <span class="st">"vin"</span>))</span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>Join #4-5</span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 1. Manually cleaning unmatched records, tidying &amp; more Joining,echo=TRUE,message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a><span class="co">#Attempting to clean the most common unmatched keys manually</span></span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span> <span class="fu">mutate</span>(unmatched_keys, <span class="at">year2=</span>year, <span class="at">year3=</span>year, <span class="at">make2=</span>make, <span class="at">make3=</span>make, <span class="at">model2 =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(model,<span class="st">"6 SERIES"</span>)<span class="sc">~</span> <span class="st">"6 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"3 SERIES"</span>)<span class="sc">~</span> <span class="st">"3 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"4 SERIES"</span>)<span class="sc">~</span> <span class="st">"4 SERIES"</span>,<span class="fu">str_detect</span>(model, <span class="st">"5 SERIES"</span>)<span class="sc">~</span> <span class="st">"5 SERIES"</span>, <span class="fu">str_detect</span>(model, <span class="st">"CAPTIVA"</span>)<span class="sc">~</span> <span class="st">"CAPTIVA"</span>,<span class="fu">str_detect</span>(model, <span class="st">"OUTLANDER"</span>)<span class="sc">~</span> <span class="st">"OUTLANDER"</span>, <span class="fu">str_detect</span>(model, <span class="st">"RAM PICKUP 1500"</span>)<span class="sc">~</span> <span class="st">"RAM 1500"</span>, <span class="fu">str_detect</span>(model, <span class="st">"TOWN AND COUNTRY"</span>)<span class="sc">~</span> <span class="st">"TOWN &amp; COUNTRY"</span>,  <span class="fu">str_detect</span>(model, <span class="fu">c</span>(<span class="st">"750I"</span>, <span class="st">"7 SERIES"</span>,  <span class="st">"750LI"</span>))<span class="sc">~</span> <span class="st">"7 SERIES"</span> ), <span class="at">model3=</span>model2)</span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span>  unmatched_keys_clean <span class="sc">%&gt;%</span>  <span class="fu">unite</span>(YMM2, year2, make2, model2, <span class="at">sep=</span> <span class="st">" "</span>)</span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a>unmatched_keys_clean <span class="ot">&lt;-</span> unmatched_keys_clean <span class="sc">%&gt;%</span>  </span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year3, make3, model3, trim, body, Body_Type, transmission, vin, state , condition, odometer, color, interior,seller, mmr, sellingprice, saledate, YMM2) <span class="sc">%&gt;%</span></span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(make3), <span class="sc">!</span><span class="fu">is.na</span>(model3)) </span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a><span class="co">#An additional 6860 records were cleaned</span></span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a>cleaned_keys2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(unmatched_keys_clean, us_catalog, <span class="fu">c</span>(<span class="st">"YMM2"</span><span class="ot">=</span> <span class="st">"Combined"</span> )) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">year=</span> year3, <span class="at">make=</span>make3, <span class="at">model=</span>model3, <span class="at">YMM=</span>YMM2)</span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a><span class="co">#-------</span></span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a>unmatched_keys <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(unmatched_keys, cleaned_keys2, <span class="fu">c</span>(<span class="st">"vin"</span><span class="ot">=</span> <span class="st">"vin"</span>))</span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a>unmatched_unique <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(vin) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_unique), <span class="st">" "</span>, <span class="st">"unique vehicle VINs; "</span>))</span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a>unmatched_makes <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(make) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a>unmatched_models <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(model) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>unmatched_YMM <span class="ot">&lt;-</span> unmatched_keys <span class="sc">%&gt;%</span> <span class="fu">select</span>(YMM) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_makes), <span class="st">" "</span>, <span class="st">"unmatched makes; "</span>))</span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_models), <span class="st">" "</span>, <span class="st">"unmatched models: "</span>))</span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (<span class="fu">str_c</span>(<span class="fu">count</span>(unmatched_YMM), <span class="st">" "</span>, <span class="st">"unmatched YMM keys (Year-Make-Model)."</span>))</span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(a,b,c,d))</span>
<span id="cb83-327"><a href="#cb83-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a>Binding cleaned data sets</span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  Tidying &amp; row binding,echo=TRUE,message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a><span class="co">#---------</span></span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a><span class="co">#get column names &amp; order from carprices</span></span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a>check_cols <span class="ot">&lt;-</span>  <span class="fu">colnames</span>(carprices) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a><span class="co">#checking to see if the column order is the same</span></span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span> cleaned_keys[, check_cols]</span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a>cleaned_keys2 <span class="ot">&lt;-</span> cleaned_keys2[, check_cols]</span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging both sets of cleaned data (Auto and manually cleaned)</span></span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a>cleaned_keys <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(cleaned_keys, cleaned_keys2)</span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(cleaned_keys), <span class="at">caption =</span> <span class="st">"Table 1.1: Displaying cleaned keys"</span>))</span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(cleaned_keys2), <span class="at">caption =</span> <span class="st">"Table 1.2: Displaying cleaned keys2"</span>))</span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a>1st iteration of cleaning through decoder: 67% of the previous NA records were automatically cleaned (38208 of 57328 records) 2nd iteration of cleaning (Manually): 6860 records were manually cleaned. In total, 79% of the NAs were cleaned in the Year, Make, and Model fields</span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  Final bind ,echo=TRUE,message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a><span class="co">#reorganize cleaned keys to rbind with carprices data</span></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(carprices, cleaned_keys)</span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE, warning=FALSE, results='hide'}</span></span>
<span id="cb83-359"><a href="#cb83-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the Canadian records</span></span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state<span class="sc">==</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>))</span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluding Canadian records</span></span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state<span class="sc">!=</span> <span class="fu">c</span>(<span class="st">"AB"</span>, <span class="st">"ON"</span>, <span class="st">"QC"</span>, <span class="st">"NS"</span>))</span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Considerations:**</span></span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>This approximation of the MSRP using the YMM formed the basis for a lot of the analysis:</span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Computation was narrowed down to model level.** By using the mean MSRP for all trim levels, I can only analyze the retained value on the Year, Make, Model level i.e., not specific to the trim. For example, I can only analyze how a 3-year-old Toyota Camry retains its value but not a Toyota Camry XSE.&nbsp;</span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Normal distribution of mean price.** The mean of the MSRP assumes that the purchase of trims/packages above the base price mimics a normal distribution. That means that most customers will buy at or around the mean priced trim. Additionally, because trims often follow interval pricing, the mean MSRP of most passenger vehicles tends to be close to&nbsp;the median. Therefore, for the standard vehicle, there is generally not much variation between the median trim price and the mean price of all trims.&nbsp;</span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Useful statistics:** it was valuable to assess the number of trims for each model, the standard deviation, and the standard error in my approximation of MSRP. To further the analysis, I also included the Range in MSRP (price difference between top and base trim) as a percentage of mean MSRP, along with Error % in MSRP- which is the standard error divided by the mean MSRP. Since MSRP is the denominator in our RV equation, these metrics provide an idea of how accurate our retained value (RV) percentage is. They also serve as appropriate means of filtering out low-quality data and as a sanity check to statistical tests that were conducted on correlations and regressions.</span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-375"><a href="#cb83-375" aria-hidden="true" tabindex="-1"></a>The next critical variable is age. For this analysis, I will treat age as continuous in Age_months and Age_years. Like the above assumptions, I will assume that all vehicles of model year x are released in the Fall of the previous year (x-1). This will be done by creating the launch date variable and finding the difference from the sale date in months and years, to obtain the age of the vehicle at the time of sale. A deeper analysis will be placed on 2-year- to 6-year-old vehicle transactions. See the Appendix for more details about the variables.</span>
<span id="cb83-376"><a href="#cb83-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Calculations:</span></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Cleaning Error, message=FALSE, warning=FALSE, paged.print=TRUE, results='hide'}</span></span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carprices)</span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for NA values in AVG_MSRP and YMM</span></span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% filter(is.na(AVG_MSRP)) </span></span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a><span class="co"># carprices %&gt;% filter(is.na(YMM)) </span></span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a><span class="co">#Replacing na records in Error%</span></span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="ot">&lt;-</span> carprices<span class="sc">$</span><span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="dv">0</span>)</span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices<span class="co"># %&gt;% filter(`Error %` &lt;7)</span></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a><span class="co">#Observing new NA records for Bodytype</span></span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>na.body <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Body_Type))</span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Age Calculation   , message=FALSE, warning=FALSE, echo=TRUE}</span></span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 1</span></span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a>carprices<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(carprices<span class="sc">$</span>year))</span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">launch_month=</span> <span class="st">"9"</span>, <span class="at">launch_day=</span> <span class="st">"1"</span>, <span class="at">launch_year=</span> (<span class="st">`</span><span class="at">year</span><span class="st">`</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Launch Date Step 2</span></span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">launch_date=</span> <span class="fu">make_date</span>(<span class="at">year=</span> <span class="st">`</span><span class="at">launch_year</span><span class="st">`</span>, <span class="at">month =</span> <span class="st">`</span><span class="at">launch_month</span><span class="st">`</span>, <span class="at">day=</span><span class="st">`</span><span class="at">launch_day</span><span class="st">`</span>))</span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting saledate to a date variable</span></span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">separate</span>(saledate, <span class="at">into=</span> <span class="fu">c</span>(<span class="st">"ddd"</span>, <span class="st">"sale_month"</span>, <span class="st">"sale_day"</span>, <span class="st">"sale_year"</span>, <span class="st">"sale_time"</span>, <span class="st">"GMT"</span>, <span class="st">"TMZ"</span>), <span class="at">sep=</span><span class="st">" "</span>)   </span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding the format of the sale month</span></span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_month2=</span> <span class="fu">recode</span>(sale_month, <span class="st">`</span><span class="at">Jan</span><span class="st">`</span> <span class="ot">=</span><span class="st">"1"</span>, <span class="st">`</span><span class="at">Feb</span><span class="st">`</span><span class="ot">=</span> <span class="st">"2"</span>, <span class="st">`</span><span class="at">Mar</span><span class="st">`</span><span class="ot">=</span><span class="st">"3"</span>, <span class="st">`</span><span class="at">Apr</span><span class="st">`</span><span class="ot">=</span><span class="st">"4"</span>, <span class="st">`</span><span class="at">May</span><span class="st">`</span><span class="ot">=</span><span class="st">"5"</span>, <span class="st">`</span><span class="at">Jun</span><span class="st">`</span><span class="ot">=</span><span class="st">"6"</span>, <span class="st">`</span><span class="at">Jul</span><span class="st">`</span><span class="ot">=</span><span class="st">"7"</span>, <span class="st">`</span><span class="at">Aug</span><span class="st">`</span><span class="ot">=</span><span class="st">"8"</span>, <span class="st">`</span><span class="at">Sep</span><span class="st">`</span><span class="ot">=</span><span class="st">"9"</span>, <span class="st">`</span><span class="at">Oct</span><span class="st">`</span><span class="ot">=</span><span class="st">"10"</span>, <span class="st">`</span><span class="at">Nov</span><span class="st">`</span><span class="ot">=</span><span class="st">"11"</span>, <span class="st">`</span><span class="at">Dec</span><span class="st">`</span><span class="ot">=</span><span class="st">"12"</span> ))</span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Date_Sold</span></span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a><span class="co">#carprices &lt;- mutate(carprices, sale_year2=sale_year)</span></span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">sale_year2=</span>sale_year, <span class="at">Date_Sold =</span> <span class="fu">make_date</span>(<span class="at">year=</span>sale_year2, <span class="at">month =</span> sale_month2, <span class="at">day =</span> sale_day))</span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-414"><a href="#cb83-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyiing up: selecting important columns</span></span>
<span id="cb83-415"><a href="#cb83-415" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(year, make, model, trim, transmission, Body_Type, state, condition, odometer, color, mmr, sellingprice, sale_year, launch_date, Date_Sold, AVG_MSRP, Trim_Count, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="st">`</span><span class="at">%MSRP_Range</span><span class="st">`</span>, Segment ) </span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a><span class="co">#Age of vehicle</span></span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> <span class="fu">mutate</span>(carprices, <span class="at">Age_months=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(Date_Sold, launch_date, <span class="at">units=</span> <span class="st">"days"</span>))<span class="sc">/</span><span class="dv">30</span>))</span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Age Calculation &amp; Tidying   , message=FALSE, warning=FALSE, echo=TRUE, results='hide'}</span></span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for negatives in Vehicle Age</span></span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a>carprices <span class="sc">%&gt;%</span>  <span class="fu">select</span>(Age_months) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Age_months<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a><span class="co">#Recoding Vehicle Age</span></span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Age_months=</span><span class="fu">recode</span>(Age_months, <span class="st">`</span><span class="at">-8</span><span class="st">`</span><span class="ot">=</span><span class="dv">0</span>))</span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Age in years</span></span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a>carprices<span class="ot">&lt;-</span>carprices <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Age_years=</span><span class="fu">round</span>(Age_months<span class="sc">/</span><span class="dv">12</span>, <span class="dv">0</span>))</span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a>Below is the calculation of Retained Value:</span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Calculating Retained Value% }</span></span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a><span class="co">#Retained value and removing irrational RV%</span></span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">RV_percent=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">sellingprice</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">AVG_MSRP</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>))<span class="co"># %&gt;% filter(RV_percent&lt;125)</span></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(<span class="fu">head</span>(carprices)))</span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a><span class="co">#How does the distribution of RV% look?</span></span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(carprices$RV_percent)</span></span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a><span class="co">#Annual KMs</span></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Annual_miles=</span> <span class="fu">round</span>(odometer<span class="sc">/</span>Age_months <span class="sc">*</span> <span class="dv">12</span>, <span class="at">digits=</span><span class="dv">0</span>))</span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing Salvage title and damaged vehicles</span></span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition<span class="sc">&gt;</span><span class="fl">1.4999999</span>)</span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Visualizations**</span></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a>Before analyzing the impact of the independent variables on the retained value, I will first look at the relationship that each of the IVs have on each other using multiple dimensions.</span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Vehicle groups}</span></span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a><span class="co">#Establishing vehicle groups</span></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a><span class="co">#Error in Nissan records</span></span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a>mainstream <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Nissan"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Kia"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Volkswagen"</span>)</span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a>domestic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Buick"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Chevrolet"</span>, <span class="st">"Chrysler"</span>, <span class="st">"Dodge"</span>, <span class="st">"Ford"</span>, <span class="st">"GMC"</span>, <span class="st">"Jeep"</span>, <span class="st">"Lincoln"</span>, <span class="st">"Ram"</span>)</span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a>luxury <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BMW"</span>, <span class="st">"Audi"</span>, <span class="st">"Mercedes-Benz"</span>, <span class="st">"Porsche"</span>, <span class="st">"Lexus"</span>, <span class="st">"INFINITI"</span>, <span class="st">"Acura"</span>, <span class="st">"Genesis"</span>, <span class="st">"Volvo"</span>, <span class="st">"Cadillac"</span>, <span class="st">"Lincoln"</span>)</span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a>passenger <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Sedan"</span>, <span class="st">"SUV"</span>, <span class="st">"Coupe"</span>, <span class="st">"Convertible"</span>, <span class="st">"Wagon"</span>, <span class="st">"Hatchback"</span>, <span class="st">"Minivan"</span>)</span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a>pickup <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Pickup"</span>)</span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a>Japanese <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"Toyota"</span>, <span class="st">"Honda"</span>, <span class="st">"Nissan"</span>, <span class="st">"Mazda"</span>, <span class="st">"Subaru"</span>, <span class="st">"Scion"</span>, <span class="st">"Mitsubishi"</span>, <span class="st">"Suzuki"</span>)</span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a>Korean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Kia"</span>, <span class="st">"Hyundai"</span>, <span class="st">"Genesis"</span>)</span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a>Pop.European <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Audi"</span>, <span class="st">"BMW"</span>, <span class="st">"Mercedes-Benz"</span>, <span class="st">"Jaguar"</span>, <span class="st">"Land Rover"</span> )</span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a>comp.seg <span class="ot">&lt;-</span> <span class="fu">c</span>(mainstream, domestic, luxury)</span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a>comp.makes <span class="ot">&lt;-</span> <span class="fu">c</span>(Japanese, Korean, Pop.European)</span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation: Mileage, Age, Body, and Condition</span></span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Correlations, echo=TRUE}</span></span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between mileage and age (in months and years)</span></span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a>MLG.AGE1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>Age_months, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>)  , <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a>MLG.AGE2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>Age_years, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>) , <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between mileage and condition</span></span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a>MLG.CON1. <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>odometer, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between Age and Condition</span></span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a>AGE.CON1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>Age_months, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a>AGE.CON2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>Age_years, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a>RV.MLG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">var</span>(carprices<span class="sc">$</span>RV_percent, carprices<span class="sc">$</span>odometer, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and condition</span></span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a>RV.CON <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(carprices<span class="sc">$</span>RV_percent, carprices<span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>) </span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  Graph 1.1-1.2 Correlations, echo=TRUE, message=FALSE, warning=FALSE}</span></span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.1</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>, <span class="st">`</span><span class="at">domestic</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup), condition<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.1</span>) <span class="sc">+</span> </span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb83-502"><a href="#cb83-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">210000</span>)<span class="sc">+</span></span>
<span id="cb83-503"><a href="#cb83-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~Body_Type)+</span></span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Mileage"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.1: Relationship between Mileage, Condition and Age"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation between Mileage and Condition "</span>, <span class="st">" = "</span>, MLG.AGE1))</span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.2</span> <span class="ot">&lt;-</span> plot1<span class="fl">.1</span></span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.2</span>) <span class="sc">+</span> </span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (Age_years), <span class="at">color=</span> odometer) <span class="sc">+</span></span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb83-513"><a href="#cb83-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~Body_Type)+</span></span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Age"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.2: Relationship between Mileage, Condition and Age"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation between Age and Condition "</span>, <span class="st">" = "</span>, AGE.CON1))</span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a>Graphs 1.1 and 1.2 above show the inverse relationships across the condition, mileage, and age. While this relationship is very intuitive and almost trivial, a closer look will highlight that a vehicle's condition is more sensitive to mileage at lower ages. In other words, As vehicles age, the impact of mileage on condition decreases. This was illustrated in Graph 1.1 where the slope of the curve steadily decreased over time.</span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a>This may also be caused by the fact that older high-mileage vehicles tend not to be driven as much as younger low-mileage vehicles, due to cost and several other factors like reliability issues. An exception to this would be the rare case where older vehicles (or antiques) already in very good condition are intentionally driven less to preserve their condition. Therefore, aging but maintaining a higher condition rating. Fortunately, I am only analyzing models from 2006 and newer, so this "antique effect" is of no significance but is still worthy of mention for future research purposes.</span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Graph 1.3-1.4 More Correlations, echo=TRUE, warning=FALSE}</span></span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.3</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>, <span class="st">`</span><span class="at">domestic</span><span class="st">`</span>), Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup))</span>
<span id="cb83-528"><a href="#cb83-528" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-529"><a href="#cb83-529" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.3</span>) <span class="sc">+</span> </span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> (odometer), <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">180000</span>)<span class="sc">+</span></span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Body_Type)<span class="sc">+</span></span>
<span id="cb83-536"><a href="#cb83-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Mileage"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb83-537"><a href="#cb83-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.3: Relationship between Mileage, Condition, Age and Body Type"</span>)  </span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ,subtitle = str_c("Correlation between Mileage and Condition ", " = ", MLG.AGE1))</span></span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.4</span> <span class="ot">&lt;-</span> plot1<span class="fl">.3</span></span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1<span class="fl">.4</span>) <span class="sc">+</span> </span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span>condition , <span class="at">x =</span> Age_years, <span class="at">color=</span>odometer) <span class="sc">+</span></span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xlim(0, 200000)+</span></span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Body_Type)<span class="sc">+</span></span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">" Condition"</span>, <span class="at">x=</span> <span class="st">"Age"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 1.4: Relationship between Mileage, Age, Body Type and Condition"</span>)  </span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a>          <span class="co"># ,subtitle = str_c("Correlation between Mileage and Condition ", " = ", MLG.AGE1))</span></span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a>Keeping in mind the previous takeaways, graphs 1.3 and 1.4 illustrate the correlations by body type.</span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a>Unsurprisingly, among all body types, pickups and SUVs are least sensitive to mileage and age. This may be because most pickups and many SUVs are used for a wide range of purposes. They are engineered and designed to be driven more than other body types.</span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a>Insufficient data points to make conclusions about wagons and convertibles.</span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-560"><a href="#cb83-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,  include=FALSE}</span></span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> carprices</span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a>carprices <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RV_percent <span class="sc">&lt;</span> <span class="dv">125</span>)</span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation: Mileage, Age, Body, Condition and Retained Value</span></span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r RV_Mileage, echo=TRUE, warning=FALSE}</span></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.1</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(make<span class="sc">==</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">mainstream</span><span class="st">`</span>, <span class="st">`</span><span class="at">luxury</span><span class="st">`</span>), Body_Type<span class="sc">==</span><span class="fu">c</span>(passenger, pickup), RV_percent <span class="sc">&gt;</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) </span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and mileage</span></span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>RV.MLG <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">var</span>(plot2<span class="fl">.1</span><span class="sc">$</span>RV_percent, plot2<span class="fl">.1</span><span class="sc">$</span>odometer, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2<span class="fl">.1</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (odometer) , <span class="at">color=</span> Age_years) <span class="sc">+</span></span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Mileage"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">color=</span> <span class="st">"Age (Years)"</span>)<span class="sc">+</span></span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 2.1: Correlation between Retained Value and Mileage"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.MLG))</span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Graph 2.2 RV_condition, warning=FALSE, message=FALSE}</span></span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and condition</span></span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.2</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Age_months)</span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>RV.CON <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(plot2<span class="fl">.2</span><span class="sc">$</span>RV_percent, plot2<span class="fl">.2</span><span class="sc">$</span>condition, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2<span class="fl">.2</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span>condition, <span class="at">y =</span> (RV_percent)) <span class="sc">+</span></span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Condition"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 2.2: Correlation between Retained Value and Condition"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.CON)) </span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a>Graph 2.1 shows the inverse relationship and diminishing effect that mileage and age have on retained value. However, as seen in graph 2.2, on aggregate, retained value is more strongly correlated to the condition of the car than its mileage.</span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Auction Transactions by High-Volume States</span></span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a>This section aims to take a more comprehensive look at our data. I'll analyze the states with the most transactions to see if there are any unique patterns to observe.</span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb83-604"><a href="#cb83-604" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyzing the number of transactions by state by the age </span></span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a>vol.states<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">7</span>, Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, state) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a>vol.states <span class="sc">%&gt;%</span> </span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(state, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"dark blue"</span>) <span class="sc">+</span></span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"State"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Age_years))<span class="sc">+</span></span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"Graph 3.1: Number of Transactions by State (Faceted by Age in Years)"</span>)</span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>From Graph 3.1 above, we see that most vehicles are auctioned between ages 2 and 4 years. This corresponds to the popular lease terms of 24 to 48 months.</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Auction by state, echo=TRUE, warning=FALSE}</span></span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a>top.states <span class="ot">&lt;-</span> vol.states <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>   <span class="fu">group_by</span>(state, Age_years) <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>plot3<span class="fl">.2</span> <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span>  </span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(state<span class="sc">==</span>vol.states<span class="sc">$</span>state, Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, pickup), RV_percent<span class="sc">&gt;</span> <span class="dv">15</span>, Annual_miles<span class="sc">&lt;</span><span class="dv">25000</span> ) </span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between RV_percent and age</span></span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a>RV.AGE <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(plot3<span class="fl">.2</span><span class="sc">$</span>RV_percent, plot3<span class="fl">.2</span><span class="sc">$</span>Age_months, <span class="at">use=</span> <span class="st">"pairwise.complete.obs"</span>), <span class="at">digits=</span> <span class="dv">3</span>)</span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot3<span class="fl">.2</span>) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">y =</span> RV_percent, <span class="at">x =</span> (Age_months),  <span class="at">color=</span> Annual_miles) <span class="sc">+</span></span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)<span class="sc">+</span></span>
<span id="cb83-632"><a href="#cb83-632" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb83-633"><a href="#cb83-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" Age (Months)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">color=</span> <span class="st">"Mileage"</span>)<span class="sc">+</span></span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 3.2: Retained Value vs Age in High Volume States"</span>, <span class="at">subtitle =</span> <span class="fu">str_c</span>(<span class="st">"Correlation"</span>, <span class="st">" = "</span>, RV.AGE))</span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a>Graph 3.2 shows that generally, across the states with the most auction transactions, vehicles experience similar depreciation curves and correlations between age and mileage.</span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a>I filtered for the annual miles driven *AnnualMiles* to be less than 25,000/ year to filter out vehicles used for commercial purposes. This was done because commercial vehicles (eg. rental cars, taxis, fleet vehicles, etc. ) add another layer of complexity that is beyond the scope of this paper.</span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparative Analysis</span></span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a>This section will delve into more specific analyses with the aim of providing additional insights.</span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r by_segemnts, eval= TRUE, include=TRUE, message=FALSE, warning=FALSE}</span></span>
<span id="cb83-649"><a href="#cb83-649" aria-hidden="true" tabindex="-1"></a><span class="co">#Analysis by segment</span></span>
<span id="cb83-650"><a href="#cb83-650" aria-hidden="true" tabindex="-1"></a>by_segment <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&lt;</span> <span class="dv">8</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment)) <span class="sc">%&gt;%</span> <span class="co">#, make==c(mainstream, luxury)) %&gt;% </span></span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_years, Segment, sale_year, Age_months) <span class="sc">%&gt;%</span> </span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment_RV=</span> <span class="fu">round</span>(<span class="fu">mean</span>(RV_percent), <span class="at">digits=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Segment_RV)) <span class="sc">%&gt;%</span><span class="fu">arrange</span>((Age_years)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>((sale_year)) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) </span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> by_segment) <span class="sc">+</span> </span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_months, <span class="at">y =</span> Segment_RV, <span class="at">color =</span> <span class="st">`</span><span class="at">Segment</span><span class="st">`</span>, <span class="at">position=</span> <span class="st">"jitter"</span>), <span class="at">se=</span> F)<span class="sc">+</span></span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>,<span class="dv">75</span>)<span class="sc">+</span></span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Age (Months)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>, <span class="at">fill=</span> <span class="st">"Segment"</span>)<span class="sc">+</span></span>
<span id="cb83-660"><a href="#cb83-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 4.1 Retained Value % by Segment"</span>)</span>
<span id="cb83-661"><a href="#cb83-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Best Segments, message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the Segments with the highest RV</span></span>
<span id="cb83-665"><a href="#cb83-665" aria-hidden="true" tabindex="-1"></a>best_value_segments <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb83-666"><a href="#cb83-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> <span class="fu">c</span>(passenger, <span class="st">"Pickup"</span>), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="sc">!</span><span class="fu">is.na</span>(Segment), Segment <span class="sc">!=</span><span class="st">"HD Full-Size Pickup"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Segment,Age_years,  RV_percent, odometer, condition, model) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(Segment, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb83-672"><a href="#cb83-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Segment=</span>Segment, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="at">Mileage=</span><span class="fu">mean</span>(odometer), <span class="at">Condition=</span><span class="fu">mean</span>(condition),  <span class="at">Sample_Size =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-673"><a href="#cb83-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-674"><a href="#cb83-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>((Age_years))</span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(best_value_segments))</span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing a few missing fields in Segments that were missing in Catalog</span></span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a>BVS <span class="ot">&lt;-</span> best_value_segments <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Segment)) </span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-681"><a href="#cb83-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-682"><a href="#cb83-682" aria-hidden="true" tabindex="-1"></a>BVS <span class="sc">%&gt;%</span> </span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x =</span> Age_years, <span class="at">y =</span>(RV_percent)) <span class="sc">+</span></span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span> <span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">reorder</span>(Segment, <span class="sc">-</span>RV_percent))<span class="sc">+</span></span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Age (Years)"</span>, <span class="at">y=</span> <span class="st">"Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 4.2: Retained Value % vs. Age Ranked by Segment"</span>)</span>
<span id="cb83-688"><a href="#cb83-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-689"><a href="#cb83-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a>The graphical representation of data in Graphs 4.1 and 4.2 suggests that there is a hierarchy that exists among body types. Pickups have generally retained the best value across all years followed by SUVs and cars (sedans, coupes, convertibles, etc).</span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonus Section</span></span>
<span id="cb83-694"><a href="#cb83-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-695"><a href="#cb83-695" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How does RV% compare among volume models?</span></span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Volume models,message=FALSE, warning=FALSE}</span></span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a><span class="co">#Volume models</span></span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a>vol.models<span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Age_years <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-704"><a href="#cb83-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-705"><a href="#cb83-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> </span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years <span class="sc">&gt;</span><span class="dv">0</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-713"><a href="#cb83-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-714"><a href="#cb83-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-716"><a href="#cb83-716" aria-hidden="true" tabindex="-1"></a>popular.models <span class="ot">&lt;-</span>  vol.models.passenger<span class="sc">$</span>model</span>
<span id="cb83-717"><a href="#cb83-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 2. Volume models,message=FALSE, warning=FALSE}</span></span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a>vol.models.passenger <span class="sc">%&gt;%</span> </span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>n), <span class="at">y=</span> n) <span class="sc">+</span></span>
<span id="cb83-722"><a href="#cb83-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb83-723"><a href="#cb83-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Number of Transactions"</span>)<span class="sc">+</span></span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 5.1: Most Auctioned Models"</span>)</span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a>From Graph 5.1, it is easy to assume that the Nissan Altima is a highly sought-after vehicle and may therefore hold its value well. However, that may not be entirely true. Graph 5.2 will explore this further.</span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a>**Do the most auctioned vehicles retain the best value ?**</span>
<span id="cb83-731"><a href="#cb83-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-732"><a href="#cb83-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 1. Models with best RV, message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a>BVM <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model<span class="sc">==</span> vol.models.passenger<span class="sc">$</span>model) <span class="sc">%&gt;%</span> </span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger) <span class="sc">%&gt;%</span> </span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, odometer, condition, Segment) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),  <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-739"><a href="#cb83-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-740"><a href="#cb83-740" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb83-741"><a href="#cb83-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-742"><a href="#cb83-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span></span>
<span id="cb83-743"><a href="#cb83-743" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-744"><a href="#cb83-744" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb83-745"><a href="#cb83-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a>(<span class="fu">kable</span>(BVM))</span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a>Graph 5.2 shows that the most auctioned vehicles do not necessarily retain the best value. This may be due to an oversupply of these vehicles at auction, and with a higher supply, a lower price often follows.</span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a>Another reason could be low consumer sentiment toward these vehicles. After looking at the nature of the sellers, one can conclude that most of these vehicles are lease returns. Vehicles with high lease returns can imply a low consumer sentiment, therefore decreasing the long-term resale value.</span>
<span id="cb83-753"><a href="#cb83-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-754"><a href="#cb83-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 2. Models with best RV, message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a>vol.p.models <span class="ot">&lt;-</span> vol.models.passenger<span class="sc">$</span>model <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a>vol.vs.best.passenger <span class="ot">&lt;-</span> BVM <span class="sc">%&gt;%</span> <span class="fu">filter</span>(model<span class="sc">==</span> vol.p.models)</span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a>BVM <span class="sc">%&gt;%</span></span>
<span id="cb83-759"><a href="#cb83-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(model, <span class="sc">-</span>RV_percent), <span class="at">y=</span> RV_percent) <span class="sc">+</span></span>
<span id="cb83-760"><a href="#cb83-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">fill=</span> <span class="st">"dark orange"</span> ) <span class="sc">+</span></span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">"Model"</span>, <span class="at">y=</span><span class="st">"Mean Retained Value %"</span>)<span class="sc">+</span></span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Graph 5.2: Retained values of the Most Auctioned Models"</span> , <span class="at">subtitle =</span> <span class="st">"Mean Retained Value Percentage from Year 2 to 5"</span>)</span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Best mainstream cars to buy post-2015</span></span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Table Models with  best RV, message=FALSE, warning=FALSE, paged.print=TRUE}</span></span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the models with the highest RV</span></span>
<span id="cb83-770"><a href="#cb83-770" aria-hidden="true" tabindex="-1"></a>best_value_models <span class="ot">&lt;-</span> carprices <span class="sc">%&gt;%</span></span>
<span id="cb83-771"><a href="#cb83-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age_years<span class="sc">&gt;</span> <span class="dv">1</span>, Age_years <span class="sc">&lt;</span><span class="dv">6</span>, Body_Type<span class="sc">==</span> passenger, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span> <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-772"><a href="#cb83-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(make, model,Age_years,  RV_percent, <span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, odometer, condition, Segment) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-773"><a href="#cb83-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">RV_percentage =</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),  <span class="at">odometer=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent), <span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">odometer=</span><span class="fu">mean</span>(odometer),<span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-775"><a href="#cb83-775" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(make, model, Age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb83-776"><a href="#cb83-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">make=</span>make, <span class="at">model=</span>model, <span class="at">Age_years=</span> Age_years, <span class="at">RV_percent=</span> <span class="fu">mean</span>(RV_percent),<span class="st">`</span><span class="at">Error %</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">Error %</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">mileage=</span><span class="fu">mean</span>(odometer), <span class="at">condition=</span><span class="fu">mean</span>(condition),  <span class="at">n =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(RV_percent)) <span class="sc">%&gt;%</span></span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-779"><a href="#cb83-779" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filtering a sample size 20 or more</span></span>
<span id="cb83-780"><a href="#cb83-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-781"><a href="#cb83-781" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>((Age_years))</span>
<span id="cb83-782"><a href="#cb83-782" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">kable</span>(best_value_models, <span class="at">caption=</span> <span class="st">"Passengers Cars with Best RV"</span>))</span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a>While I won't be making any formal recommendations in this paper, the above table provides a guide on which vehicles can be expected to retain good value in the future. Please pay close attention to the error rating and the sample size.</span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Reflection**</span></span>
<span id="cb83-788"><a href="#cb83-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-789"><a href="#cb83-789" aria-hidden="true" tabindex="-1"></a>This project, though very time-consuming, has truly been worth every moment spent working on it. Possessing a solid foundation in MS Excel (my daily tool for analysis at work), it took some getting used to, and at times felt counterproductive trying to accomplish the same things in R. Although I'm new to programming, I intentionally chose to do as challenging a project as I possibly could with the knowledge I've learned in this course. The data that I used is almost identical to the type of data I analyze at work and is an area of great interest for me- the used car market. Despite the intrigue, I was a bit overwhelmed with the amount of tidying that was needed to complete the analysis. In truth, more time was spent on cleaning the data than anything else.</span>
<span id="cb83-790"><a href="#cb83-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-791"><a href="#cb83-791" aria-hidden="true" tabindex="-1"></a>An issue I had to contend with was that Canadian vehicle trims do not always have the same naming conventions as US trims. For example, a 2021 VW Jetta Highline in Canada may be listed as a 2021 VW Jetta SE/ SEL in the US. This, however, simplified the joining of the datasets because I was better able to match the YMM in both the auction data (carprices.csv) and the catalog now in USD (us_catalog).</span>
<span id="cb83-792"><a href="#cb83-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-793"><a href="#cb83-793" aria-hidden="true" tabindex="-1"></a>However, after joining the catalog I had 50,342 unmatched records that would be later passed through an iteration map function using the vindecoder() package. Subsequently, I still had to contend with 20,826 (out of 50,342 records) missing unmatched keys/MSRP values. Observing the distribution of vehicles in unmatched_keys (see appendix E), I was able to identify which models had a low map rate in the VIN decoder. After about 12 lines of code, I was able to clean an additional 6,860 records, leaving the total unmatched at 13,965.</span>
<span id="cb83-794"><a href="#cb83-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-795"><a href="#cb83-795" aria-hidden="true" tabindex="-1"></a>Instead of deleting them entirely, I saved them in a CSV file named 'unmatched_keys.csv'. As I progress through the DACSS program, I aim to practice more advanced ways to handle these situations. If time permits, my strategy to handle these untidy fields and unmatched_keys would be to use functions str_detect() and advanced mapping functions to clean the data as best as possible.</span>
<span id="cb83-796"><a href="#cb83-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-797"><a href="#cb83-797" aria-hidden="true" tabindex="-1"></a>Despite 13,965 out of 457,588 records (3%) of records not being matched, I do not believe that it will have a significant impact on the results. The unmatched records were due to the unavailability in the Canadian market of some US models as well as naming inconsistencies across YMM fields. Due to the fact I am mainly conducting my analysis on high-volume vehicle segments and models, this will only have a marginal to negligible effect on the quality of results.</span>
<span id="cb83-798"><a href="#cb83-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-799"><a href="#cb83-799" aria-hidden="true" tabindex="-1"></a>There are far more insights that can be drawn from this data. For example, comparing the average yearly mileage by state, comparing resale values for vehicles in colder states vs warmer states, as well as the popularity and distribution of various makes across the US. Those are just a few of the burning questions that I have not been able to address in this project. What is certain is that I will be continuing to work on this data with the hope to manipulate similar vehicle data for the Canadian wholesale marketplace for more work-related reasons.</span>
<span id="cb83-800"><a href="#cb83-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-801"><a href="#cb83-801" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Conclusion**</span></span>
<span id="cb83-802"><a href="#cb83-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-803"><a href="#cb83-803" aria-hidden="true" tabindex="-1"></a>The data analyzed was able to substantially answer the research question. Indeed factors like body type, vehicle condition, mileage, and age affect the retained value of vehicles. Excluding age for trivial reasons, overall, the condition had the largest impact (positive) followed by mileage (negative) of all the variables on RV. However, some segments were more sensitive to this effect than others. For example, convertibles were slightly more sensitive to mileage than any other body type; a stark contrast when compared to pickups and SUVs.</span>
<span id="cb83-804"><a href="#cb83-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-805"><a href="#cb83-805" aria-hidden="true" tabindex="-1"></a>Bearing in mind the key assumptions made when converting the MSRP from CAD to USD, I was quite surprised at how accurate the results were compared to actual public residual value data. It seems as though the pricing for Canadian trims coincides greatly with their US counterparts. Another observation was that the most auctioned/sold vehicles do not necessarily retain the best value. Despite, the higher error rating among various segments, I believe the estimation of RV% (based on dividing the auction price by mean MSRP), provides a solid understanding, once analyzed on aggregate and in context.</span>
<span id="cb83-806"><a href="#cb83-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-807"><a href="#cb83-807" aria-hidden="true" tabindex="-1"></a>The data suggests that except for pickups, SUVs- subcompact, compact and midsize, hold better value than standard passenger car body types. There seems to also be a resistance to price as vehicles with higher MSRPs tend to retain less value over time. This was evident when looking at graphs 4.1 and 4.2, where a clear hierarchy among body types and segments is observed.</span>
<span id="cb83-808"><a href="#cb83-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-809"><a href="#cb83-809" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Bibliography**</span></span>
<span id="cb83-810"><a href="#cb83-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-811"><a href="#cb83-811" aria-hidden="true" tabindex="-1"></a><span class="fu">#### *Data Sources:*</span></span>
<span id="cb83-812"><a href="#cb83-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-813"><a href="#cb83-813" aria-hidden="true" tabindex="-1"></a>Kaggle: <span class="co">[</span><span class="ot">Used Car Auction Prices \| Kaggle</span><span class="co">](https://www.kaggle.com/datasets/tunguz/used-car-auction-prices)</span></span>
<span id="cb83-814"><a href="#cb83-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-815"><a href="#cb83-815" aria-hidden="true" tabindex="-1"></a>WSJ Markets: <span class="co">[</span><span class="ot">USD to CAD \| Canadian Dollar Historical Prices - WSJ</span><span class="co">](https://www.wsj.com/market-data/quotes/fx/USDCAD/historical-prices)</span></span>
<span id="cb83-816"><a href="#cb83-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-817"><a href="#cb83-817" aria-hidden="true" tabindex="-1"></a><span class="fu">#### *Methodology:*</span></span>
<span id="cb83-818"><a href="#cb83-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-819"><a href="#cb83-819" aria-hidden="true" tabindex="-1"></a>*DACSS Faculty*, University of Massachusetts, Amherst</span>
<span id="cb83-820"><a href="#cb83-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-821"><a href="#cb83-821" aria-hidden="true" tabindex="-1"></a>Grolemund, G., &amp; Wickham, H. (2017). *R for Data Science*. O'Reilly Media.</span>
<span id="cb83-822"><a href="#cb83-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-823"><a href="#cb83-823" aria-hidden="true" tabindex="-1"></a>The National Highway Traffic Safety Administration: <span class="co">[</span><span class="ot">VIN Decoder \| NHTSA</span><span class="co">](https://www.nhtsa.gov/vin-decoder)</span></span>
<span id="cb83-824"><a href="#cb83-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-825"><a href="#cb83-825" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Yan Holtz</span><span class="co">](https://www.yan-holtz.com/)</span> <span class="co">[</span><span class="ot">The R Graph Gallery</span><span class="co">](https://r-graph-gallery.com/)</span></span>
<span id="cb83-826"><a href="#cb83-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-827"><a href="#cb83-827" aria-hidden="true" tabindex="-1"></a><span class="fu">#### *Supporting Tools &amp; Publications:*</span></span>
<span id="cb83-828"><a href="#cb83-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-829"><a href="#cb83-829" aria-hidden="true" tabindex="-1"></a>Auto Trader <span class="co">[</span><span class="ot">Used Cars for Sale - Autotrader</span><span class="co">](https://www.autotrader.com/cars-for-sale)</span></span>
<span id="cb83-830"><a href="#cb83-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-831"><a href="#cb83-831" aria-hidden="true" tabindex="-1"></a>Edmonds <span class="co">[</span><span class="ot">Top 10 Best-Selling Vehicles for 2013 on Edmunds.com</span><span class="co">](https://www.edmunds.com/car-reviews/top-10/top-10-best-selling-vehicles-for-2013.html)</span></span>
<span id="cb83-832"><a href="#cb83-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-833"><a href="#cb83-833" aria-hidden="true" tabindex="-1"></a>J.D. Power: <span class="co">[</span><span class="ot">2018 Resale Awards and Ratings \| J.D. Power</span><span class="co">](https://www.jdpower.com/Cars/Ratings/Depreciation/2018)</span></span>
<span id="cb83-834"><a href="#cb83-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-835"><a href="#cb83-835" aria-hidden="true" tabindex="-1"></a>Kelley Blue Book <span class="co">[</span><span class="ot">Kelley Blue Book</span><span class="co">](https://www.kbb.com/)</span></span>
<span id="cb83-836"><a href="#cb83-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-837"><a href="#cb83-837" aria-hidden="true" tabindex="-1"></a>VIN Decoder: <span class="co">[</span><span class="ot">Decode This</span><span class="co">](https://www.decodethis.com/)</span></span>
<span id="cb83-838"><a href="#cb83-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-839"><a href="#cb83-839" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Appendix**</span></span>
<span id="cb83-840"><a href="#cb83-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-841"><a href="#cb83-841" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix A:</span></span>
<span id="cb83-842"><a href="#cb83-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-843"><a href="#cb83-843" aria-hidden="true" tabindex="-1"></a>Original data set: car_prices.csv</span>
<span id="cb83-844"><a href="#cb83-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-847"><a href="#cb83-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-848"><a href="#cb83-848" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(df)</span>
<span id="cb83-849"><a href="#cb83-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-850"><a href="#cb83-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-851"><a href="#cb83-851" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix B:</span></span>
<span id="cb83-852"><a href="#cb83-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-853"><a href="#cb83-853" aria-hidden="true" tabindex="-1"></a>Canadian vehicle catalog</span>
<span id="cb83-854"><a href="#cb83-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-857"><a href="#cb83-857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-858"><a href="#cb83-858" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(ca_catalog)</span>
<span id="cb83-859"><a href="#cb83-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-860"><a href="#cb83-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-861"><a href="#cb83-861" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix C:</span></span>
<span id="cb83-862"><a href="#cb83-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-863"><a href="#cb83-863" aria-hidden="true" tabindex="-1"></a>First iteration of unmatched records labelled as *false_keys*</span>
<span id="cb83-864"><a href="#cb83-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-867"><a href="#cb83-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-868"><a href="#cb83-868" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(false_keys)</span>
<span id="cb83-869"><a href="#cb83-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-870"><a href="#cb83-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-871"><a href="#cb83-871" aria-hidden="true" tabindex="-1"></a>This dataset contains all the YMM keys from *carprices* that failed to map to the *us_catalog.*</span>
<span id="cb83-872"><a href="#cb83-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-873"><a href="#cb83-873" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix D:</span></span>
<span id="cb83-874"><a href="#cb83-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-875"><a href="#cb83-875" aria-hidden="true" tabindex="-1"></a>All records cleaned through NHTSA's *vindecodr* package lablled as *cleaned_keys*</span>
<span id="cb83-876"><a href="#cb83-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-879"><a href="#cb83-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-880"><a href="#cb83-880" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(cleaned_keys)</span>
<span id="cb83-881"><a href="#cb83-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-882"><a href="#cb83-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-883"><a href="#cb83-883" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix E:</span></span>
<span id="cb83-884"><a href="#cb83-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-885"><a href="#cb83-885" aria-hidden="true" tabindex="-1"></a>Remaining records from false_keys that failed to map after decoding VINs labelled as unmatched_keys.</span>
<span id="cb83-886"><a href="#cb83-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-889"><a href="#cb83-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-890"><a href="#cb83-890" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(unmatched_keys)</span>
<span id="cb83-891"><a href="#cb83-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-892"><a href="#cb83-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-893"><a href="#cb83-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-894"><a href="#cb83-894" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix F:</span></span>
<span id="cb83-895"><a href="#cb83-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-896"><a href="#cb83-896" aria-hidden="true" tabindex="-1"></a>Finalized and cleaned auction data *carprices.*</span>
<span id="cb83-897"><a href="#cb83-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-900"><a href="#cb83-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-901"><a href="#cb83-901" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(carprices)</span>
<span id="cb83-902"><a href="#cb83-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-903"><a href="#cb83-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-904"><a href="#cb83-904" aria-hidden="true" tabindex="-1"></a>More about the NHTSA's vindecodr package:</span>
<span id="cb83-905"><a href="#cb83-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-906"><a href="#cb83-906" aria-hidden="true" tabindex="-1"></a>Below is an example of the API call from the NHTSA's website: <span class="ot">&lt;https://vpic.nhtsa.dot.gov/api/Home/Index/LanguageExamples&gt;</span></span>
<span id="cb83-907"><a href="#cb83-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-908"><a href="#cb83-908" aria-hidden="true" tabindex="-1"></a><span class="in">    require(RJSONIO)</span></span>
<span id="cb83-909"><a href="#cb83-909" aria-hidden="true" tabindex="-1"></a><span class="in">    # User-defined functions ----------------------------------</span></span>
<span id="cb83-910"><a href="#cb83-910" aria-hidden="true" tabindex="-1"></a><span class="in">    VehicleAPIrConnect &lt;- function(VINin){</span></span>
<span id="cb83-911"><a href="#cb83-911" aria-hidden="true" tabindex="-1"></a><span class="in">        # Lookup VIN information from https://vpic.nhtsa.dot.gov/api</span></span>
<span id="cb83-912"><a href="#cb83-912" aria-hidden="true" tabindex="-1"></a><span class="in">        #</span></span>
<span id="cb83-913"><a href="#cb83-913" aria-hidden="true" tabindex="-1"></a><span class="in">        # Args:</span></span>
<span id="cb83-914"><a href="#cb83-914" aria-hidden="true" tabindex="-1"></a><span class="in">        #   VINin: VIN</span></span>
<span id="cb83-915"><a href="#cb83-915" aria-hidden="true" tabindex="-1"></a><span class="in">        #</span></span>
<span id="cb83-916"><a href="#cb83-916" aria-hidden="true" tabindex="-1"></a><span class="in">        # Returns:</span></span>
<span id="cb83-917"><a href="#cb83-917" aria-hidden="true" tabindex="-1"></a><span class="in">        #   Data frame with vehicle information.</span></span>
<span id="cb83-918"><a href="#cb83-918" aria-hidden="true" tabindex="-1"></a><span class="in">        #</span></span>
<span id="cb83-919"><a href="#cb83-919" aria-hidden="true" tabindex="-1"></a><span class="in">        # For Testing:</span></span>
<span id="cb83-920"><a href="#cb83-920" aria-hidden="true" tabindex="-1"></a><span class="in">        # VINin &lt;- "5UXWX7C5*BA"</span></span>
<span id="cb83-921"><a href="#cb83-921" aria-hidden="true" tabindex="-1"></a><span class="in">        tempCall &lt;- paste0("https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVinValues/", VINin, "?format=json")</span></span>
<span id="cb83-922"><a href="#cb83-922" aria-hidden="true" tabindex="-1"></a><span class="in">        tempExtract &lt;- fromJSON(tempCall)</span></span>
<span id="cb83-923"><a href="#cb83-923" aria-hidden="true" tabindex="-1"></a><span class="in">        dfOut &lt;- data.frame(t(unlist(tempExtract$Results)),stringsAsFactors=FALSE)</span></span>
<span id="cb83-924"><a href="#cb83-924" aria-hidden="true" tabindex="-1"></a><span class="in">        dfOut</span></span>
<span id="cb83-925"><a href="#cb83-925" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb83-926"><a href="#cb83-926" aria-hidden="true" tabindex="-1"></a><span class="in">    VehicleAPIrConnect("5UXWX7C5*BA")</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>