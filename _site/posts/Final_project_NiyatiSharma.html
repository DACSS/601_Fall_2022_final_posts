<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Niyati Sharma">
<meta name="dcterms.date" content="2022-12-21">

<title>DACSS 601: Data Science Fundamentals - FALL 2022 - Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta name="twitter:title" content="DACSS 601: Data Science Fundamentals - FALL 2022 - Final Project">
<meta name="twitter:description" content="Payroll data analytics is the process where we are using payroll data and implementing data analytics to it that allows organizations to understand economic trends and patterns so they can make…">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
    <span class="navbar-title">DACSS 601: Data Science Fundamentals - FALL 2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page">Fall 2022 Posts</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/601_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Final Project</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Final materials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://dacss.github.io/601_Fall_2022/" class="sidebar-item-text sidebar-link">Fall 2022 posts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">final Posts</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#reaserch-question" id="toc-reaserch-question" class="nav-link" data-scroll-target="#reaserch-question">Reaserch question</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data description</a></li>
  <li><a href="#step-1-reading-data-from-csv-file" id="toc-step-1-reading-data-from-csv-file" class="nav-link" data-scroll-target="#step-1-reading-data-from-csv-file">Step 1 : Reading data from csv file</a></li>
  <li><a href="#working-hours" id="toc-working-hours" class="nav-link" data-scroll-target="#working-hours">Working hours</a></li>
  <li><a href="#average-total-pay-for-every-fiscal-year-for-different-pay-basis" id="toc-average-total-pay-for-every-fiscal-year-for-different-pay-basis" class="nav-link" data-scroll-target="#average-total-pay-for-every-fiscal-year-for-different-pay-basis">Average total pay for every fiscal year for different pay basis</a></li>
  <li><a href="#average-working-hours-for-different-years" id="toc-average-working-hours-for-different-years" class="nav-link" data-scroll-target="#average-working-hours-for-different-years">Average working hours for different years :</a></li>
  <li><a href="#highest-the-lowest-paying-agencies" id="toc-highest-the-lowest-paying-agencies" class="nav-link" data-scroll-target="#highest-the-lowest-paying-agencies">Highest &amp; the Lowest Paying Agencies</a></li>
  <li><a href="#pay-by-annum" id="toc-pay-by-annum" class="nav-link" data-scroll-target="#pay-by-annum">Pay by Annum</a></li>
  <li><a href="#pay-by-day" id="toc-pay-by-day" class="nav-link" data-scroll-target="#pay-by-day">Pay by Day</a></li>
  <li><a href="#pay-by-hour" id="toc-pay-by-hour" class="nav-link" data-scroll-target="#pay-by-hour">pay by hour</a>
  <ul class="collapse">
  <li><a href="#jobs-title-that-pay-the-most-least-money-in-nyc" id="toc-jobs-title-that-pay-the-most-least-money-in-nyc" class="nav-link" data-scroll-target="#jobs-title-that-pay-the-most-least-money-in-nyc">Jobs Title that pay the Most &amp; Least money in NYC</a></li>
  </ul></li>
  <li><a href="#per-annum" id="toc-per-annum" class="nav-link" data-scroll-target="#per-annum">per annum</a></li>
  <li><a href="#per-day" id="toc-per-day" class="nav-link" data-scroll-target="#per-day">per day</a></li>
  <li><a href="#pay-by-hour-1" id="toc-pay-by-hour-1" class="nav-link" data-scroll-target="#pay-by-hour-1">pay by hour</a>
  <ul class="collapse">
  <li><a href="#average-pay-by-location" id="toc-average-pay-by-location" class="nav-link" data-scroll-target="#average-pay-by-location">Average pay by Location</a></li>
  <li><a href="#agency-name-which-has-highest-overtime-hours-and-over-time-salary" id="toc-agency-name-which-has-highest-overtime-hours-and-over-time-salary" class="nav-link" data-scroll-target="#agency-name-which-has-highest-overtime-hours-and-over-time-salary">Agency name which has highest overtime hours and over time salary :</a></li>
  <li><a href="#distribution-of-average-total-payment-based-on-new-york-counties-for-different-years" id="toc-distribution-of-average-total-payment-based-on-new-york-counties-for-different-years" class="nav-link" data-scroll-target="#distribution-of-average-total-payment-based-on-new-york-counties-for-different-years">Distribution of average total payment based on new york counties for different years</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions :</a></li>
  <li><a href="#further-thoughts" id="toc-further-thoughts" class="nav-link" data-scroll-target="#further-thoughts">Further thoughts :</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Final Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final project</div>
    <div class="quarto-category">Niyati Sharma</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Niyati Sharma </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 21, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gender)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># library(genderdata)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxlsb)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># load("Final_project_NiyatiSharma.RData")</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Payroll data analytics is the process where we are using payroll data and implementing data analytics to it that allows organizations to understand economic trends and patterns so they can make better decisions.It extends the capability of traditional payroll services by offering a different view into payroll information.It can also be used to eliminate errors and inefficiencies in payroll processes and to drive greater pay equality and fairness of compensation across companies.</p>
<p>For my research I collected data of NYC to visualize how the City’s budget is being spent on salary and overtime pay for all municipal employees. Data is input into the City’s Personnel Management System (“PMS”) by the respective user Agencies. Each record represents the following statistics for every city employee: Agency, Last Name, First Name, Middle Initial, Agency Start Date, Work Location Borough, Job Title Description, Leave Status as of the close of the FY (June 30th), Base Salary, Pay Basis, Regular Hours Paid, Regular Gross Paid, Overtime Hours worked, Total Overtime Paid,and Total Other Compensation (i.e.&nbsp;lump sum and/or retro payments). This data can be used to analyze how the City’s financial resources are allocated and how much of the City’s budget is being devoted to overtime. This data should be increments of salary increases received over the course of any one fiscal year will not be reflected. All that is captured, is the employee’s final base and gross salary at the end of the fiscal year.</p>
</section>
<section id="reaserch-question" class="level2">
<h2 class="anchored" data-anchor-id="reaserch-question">Reaserch question</h2>
<p>In this project I’m going to visualize the working hours, the hourly paid, total paid and how these dimensions change over different fiscal years in my final project. I will also find the following questions :</p>
<ol type="1">
<li>Pay over the years - Distribution Basis of Pay - Annual, Daily, Hourly</li>
<li>Highest &amp; the Lowest Paying Agencies - Annually, Daily &amp; Hourly Highest</li>
<li>The Lowest Paying Job Titles - Annually, Daily &amp; Hourly</li>
<li>Pay by Location Overtime Compensation</li>
</ol>
</section>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data description</h2>
<p>NYC Open Data website giving the public access to thousands of public datasets, which helps to learn about New York. https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e</p>
<p>Citywide Payroll Data (Fiscal Year) dataset is about salary and overtime payment of municipal employees. It aims to analyze how the city budgets have been used for payment. It could be also helpful for me to visualize the job market condition.</p>
<p>There are 2.36 million rows and 17 columns in the dataset. The dataset contains payroll records from 2019 through 2022,with the working location of New York City and other cities. It also includes the employees who are ceased as of June 30.</p>
<p>1.Fiscal Year : Financial year 2.Payroll Number : Unique number for every agency/employer 3.Agency Name : The Payroll agency that the employee works for<br>
4.Last Name : Last name of employee 5.First Name : First name of employee 6.Middle Initial : Middle initial of employee 7.Agency Start Date : Date which employee began working for their current agency 8.Work Location Borough : Borough of employee’s primary work location 9.Title Description : Civil service title description of the employee 10.Leave Status as of Jun 30 : Status of employee as of the close of the relevant fiscal year: Active, Ceased,or On Leave 11.Base Salary : Base Salary assigned to the employee 12.Pay Basis : Lists whether the employee is paid on an hourly, per diem or annual basis 13.Regular Hours : Number of regular hours employee worked in the fiscal year 14.Regular Gross : Paid The amount paid to the employee for base salary during the fiscal year 15.OT Hours : Overtime Hours worked by employee in the fiscal year 16.Total OT Paid : Total overtime pay paid to the employee in the fiscal year 17.Total Other Pay : Includes any compensation in addition to gross salary and overtime pay, ie Differentials, lump sums, uniform allowance,meal allowance, retroactive pay increases, settlement amounts, and bonus pay, if applicable.</p>
</section>
<section id="step-1-reading-data-from-csv-file" class="level2">
<h2 class="anchored" data-anchor-id="step-1-reading-data-from-csv-file">Step 1 : Reading data from csv file</h2>
<p>NOTE : I deleted unused columns from the dataset due to large size of datafile as I am not able to push the code on Git.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Citywide_Payroll_Data__Fiscal_Year_ 2019-22.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(NY_payroll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [1,048,575 × 12] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Fiscal Year          : num [1:1048575] 2019 2019 2019 2019 2019 ...
 $ Agency Name          : chr [1:1048575] "OFFICE OF THE MAYOR" "OFFICE OF THE MAYOR" "OFFICE OF THE MAYOR" "OFFICE OF THE MAYOR" ...
 $ Agency Start Date    : chr [1:1048575] "12/31/2017" "1/1/2014" "1/25/2016" "1/3/2017" ...
 $ Work Location Borough: chr [1:1048575] "MANHATTAN" "MANHATTAN" "MANHATTAN" "MANHATTAN" ...
 $ Title Description    : chr [1:1048575] "FIRST DEPUTY MAYOR" "MAYOR" "DEPUTY MAYOR" "DEPUTY MAYOR" ...
 $ Base Salary          : num [1:1048575] 282659 258750 244643 244643 244643 ...
 $ Pay Basis            : chr [1:1048575] "per Annum" "per Annum" "per Annum" "per Annum" ...
 $ Regular Hours        : num [1:1048575] 1825 1825 1825 1825 1825 ...
 $ Regular Gross Paid   : num [1:1048575] 278980 258041 246125 246036 241461 ...
 $ OT Hours             : num [1:1048575] 0 0 0 0 0 0 0 0 0 0 ...
 $ Total OT Paid        : num [1:1048575] 0 0 0 0 0 0 0 0 0 0 ...
 $ Total Other Pay      : num [1:1048575] 0 500 0 0 0 0 0 1000 0 1000 ...
 - attr(*, "spec")=
  .. cols(
  ..   `Fiscal Year` = col_double(),
  ..   `Agency Name` = col_character(),
  ..   `Agency Start Date` = col_character(),
  ..   `Work Location Borough` = col_character(),
  ..   `Title Description` = col_character(),
  ..   `Base Salary` = col_double(),
  ..   `Pay Basis` = col_character(),
  ..   `Regular Hours` = col_double(),
  ..   `Regular Gross Paid` = col_double(),
  ..   `OT Hours` = col_double(),
  ..   `Total OT Paid` = col_double(),
  ..   `Total Other Pay` = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>##Step 2: Data prepration</p>
<p>1.Convert character to lower case in the data for following columns (Agency Name,Last Name,First Name,Mid Init,Work Location Borough,Title Description,Leave Status as of June 30,Pay Basis) 2.Replace white spaces with underscore for column name 3.Convert Regular_Gross_Paid,Base_Salary,OT_Hours and Total_OT_Paid to numerical data 4.Calculate the start of employment Start_Date based on Agency_Start_Date 5.Create new column Total_pay which is addition of Total_OT_Paid + Regular_Gross_Paid 6.Remove duplicate rows</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tolower, whitespaces removal</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>NY_payroll[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>)]<span class="ot">&lt;-</span><span class="fu">map</span>(NY_payroll[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>)], tolower) <span class="co"># convert into lower case</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NY_payroll) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">names</span>(NY_payroll)) <span class="co"># remove spaces from column names</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to numeric</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>NY_payroll[<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(NY_payroll[<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">$"</span>,<span class="st">""</span>,x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `NY_payroll[c(11, 14, 16, 17)]`:
! Can't subset columns past the end.
ℹ Locations 14, 16, and 17 don't exist.
ℹ There are only 12 columns.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create Data columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span>  <span class="fu">add_column</span>(<span class="at">region =</span> <span class="st">"new york"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Start_Date<span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NY_payroll<span class="sc">$</span>Agency_Start_Date,<span class="at">format=</span><span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Start_Year<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(NY_payroll<span class="sc">$</span>Start_Date,<span class="st">'%Y'</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Total_Pay<span class="ot">&lt;-</span>NY_payroll<span class="sc">$</span>Total_OT_Paid <span class="sc">+</span> NY_payroll<span class="sc">$</span>Regular_Gross_Paid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in NY_payroll$Total_OT_Paid + NY_payroll$Regular_Gross_Paid: non-numeric argument to binary operator</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="ot">&lt;-</span>NY_payroll[<span class="sc">!</span><span class="fu">duplicated</span>(NY_payroll),]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NY_payroll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  Fiscal_Year Agency_N…¹ Agenc…² Work_…³ Title…⁴ Base_…⁵ Pay_B…⁶ Regul…⁷ Regul…⁸
        &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1        2019 OFFICE OF… 12/31/… manhat… first … 282659  per An… 1825    278980…
2        2019 OFFICE OF… 1/1/20… manhat… mayor   258750  per An… 1825    258041…
3        2019 OFFICE OF… 1/25/2… manhat… deputy… 244643  per An… 1825    246124…
4        2019 OFFICE OF… 1/3/20… manhat… deputy… 244643  per An… 1825    246035…
5        2019 OFFICE OF… 3/12/2… manhat… deputy… 244643  per An… 1825    241461…
6        2019 OFFICE OF… 1/1/20… manhat… chief … 236750  per An… 1825    238149…
# … with 6 more variables: OT_Hours &lt;chr&gt;, Total_OT_Paid &lt;dbl&gt;,
#   Total_Other_Pay &lt;chr&gt;, region &lt;chr&gt;, Start_Date &lt;date&gt;, Start_Year &lt;dbl&gt;,
#   and abbreviated variable names ¹​Agency_Name, ²​Agency_Start_Date,
#   ³​Work_Location_Borough, ⁴​Title_Description, ⁵​Base_Salary, ⁶​Pay_Basis,
#   ⁷​Regular_Hours, ⁸​Regular_Gross_Paid</code></pre>
</div>
</div>
<p>When looking at the salary’s change (Regular_Gross_Paid) over time (or based on another feature), the mean and median over a given group will be used. However, this distribution might be skewed because of some other categories.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> <span class="fu">select</span>(Pay_Basis,Regular_Hours,Regular_Gross_Paid,Total_Other_Pay) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   Pay_Basis Regular_Hours Regular_Gross_Paid Total_Other_Pay
   &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;              &lt;chr&gt;          
 1 per Annum 1825          278980.28          0              
 2 per Annum 1825          258041.16          500            
 3 per Annum 1825          246124.64          0              
 4 per Annum 1825          246035.81          0              
 5 per Annum 1825          241461.21          0              
 6 per Annum 1825          238149.78          0              
 7 per Annum 1825          237517.73          0              
 8 per Annum 1825          231522.96          1000           
 9 per Annum 1825          230755.36          0              
10 per Annum 1825          222490.58          1000           </code></pre>
</div>
</div>
<p>There are 4 types of Pay Basis :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Pay_Basis) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Pay_Basis        count
  &lt;chr&gt;            &lt;int&gt;
1 per Annum       620443
2 per Day         226495
3 per Hour        114760
4 Prorated Annual   4306</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Pay_Basis) <span class="sc">%&gt;%</span> <span class="co"># Variable to be transformed</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="st">`</span><span class="at">n</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">n</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(perc) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent</span>(perc)) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> perc, <span class="at">fill =</span> Pay_Basis)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Districution according to pay basis"</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"pay basis"</span>)) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the following bar plot, we see a distribution in terms of number of employee wrt to pay basis.</p>
<p>As we could see from the visualisation that, 59% employee is employed on per annum basis, 28% on per day basis and remaining on per day and prorated annual. Hence, we understand that 59% employee are permanent employees and remaining work as part time.</p>
<p>Also there are 2 types of salaries :</p>
<p>Base_Salary Regular_Gross_Paid</p>
<p>The difference between both is that Regular Gross Pay is the total amount of money you get before taxes or other deductions are subtracted from your salary, whereas Base.Salary is a fixed amount of money paid to an employee by an employer in return for work performed. Base salary does not include benefits, bonuses or any other potential compensation from an employer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Fiscal_Year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(NY_payroll<span class="sc">$</span>Fiscal_Year)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%0.5f"</span>, x)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NY_payroll, <span class="fu">aes</span>(<span class="at">x=</span>Total_Pay, <span class="at">group=</span>Fiscal_Year, <span class="at">fill=</span>Fiscal_Year)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_ipsum</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_density()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 1st layer.
Caused by error in `FUN()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
<p>As we know that total pay is sum of Regular Pay and Total overtime pay. Now, we want to see how the total pay is distributed wrt to no. Of years using a density plot.</p>
<p>From the density plot, we observe that total pay is distributed from 0 to 200000, where the maximum or most frequent payment resides in first 12.5% of the data. The density plot looks right skewed. We see similar behaviour for all four years.</p>
</section>
<section id="working-hours" class="level2">
<h2 class="anchored" data-anchor-id="working-hours">Working hours</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Regular_Hours_categories <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">as.numeric</span>(NY_payroll<span class="sc">$</span>Regular_Hours), <span class="fu">c</span>(<span class="fu">min</span>(NY_payroll<span class="sc">$</span>Regular_Hours),<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>,<span class="dv">2500</span>,<span class="fu">max</span>(NY_payroll<span class="sc">$</span>Regular_Hours)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#NY_payroll$Regular_Hours_categories &lt;- as.factor(NY_payroll$Regular_Hours)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NY_payroll, <span class="fu">aes</span>(<span class="at">x=</span>Regular_Hours_categories, <span class="at">fill=</span>Regular_Hours_categories)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label=</span>..count..), <span class="at">vjust=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We already saw distribution plot and bar plot for the Total Pay and Pay Basis distribution. Now, if we want to see how many employee distributed across different pay ranges, we can use countplot function or frequency plot. The pay ranges are divided into 7 categories- (minm,0), (0,500), (500,1000), (1000,1500), (1500,2000), (2000,2500), (2500, maxm). We could see from following plot that maximum employees lies in (minm,0) amount. We see similar behavior in density plot where we asserted that maximum employees lies between 0 to 12.5% of total pay.</p>
</section>
<section id="average-total-pay-for-every-fiscal-year-for-different-pay-basis" class="level2">
<h2 class="anchored" data-anchor-id="average-total-pay-for-every-fiscal-year-for-different-pay-basis">Average total pay for every fiscal year for different pay basis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `mean_total_pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(mean_total_pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Total Pay"</span>, <span class="at">title =</span> <span class="st">"Average Total Pay Vs Year (per annum basis)"</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplot(dat1, aes(y = as.numeric(mean_total_pay), x = as.factor(Fiscal_Year), : object 'dat1' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_line()`:
! Problem while setting up geom.
ℹ Error occurred in the 3rd layer.
Caused by error in `compute_geom_1()`:
! `geom_line()` requires the following missing aesthetics: y</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span> <span class="sc">|</span> Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `mean_total_pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(mean_total_pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Total Pay"</span>, <span class="at">title =</span> <span class="st">"Average Total Pay Vs Year (per day &amp; per hour basis)"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplot(dat1, aes(y = as.numeric(mean_total_pay), x = as.factor(Fiscal_Year), : object 'dat1' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_line()`:
! Problem while setting up geom.
ℹ Error occurred in the 3rd layer.
Caused by error in `compute_geom_1()`:
! `geom_line()` requires the following missing aesthetics: y</code></pre>
</div>
</div>
<p>From the dataset, we could see that we have two different types of pay basis - permanent work pay and temporary work pay. For this, we can find average total pay vs year plot for different pay basis. We can see from the above two plots that Average Total Pay was maximum on 2019 for ‘per annum’ basis and for ‘per day &amp; per hour’ basis on 2022. Similarly, we see that Average Total Pay was minimum on 2020 for ‘per annum’ basis and for ‘per day &amp; per hour’ basis on 2021. This information could useful if we want to find more information on pay average per year for different types of job.</p>
</section>
<section id="average-working-hours-for-different-years" class="level2">
<h2 class="anchored" data-anchor-id="average-working-hours-for-different-years">Average working hours for different years :</h2>
<p>If we want to see how average working hours for different years looks like, we could use a scatter plot to deduce a relationship between average working hours and fiscal year. From below plot, we could see that, the average working hour increased from 2019 to 2020 and then remain constant for 2021. However, it declined during 2022. There could be multiple unwarranted reasons for this trend which could be deduced from the given plot.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Regular_Hours =</span> <span class="fu">mean</span>(Regular_Hours))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Regular_Hours), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Regular Hours"</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanPaid =</span> <span class="fu">mean</span>(Regular_Gross_Paid),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanBaseSalary =</span> <span class="fu">mean</span>(Base_Salary),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPaid =</span> <span class="fu">median</span>(Regular_Gross_Paid),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianBaseSalary =</span> <span class="fu">median</span>(Base_Salary)) <span class="sc">%&gt;%</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">'Fiscal_Year'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(Fiscal_Year),<span class="at">y=</span>value,<span class="at">group=</span>variable)) <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>variable),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">""</span>,<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"darkred"</span>,<span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Mean, Median of Regular Gross Paid and Base Salary($US) per annum over years'</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanPaid =</span> <span class="fu">mean</span>(Regular_Gross_Paid),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanBaseSalary =</span> <span class="fu">mean</span>(Base_Salary),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPaid =</span> <span class="fu">median</span>(Regular_Gross_Paid),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianBaseSalary =</span> <span class="fu">median</span>(Base_Salary)) <span class="sc">%&gt;%</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">'Fiscal_Year'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(Fiscal_Year),<span class="at">y=</span>value,<span class="at">group=</span>variable)) <span class="sc">+</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>variable),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">""</span>,<span class="at">values =</span>  <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"blue"</span>,<span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Mean, Median of Regular Gross Paid and Base Salary($US) per day over years'</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To see the statistical analysis of our salary data we could see the mean and median distribution. We know from statistics that if the mean is greater than median than we have right skewed that else we have a left skewed data in vice versa. From the below plot we see, that for all years, the mean is higher than the median suggesting the distribution is right skewed. Now, if we see our distribution plot, we mentioned that the distribution is right skewed. Hence, we explain the distribution plot using statistics.</p>
<p>Now, if we see the trend for the different years from 2019-2022. The mean is increasing from 2019 to 2022 suggesting that the salary of the employee has been increased. However, if we see the median which first decreased for year 2020 and then increased for 2021 and finally decreased for 2022, suggesting that salary increment is not consistent over the years. Now, comparing both mean and median together we could assert that for year 2020, the salary is increased only for few population on the higher end of the distribution, leading to lower median and higher mean. Now for year 2021, the result suggests that salary has been increased for more larger population as compared to previous year, concluding increase in median along with mean.We see that the median is greater than mean for 2021 suggested that data is left skewed. Finally for year 2022, again we see the similar trend as 2020, that salary has been increased but only for few population leading to lesser median and higher mean.</p>
<p>For the <code>per hour</code> median and mean of Regular Gross Pay and Base Salary, the gross pay is the highest in the mean and larger than the median suggesting that there is non-uniformity in the data. Few employees have high hourly pay (possible outliers) causing the difference with median gross pay. The base salary suggests that its not applicable to 50% of the employees as median is tending towards zero and mean pay pretty large than median suggesting few population have large hourly base salary causing higher base salary.</p>
</section>
<section id="highest-the-lowest-paying-agencies" class="level2">
<h2 class="anchored" data-anchor-id="highest-the-lowest-paying-agencies">Highest &amp; the Lowest Paying Agencies</h2>
</section>
<section id="pay-by-annum" class="level1">
<h1>Pay by Annum</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, Mean_Total_Pay)): object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, desc(Mean_Total_Pay))): object 'newdata' not found</code></pre>
</div>
</div>
<p>Suppose, if want to see how the total pay is distributed across different agencies for <code>per annum</code> basis. We could use following plot. Now, from the result we see that, maximum total pay is for Agency “Queens community board #14” and minimum total pay is for Agency “Queens community board #8”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower. This information can help us to understand about a popularity of the agency or other analysis.</p>
</section>
<section id="pay-by-day" class="level1">
<h1>Pay by Day</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, Mean_Total_Pay)): object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, desc(Mean_Total_Pay))): object 'newdata' not found</code></pre>
</div>
</div>
<p>Now, if want to see how the total pay is distributed across different agencies for <code>per day</code> basis. We could use above plot. Now, from the result we see that, maximum total pay is for Agency “Dept of citywide admin svcs” and minimum total pay is for Agency “Department of juvenile justice”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower.</p>
</section>
<section id="pay-by-hour" class="level1">
<h1>pay by hour</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, Mean_Total_Pay)): object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Agency_Name = fct_reorder(Agency_Name, desc(Mean_Total_Pay))): object 'newdata' not found</code></pre>
</div>
</div>
<p>Now, if want to see how the total pay is distributed across different agencies for <code>per hour</code> basis. We could use above plot. Now, from the result we see that, maximum total pay is for Agency “Civil services commission” and minimum total pay is for Agency “Bronx community board #10”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower.</p>
<section id="jobs-title-that-pay-the-most-least-money-in-nyc" class="level2">
<h2 class="anchored" data-anchor-id="jobs-title-that-pay-the-most-least-money-in-nyc">Jobs Title that pay the Most &amp; Least money in NYC</h2>
<p>Now, we do same analysis for ‘Job Title’ which we did in the previous section. We want to find which job title has maximum or minimum average total pay for different pay basis. We used bar plot for descending or ascending average total pay for our analysis.</p>
</section>
</section>
<section id="per-annum" class="level1">
<h1>per annum</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
</section>
<section id="per-day" class="level1">
<h1>per day</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
</section>
<section id="pay-by-hour-1" class="level1">
<h1>pay by hour</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = FALSE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarise()`:
! Problem while computing `Mean_Total_Pay = mean(Total_Pay)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in order(dat1$Mean_Total_Pay, decreasing = TRUE): argument 1 is not a vector</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'newdata' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in mutate(., Title_Description = fct_reorder(Title_Description, : object 'newdata' not found</code></pre>
</div>
</div>
<section id="average-pay-by-location" class="level2">
<h2 class="anchored" data-anchor-id="average-pay-by-location">Average pay by Location</h2>
<p>Work Location Borough tells us the area that a particular agency in NYC belongs to so it is interesting to know which one of these areas have the highest pay!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using number of observation per group</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Work_Location_Borough, <span class="at">y =</span> Total_Pay)) <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="co"># Boxplot with error bars </span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">'green'</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="co"># Colors</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">outlier.colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Total Pay"</span>, <span class="at">labels =</span> func) <span class="sc">+</span>  <span class="co"># Continuous variable label</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Work Location Borough"</span>) <span class="sc">+</span>      <span class="co"># Group label</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="st">"Boxplot by Work Location Borough"</span>) <span class="sc">+</span> <span class="co"># Plot title</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="co"># Theme customization</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="fl">0.25</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span> ))</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `stat_boxplot()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 1st layer.
Caused by error in `FUN()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
<p>In order to find out the total pay distribution wrt location, we could use box plot distribution for Total Pay VS Location plot. Now, if we the box plot, then for most of the locations we see there are outliers in the data suggesting that total pay have extreme values I.e few employees have relevantly more total pay than remaining. Moreover, if we compare among different locations, then we could see that Washington have higher median than others suggesting that we have more uniformity in the total pay as compared to other locations. However, if we want to find out which location has higher pay than we see that Manhattan has higher pay as compared to because of outliers. Also, if we see that most of the box plot are either right or left skewed with outliers suggesting non uniformity in the total pay distribution. However, for few cities like Ulster, Westchester, Duchess etc looks to have normal distribution suggesting uniform pay distribution. Therefore, we can comment on the uniformity of pay distribution or average pay distribution or city with higher or lower pay distribution using box plot.</p>
</section>
<section id="agency-name-which-has-highest-overtime-hours-and-over-time-salary" class="level2">
<h2 class="anchored" data-anchor-id="agency-name-which-has-highest-overtime-hours-and-over-time-salary">Agency name which has highest overtime hours and over time salary :</h2>
<p>When we deal with payroll data, our one of the primary point of interest is <code>overtime</code> payment. Therefore, we want to deduce a relationship between ‘Agency Name’ and ‘overtime’ hours or payment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_OT_Hours =</span> <span class="fu">mean</span>(OT_Hours))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_OT_Hours, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_OT_Hours)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_OT_Hours), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name)) <span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">size=</span>.<span class="dv">3</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph, we see that the ‘fire department’ has the most overtime working hours followed by ‘board of election’ than ‘department of correction’ as top 3 agencies with overtime working hours.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_OT_paid =</span> <span class="fu">mean</span>(Total_OT_Paid))</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_OT_paid, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_OT_paid))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_OT_paid), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name)) <span class="sc">+</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_project_NiyatiSharma_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above plot, average overtime payment is displayed against different agencies. We have sorted our data in descending order to capture the maximum overtime payment. We see that ‘fire department’ followed by ‘department of sanitation’ than ‘department of correction’.</p>
</section>
<section id="distribution-of-average-total-payment-based-on-new-york-counties-for-different-years" class="level2">
<h2 class="anchored" data-anchor-id="distribution-of-average-total-payment-based-on-new-york-counties-for-different-years">Distribution of average total payment based on new york counties for different years</h2>
<p>Finally, we could use ‘New York’ map to show the distribution of average total pay across all counties. We used theme_map() for ‘new york’ state and used light shade to display lower total pay and darker shade for higher total pay for all fiscal years. This map plot gives visual idea of maximum and minimum average pay for a location which more descriptive on comparison to bar that could be used in place of bar plot for same relationship.</p>
<p>We see that the same county has darker shade and light shade across all fiscal years. Thus, suggesting that these are high paying areas with better jobs. However, we might need more evidence to corroborate our statement.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2019</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"orange"</span>, </span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"darkred"</span>,</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2019"</span>)) <span class="sc">+</span> </span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `dplyr::summarise()`:
! Problem while computing `mean_total_pay = mean(Total_Pay, na.rm =
  TRUE)`.
ℹ The error occurred in group 1: region = "new york", subregion = "albany".
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2020</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"blue"</span>, </span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"darkred"</span>,</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2020"</span>)) <span class="sc">+</span> </span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarize()`:
! Problem while computing `mean_total_pay = mean(Total_Pay, na.rm =
  TRUE)`.
ℹ The error occurred in group 1: region = "new york", subregion = "albany".
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2021</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"green"</span>, </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2021"</span>)) <span class="sc">+</span> </span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarize()`:
! Problem while computing `mean_total_pay = mean(Total_Pay, na.rm =
  TRUE)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2022</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"pink"</span>, </span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"purple"</span>,</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2022"</span>)) <span class="sc">+</span> </span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `summarize()`:
! Problem while computing `mean_total_pay = mean(Total_Pay, na.rm =
  TRUE)`.
Caused by error in `mean()`:
! object 'Total_Pay' not found</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions :</h2>
<p>Throughout this project, we used different visualizations techniques using ggplot library to demonstrate the different data behaviors. We used ‘NYC Payroll’ dataset from which we explained overall pay distribution across different agencies, regions and pay basis types. We used pie chart, bar plot, box plot, distribution curve, line plot, theme map etc, for our overall data analysis. The choice of plot was picked based on the nature of the data and the analysis we wanted to deduce.</p>
<p>From the above analysis, we saw how the working hours, per basis type, total payment and average total pay varies with fiscal year or agencies type. We also saw statistical analysis using mean and median of salaries wrt fiscal year to see the trend on the increment of total pay over the years. Furthermore, we saw the agency which pays most and least overtime salary and the agency which have maximum overtime hours. These are important aspects when we see payment data. Lastly, we used ‘New York’ state map to display the Total Payment distribution across different counties. Therefore, we explained how using different data visualizations we can explain the data and its behavior.</p>
</section>
<section id="further-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="further-thoughts">Further thoughts :</h2>
<p>In this project, I added all possible visualizations which could be interpreted from the dataset. The data contains information about NYC payroll. Hence, columns like total pay, gross pay, special allowance, counties, job types, job title, payment basis, overtime hours etc. create meaningful significance. I tried to use different plots which I felt explains the data property more closely than any other plot. The map plot where I showed the distribution between average total pay and counites could be improved. We could add more information like county name and data set could include all county information for diverse results. Overall I feel that I explained the dataset with loads of data visualisation tools to explain the trend, behavior and relationship between two or multiple variables.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e</li>
<li>https://studentwork.prattsi.org/infovis/projects/visualizing-the-citywide-payroll/</li>
<li>https://www.kaggle.com/code/jonathanbouchet/nyc-payroll-data/report</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#save.image("Final_project_NiyatiSharma.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Fall_2022" data-repo-id="R_kgDOH564Gw" data-category="Announcements" data-category-id="DIC_kwDOH564G84CRdBB" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb142" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project"</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Niyati Sharma"</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Visualizing the NYC Payroll"</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/21/2022"</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - final project</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Niyati Sharma</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gender)</span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("remotes")</span></span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="co"># library(genderdata)</span></span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxlsb)</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a><span class="co"># load("Final_project_NiyatiSharma.RData")</span></span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a>Payroll data analytics is the process where we are using payroll data and implementing data analytics to it that allows organizations to understand economic trends and patterns so they can make better decisions.It extends the capability of traditional payroll services by offering a different view into payroll information.It can also be used to eliminate errors and inefficiencies in payroll processes and to drive greater pay equality and fairness of compensation across companies.</span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a>For my research I collected data of NYC to visualize how the City's budget is being spent on salary and overtime pay for all municipal employees. Data is input into the City's Personnel Management System ("PMS") by the respective user Agencies. Each record represents the following statistics for every city employee: Agency, Last Name, First Name, Middle Initial, Agency Start Date, Work Location Borough, Job Title Description, Leave Status as of the close of the FY (June 30th), Base Salary, Pay Basis, Regular Hours Paid, Regular Gross Paid, Overtime Hours worked, Total Overtime Paid,and Total Other Compensation (i.e. lump sum and/or retro payments). This data can be used to analyze how the City's financial resources are allocated and how much of the City's budget is being devoted to overtime. This data should be increments of salary increases received over the course of any one fiscal year will not be reflected. All that is captured, is the employee's final base and gross salary at the end of the fiscal year.</span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reaserch question</span></span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a>In this project I’m going to visualize the working hours, the hourly paid, total paid and how these dimensions change over different fiscal years in my final project. I will also find the following questions : </span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Pay over the years - Distribution Basis of Pay - Annual, Daily, Hourly</span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Highest &amp; the Lowest Paying Agencies - Annually, Daily &amp; Hourly Highest</span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The Lowest Paying Job Titles - Annually, Daily &amp; Hourly </span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Pay by Location Overtime Compensation</span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data description</span></span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a>NYC Open Data website giving the public access to thousands of public datasets, which helps to learn about New York.</span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a>https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e</span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-67"><a href="#cb142-67" aria-hidden="true" tabindex="-1"></a>Citywide Payroll Data (Fiscal Year) dataset is about salary and overtime payment of municipal employees. It aims to analyze how the city budgets have been used for payment. It could be also helpful for me to visualize the job market condition. </span>
<span id="cb142-68"><a href="#cb142-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-69"><a href="#cb142-69" aria-hidden="true" tabindex="-1"></a>There are 2.36 million rows and 17 columns in the dataset. The dataset contains payroll records from 2019 through 2022,with the working location of New York City and other cities. It also includes the employees who are ceased as of June 30. </span>
<span id="cb142-70"><a href="#cb142-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-71"><a href="#cb142-71" aria-hidden="true" tabindex="-1"></a>1.Fiscal Year : Financial year</span>
<span id="cb142-72"><a href="#cb142-72" aria-hidden="true" tabindex="-1"></a>2.Payroll Number : Unique number for every agency/employer</span>
<span id="cb142-73"><a href="#cb142-73" aria-hidden="true" tabindex="-1"></a>3.Agency Name : The Payroll agency that the employee works for   </span>
<span id="cb142-74"><a href="#cb142-74" aria-hidden="true" tabindex="-1"></a>4.Last Name : Last name of employee </span>
<span id="cb142-75"><a href="#cb142-75" aria-hidden="true" tabindex="-1"></a>5.First Name : First name of employee </span>
<span id="cb142-76"><a href="#cb142-76" aria-hidden="true" tabindex="-1"></a>6.Middle Initial : Middle initial of employee </span>
<span id="cb142-77"><a href="#cb142-77" aria-hidden="true" tabindex="-1"></a>7.Agency Start Date : Date which employee began working for their current agency </span>
<span id="cb142-78"><a href="#cb142-78" aria-hidden="true" tabindex="-1"></a>8.Work Location Borough : Borough of employee's primary work location </span>
<span id="cb142-79"><a href="#cb142-79" aria-hidden="true" tabindex="-1"></a>9.Title Description : Civil service title description of the employee </span>
<span id="cb142-80"><a href="#cb142-80" aria-hidden="true" tabindex="-1"></a>10.Leave Status as of Jun 30 : Status of employee as of the close of the relevant fiscal year: Active, Ceased,or On Leave </span>
<span id="cb142-81"><a href="#cb142-81" aria-hidden="true" tabindex="-1"></a>11.Base Salary : Base Salary assigned to the employee </span>
<span id="cb142-82"><a href="#cb142-82" aria-hidden="true" tabindex="-1"></a>12.Pay Basis : Lists whether the employee is paid on an hourly, per diem or annual basis </span>
<span id="cb142-83"><a href="#cb142-83" aria-hidden="true" tabindex="-1"></a>13.Regular Hours : Number of regular hours employee worked in the fiscal year </span>
<span id="cb142-84"><a href="#cb142-84" aria-hidden="true" tabindex="-1"></a>14.Regular Gross : Paid The amount paid to the employee for base salary during the fiscal year</span>
<span id="cb142-85"><a href="#cb142-85" aria-hidden="true" tabindex="-1"></a>15.OT Hours : Overtime Hours worked by employee in the fiscal year</span>
<span id="cb142-86"><a href="#cb142-86" aria-hidden="true" tabindex="-1"></a>16.Total OT Paid : Total overtime pay paid to the employee in the fiscal year </span>
<span id="cb142-87"><a href="#cb142-87" aria-hidden="true" tabindex="-1"></a>17.Total Other Pay : Includes any compensation in addition to gross salary and overtime pay, ie Differentials, lump sums, uniform allowance,meal allowance, retroactive pay increases, settlement amounts, and bonus pay, if applicable.</span>
<span id="cb142-88"><a href="#cb142-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-89"><a href="#cb142-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-90"><a href="#cb142-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1 : Reading data from csv file</span></span>
<span id="cb142-91"><a href="#cb142-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-92"><a href="#cb142-92" aria-hidden="true" tabindex="-1"></a>NOTE : I deleted unused columns from the dataset due to large size of datafile as I am not able to push the code on Git. </span>
<span id="cb142-95"><a href="#cb142-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-96"><a href="#cb142-96" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Citywide_Payroll_Data__Fiscal_Year_ 2019-22.csv"</span>)</span>
<span id="cb142-97"><a href="#cb142-97" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(NY_payroll)</span>
<span id="cb142-98"><a href="#cb142-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-99"><a href="#cb142-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-100"><a href="#cb142-100" aria-hidden="true" tabindex="-1"></a>##Step 2:  Data prepration</span>
<span id="cb142-101"><a href="#cb142-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-102"><a href="#cb142-102" aria-hidden="true" tabindex="-1"></a>1.Convert character to lower case in the data for following columns (Agency Name,Last Name,First Name,Mid Init,Work Location Borough,Title Description,Leave Status as of June 30,Pay Basis)</span>
<span id="cb142-103"><a href="#cb142-103" aria-hidden="true" tabindex="-1"></a>2.Replace white spaces with underscore for column name </span>
<span id="cb142-104"><a href="#cb142-104" aria-hidden="true" tabindex="-1"></a>3.Convert Regular_Gross_Paid,Base_Salary,OT_Hours and Total_OT_Paid to numerical data </span>
<span id="cb142-105"><a href="#cb142-105" aria-hidden="true" tabindex="-1"></a>4.Calculate the start of employment Start_Date based on Agency_Start_Date </span>
<span id="cb142-106"><a href="#cb142-106" aria-hidden="true" tabindex="-1"></a>5.Create new column Total_pay which is addition of Total_OT_Paid + Regular_Gross_Paid </span>
<span id="cb142-107"><a href="#cb142-107" aria-hidden="true" tabindex="-1"></a>6.Remove duplicate rows</span>
<span id="cb142-108"><a href="#cb142-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-111"><a href="#cb142-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-112"><a href="#cb142-112" aria-hidden="true" tabindex="-1"></a><span class="co">#tolower, whitespaces removal</span></span>
<span id="cb142-113"><a href="#cb142-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-114"><a href="#cb142-114" aria-hidden="true" tabindex="-1"></a>NY_payroll[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>)]<span class="ot">&lt;-</span><span class="fu">map</span>(NY_payroll[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>)], tolower) <span class="co"># convert into lower case</span></span>
<span id="cb142-115"><a href="#cb142-115" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NY_payroll) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">names</span>(NY_payroll)) <span class="co"># remove spaces from column names</span></span>
<span id="cb142-116"><a href="#cb142-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-117"><a href="#cb142-117" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to numeric</span></span>
<span id="cb142-118"><a href="#cb142-118" aria-hidden="true" tabindex="-1"></a>NY_payroll[<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(NY_payroll[<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">$"</span>,<span class="st">""</span>,x)))</span>
<span id="cb142-119"><a href="#cb142-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-120"><a href="#cb142-120" aria-hidden="true" tabindex="-1"></a><span class="co">#create Data columns</span></span>
<span id="cb142-121"><a href="#cb142-121" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span>  <span class="fu">add_column</span>(<span class="at">region =</span> <span class="st">"new york"</span>)</span>
<span id="cb142-122"><a href="#cb142-122" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Start_Date<span class="ot">&lt;-</span> <span class="fu">as.Date</span>(NY_payroll<span class="sc">$</span>Agency_Start_Date,<span class="at">format=</span><span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb142-123"><a href="#cb142-123" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Start_Year<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(NY_payroll<span class="sc">$</span>Start_Date,<span class="st">'%Y'</span>))</span>
<span id="cb142-124"><a href="#cb142-124" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Total_Pay<span class="ot">&lt;-</span>NY_payroll<span class="sc">$</span>Total_OT_Paid <span class="sc">+</span> NY_payroll<span class="sc">$</span>Regular_Gross_Paid</span>
<span id="cb142-125"><a href="#cb142-125" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="ot">&lt;-</span>NY_payroll[<span class="sc">!</span><span class="fu">duplicated</span>(NY_payroll),]</span>
<span id="cb142-126"><a href="#cb142-126" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NY_payroll)</span>
<span id="cb142-127"><a href="#cb142-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-128"><a href="#cb142-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-129"><a href="#cb142-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-130"><a href="#cb142-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-131"><a href="#cb142-131" aria-hidden="true" tabindex="-1"></a>When looking at the salary's change (Regular_Gross_Paid) over time (or based on another feature), the mean and median over a given group will be used. However, this distribution might be skewed because of some other categories.</span>
<span id="cb142-132"><a href="#cb142-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-133"><a href="#cb142-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-136"><a href="#cb142-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-137"><a href="#cb142-137" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> <span class="fu">select</span>(Pay_Basis,Regular_Hours,Regular_Gross_Paid,Total_Other_Pay) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb142-138"><a href="#cb142-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-139"><a href="#cb142-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-140"><a href="#cb142-140" aria-hidden="true" tabindex="-1"></a>There are 4 types of Pay Basis :</span>
<span id="cb142-141"><a href="#cb142-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-144"><a href="#cb142-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-145"><a href="#cb142-145" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Pay_Basis) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>())</span>
<span id="cb142-146"><a href="#cb142-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-147"><a href="#cb142-147" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span> </span>
<span id="cb142-148"><a href="#cb142-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Pay_Basis) <span class="sc">%&gt;%</span> <span class="co"># Variable to be transformed</span></span>
<span id="cb142-149"><a href="#cb142-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb142-150"><a href="#cb142-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb142-151"><a href="#cb142-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="st">`</span><span class="at">n</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">n</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-152"><a href="#cb142-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(perc) <span class="sc">%&gt;%</span></span>
<span id="cb142-153"><a href="#cb142-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent</span>(perc)) <span class="sc">%&gt;%</span></span>
<span id="cb142-154"><a href="#cb142-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> perc, <span class="at">fill =</span> Pay_Basis)) <span class="sc">+</span></span>
<span id="cb142-155"><a href="#cb142-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Districution according to pay basis"</span>) <span class="sc">+</span></span>
<span id="cb142-156"><a href="#cb142-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb142-157"><a href="#cb142-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb142-158"><a href="#cb142-158" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb142-159"><a href="#cb142-159" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb142-160"><a href="#cb142-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"pay basis"</span>)) <span class="sc">+</span></span>
<span id="cb142-161"><a href="#cb142-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb142-162"><a href="#cb142-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb142-163"><a href="#cb142-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb142-164"><a href="#cb142-164" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb142-165"><a href="#cb142-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-166"><a href="#cb142-166" aria-hidden="true" tabindex="-1"></a>From the following bar plot, we see a distribution in terms of number of employee wrt to pay basis. </span>
<span id="cb142-167"><a href="#cb142-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-168"><a href="#cb142-168" aria-hidden="true" tabindex="-1"></a>As we could see from the visualisation that, 59% employee is employed on per annum basis, 28% on per day basis and remaining on per day and prorated annual. Hence, we understand that 59% employee are permanent employees and remaining work as part time.</span>
<span id="cb142-169"><a href="#cb142-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-170"><a href="#cb142-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-171"><a href="#cb142-171" aria-hidden="true" tabindex="-1"></a>Also there are 2 types of salaries :</span>
<span id="cb142-172"><a href="#cb142-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-173"><a href="#cb142-173" aria-hidden="true" tabindex="-1"></a>Base_Salary Regular_Gross_Paid</span>
<span id="cb142-174"><a href="#cb142-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-175"><a href="#cb142-175" aria-hidden="true" tabindex="-1"></a>The difference between both is that Regular Gross Pay is the total amount of money you get before taxes or other deductions are subtracted from your salary, whereas Base.Salary is a fixed amount of money paid to an employee by an employer in return for work performed. Base salary does not include benefits, bonuses or any other potential compensation from an employer.</span>
<span id="cb142-176"><a href="#cb142-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-177"><a href="#cb142-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-178"><a href="#cb142-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-179"><a href="#cb142-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 10}</span></span>
<span id="cb142-180"><a href="#cb142-180" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Fiscal_Year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(NY_payroll<span class="sc">$</span>Fiscal_Year)</span>
<span id="cb142-181"><a href="#cb142-181" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%0.5f"</span>, x)</span>
<span id="cb142-182"><a href="#cb142-182" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NY_payroll, <span class="fu">aes</span>(<span class="at">x=</span>Total_Pay, <span class="at">group=</span>Fiscal_Year, <span class="at">fill=</span>Fiscal_Year)) <span class="sc">+</span></span>
<span id="cb142-183"><a href="#cb142-183" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb142-184"><a href="#cb142-184" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_ipsum</span>()</span>
<span id="cb142-185"><a href="#cb142-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-186"><a href="#cb142-186" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> func)</span>
<span id="cb142-187"><a href="#cb142-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-188"><a href="#cb142-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-189"><a href="#cb142-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-190"><a href="#cb142-190" aria-hidden="true" tabindex="-1"></a>As we know that total pay is sum of Regular Pay and Total overtime pay. Now, we want to see how the total pay is distributed wrt to no. Of years using a density plot. </span>
<span id="cb142-191"><a href="#cb142-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-192"><a href="#cb142-192" aria-hidden="true" tabindex="-1"></a>From the density plot, we observe that total pay is distributed from 0 to 200000, where the maximum or most frequent payment resides in first 12.5% of the data. The density plot looks right skewed. We see similar behaviour for all four years.</span>
<span id="cb142-193"><a href="#cb142-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-194"><a href="#cb142-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working hours</span></span>
<span id="cb142-195"><a href="#cb142-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-196"><a href="#cb142-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.height=7}</span></span>
<span id="cb142-197"><a href="#cb142-197" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-198"><a href="#cb142-198" aria-hidden="true" tabindex="-1"></a>NY_payroll<span class="sc">$</span>Regular_Hours_categories <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">as.numeric</span>(NY_payroll<span class="sc">$</span>Regular_Hours), <span class="fu">c</span>(<span class="fu">min</span>(NY_payroll<span class="sc">$</span>Regular_Hours),<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">1500</span>,<span class="dv">2000</span>,<span class="dv">2500</span>,<span class="fu">max</span>(NY_payroll<span class="sc">$</span>Regular_Hours)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb142-199"><a href="#cb142-199" aria-hidden="true" tabindex="-1"></a><span class="co">#NY_payroll$Regular_Hours_categories &lt;- as.factor(NY_payroll$Regular_Hours)</span></span>
<span id="cb142-200"><a href="#cb142-200" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NY_payroll, <span class="fu">aes</span>(<span class="at">x=</span>Regular_Hours_categories, <span class="at">fill=</span>Regular_Hours_categories)) <span class="sc">+</span></span>
<span id="cb142-201"><a href="#cb142-201" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb142-202"><a href="#cb142-202" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">stat=</span><span class="st">'count'</span>, <span class="fu">aes</span>(<span class="at">label=</span>..count..), <span class="at">vjust=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb142-203"><a href="#cb142-203" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">17</span>))</span>
<span id="cb142-204"><a href="#cb142-204" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb142-205"><a href="#cb142-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-206"><a href="#cb142-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-207"><a href="#cb142-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-208"><a href="#cb142-208" aria-hidden="true" tabindex="-1"></a>We already saw distribution plot and bar plot for the Total Pay and Pay Basis distribution. Now, if we want to see how many employee distributed across different pay ranges, we can use countplot function or frequency plot. The pay ranges are divided into 7 categories- (minm,0), (0,500), (500,1000), (1000,1500), (1500,2000), (2000,2500), (2500, maxm). We could see from following plot that maximum employees lies in (minm,0) amount. We see similar behavior in density plot where we asserted that maximum employees lies between 0 to 12.5% of total pay.</span>
<span id="cb142-209"><a href="#cb142-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-210"><a href="#cb142-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-211"><a href="#cb142-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average total pay for every fiscal year for different pay basis</span></span>
<span id="cb142-212"><a href="#cb142-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-213"><a href="#cb142-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-216"><a href="#cb142-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-217"><a href="#cb142-217" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-218"><a href="#cb142-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-219"><a href="#cb142-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-220"><a href="#cb142-220" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb142-221"><a href="#cb142-221" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb142-222"><a href="#cb142-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(mean_total_pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb142-223"><a href="#cb142-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb142-224"><a href="#cb142-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb142-225"><a href="#cb142-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb142-226"><a href="#cb142-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Total Pay"</span>, <span class="at">title =</span> <span class="st">"Average Total Pay Vs Year (per annum basis)"</span>) <span class="sc">+</span></span>
<span id="cb142-227"><a href="#cb142-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb142-228"><a href="#cb142-228" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span>
<span id="cb142-229"><a href="#cb142-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-230"><a href="#cb142-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-231"><a href="#cb142-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-232"><a href="#cb142-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-235"><a href="#cb142-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-236"><a href="#cb142-236" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-237"><a href="#cb142-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span> <span class="sc">|</span> Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-238"><a href="#cb142-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-239"><a href="#cb142-239" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb142-240"><a href="#cb142-240" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb142-241"><a href="#cb142-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(mean_total_pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb142-242"><a href="#cb142-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb142-243"><a href="#cb142-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb142-244"><a href="#cb142-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb142-245"><a href="#cb142-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Total Pay"</span>, <span class="at">title =</span> <span class="st">"Average Total Pay Vs Year (per day &amp; per hour basis)"</span>) <span class="sc">+</span></span>
<span id="cb142-246"><a href="#cb142-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb142-247"><a href="#cb142-247" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span>
<span id="cb142-248"><a href="#cb142-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-249"><a href="#cb142-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-250"><a href="#cb142-250" aria-hidden="true" tabindex="-1"></a>From the dataset, we could see that we have two different types of pay basis - permanent work pay and temporary work pay. For this, we can find average total pay vs year plot for different pay basis. We can see from the above two plots that Average Total Pay was maximum on 2019 for 'per annum' basis and for 'per day &amp; per hour' basis on 2022. Similarly, we see that Average Total Pay was minimum on 2020 for 'per annum' basis and for 'per day &amp; per hour' basis on 2021. This information could useful if we want to find more information on pay average per year for different types of job.</span>
<span id="cb142-251"><a href="#cb142-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-252"><a href="#cb142-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-253"><a href="#cb142-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average working hours for different years :</span></span>
<span id="cb142-254"><a href="#cb142-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-255"><a href="#cb142-255" aria-hidden="true" tabindex="-1"></a>If we want to see how average working hours for different years looks like, we could use a scatter plot to deduce a relationship between average working hours and fiscal year. From below plot, we could see that, the average working hour increased from 2019 to 2020 and then remain constant for 2021. However, it declined during 2022. There could be multiple unwarranted reasons for this trend which could be deduced from the given plot.</span>
<span id="cb142-256"><a href="#cb142-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-257"><a href="#cb142-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-260"><a href="#cb142-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-261"><a href="#cb142-261" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll<span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-262"><a href="#cb142-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Regular_Hours =</span> <span class="fu">mean</span>(Regular_Hours))</span>
<span id="cb142-263"><a href="#cb142-263" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb142-264"><a href="#cb142-264" aria-hidden="true" tabindex="-1"></a>  dat1,</span>
<span id="cb142-265"><a href="#cb142-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Regular_Hours), <span class="at">x =</span> <span class="fu">as.factor</span>(Fiscal_Year), <span class="at">color =</span> <span class="fu">factor</span>(Fiscal_Year), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb142-266"><a href="#cb142-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb142-267"><a href="#cb142-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb142-268"><a href="#cb142-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>() <span class="sc">+</span></span>
<span id="cb142-269"><a href="#cb142-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fiscal Year"</span>, <span class="at">y =</span> <span class="st">"Average Regular Hours"</span>) <span class="sc">+</span></span>
<span id="cb142-270"><a href="#cb142-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb142-271"><a href="#cb142-271" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">'blue'</span>)</span>
<span id="cb142-272"><a href="#cb142-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-273"><a href="#cb142-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-274"><a href="#cb142-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-277"><a href="#cb142-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-278"><a href="#cb142-278" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> </span>
<span id="cb142-279"><a href="#cb142-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanPaid =</span> <span class="fu">mean</span>(Regular_Gross_Paid),</span>
<span id="cb142-280"><a href="#cb142-280" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanBaseSalary =</span> <span class="fu">mean</span>(Base_Salary),</span>
<span id="cb142-281"><a href="#cb142-281" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPaid =</span> <span class="fu">median</span>(Regular_Gross_Paid),</span>
<span id="cb142-282"><a href="#cb142-282" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianBaseSalary =</span> <span class="fu">median</span>(Base_Salary)) <span class="sc">%&gt;%</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">'Fiscal_Year'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-283"><a href="#cb142-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(Fiscal_Year),<span class="at">y=</span>value,<span class="at">group=</span>variable)) <span class="sc">+</span> </span>
<span id="cb142-284"><a href="#cb142-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>variable),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb142-285"><a href="#cb142-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">""</span>,<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"darkred"</span>,<span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Mean, Median of Regular Gross Paid and Base Salary($US) per annum over years'</span>) <span class="sc">+</span></span>
<span id="cb142-286"><a href="#cb142-286" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb142-287"><a href="#cb142-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-288"><a href="#cb142-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-291"><a href="#cb142-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-292"><a href="#cb142-292" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Fiscal_Year) <span class="sc">%&gt;%</span> </span>
<span id="cb142-293"><a href="#cb142-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanPaid =</span> <span class="fu">mean</span>(Regular_Gross_Paid),</span>
<span id="cb142-294"><a href="#cb142-294" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanBaseSalary =</span> <span class="fu">mean</span>(Base_Salary),</span>
<span id="cb142-295"><a href="#cb142-295" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPaid =</span> <span class="fu">median</span>(Regular_Gross_Paid),</span>
<span id="cb142-296"><a href="#cb142-296" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianBaseSalary =</span> <span class="fu">median</span>(Base_Salary)) <span class="sc">%&gt;%</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">'Fiscal_Year'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-297"><a href="#cb142-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(Fiscal_Year),<span class="at">y=</span>value,<span class="at">group=</span>variable)) <span class="sc">+</span> </span>
<span id="cb142-298"><a href="#cb142-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>variable),<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb142-299"><a href="#cb142-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">""</span>,<span class="at">values =</span>  <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"blue"</span>,<span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">'Mean, Median of Regular Gross Paid and Base Salary($US) per day over years'</span>) <span class="sc">+</span></span>
<span id="cb142-300"><a href="#cb142-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>) )</span>
<span id="cb142-301"><a href="#cb142-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-302"><a href="#cb142-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-303"><a href="#cb142-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-304"><a href="#cb142-304" aria-hidden="true" tabindex="-1"></a>To see the statistical analysis of our salary data we could see the mean and median distribution. We know from statistics that if the mean is greater than median than we have right skewed that else we have a left skewed data in vice versa. From the below plot we see, that for all years, the mean is higher than the median suggesting the distribution is right skewed. Now, if we see our distribution plot, we mentioned that the distribution is right skewed. Hence, we explain the distribution plot using statistics.</span>
<span id="cb142-305"><a href="#cb142-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-306"><a href="#cb142-306" aria-hidden="true" tabindex="-1"></a>Now, if we see the trend for the different years from 2019-2022. The mean is increasing from 2019 to 2022 suggesting that the salary of the employee has been increased. However, if we see the median which first decreased for year 2020 and then increased for 2021 and finally decreased for 2022, suggesting that salary increment is not consistent over the years. Now, comparing both mean and median together we could assert that for year 2020, the salary is increased only for few population on the higher end of the distribution, leading to lower median and higher mean. Now for year 2021, the result suggests that salary has been increased for more larger population as compared to previous year, concluding increase in median along with mean.We see that the median is greater than mean for 2021 suggested that data is left skewed. Finally for year 2022, again we see the similar trend as 2020, that salary has been increased but only for few population leading to lesser median and higher mean.</span>
<span id="cb142-307"><a href="#cb142-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-308"><a href="#cb142-308" aria-hidden="true" tabindex="-1"></a>For the <span class="in">`per hour`</span> median and mean of Regular Gross Pay and Base Salary, the gross pay is the highest in the mean and larger than the median suggesting that there is non-uniformity in the data. Few employees have high hourly pay (possible outliers) causing the difference with median gross pay. The base salary suggests that its not applicable to 50% of the employees as median is tending towards zero and mean pay pretty large than median suggesting few population have large hourly base salary causing higher base salary.  </span>
<span id="cb142-309"><a href="#cb142-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-310"><a href="#cb142-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Highest &amp; the Lowest Paying Agencies</span></span>
<span id="cb142-311"><a href="#cb142-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-312"><a href="#cb142-312" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pay by Annum</span></span>
<span id="cb142-313"><a href="#cb142-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-314"><a href="#cb142-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-315"><a href="#cb142-315" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-316"><a href="#cb142-316" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-317"><a href="#cb142-317" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-318"><a href="#cb142-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-319"><a href="#cb142-319" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-320"><a href="#cb142-320" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-321"><a href="#cb142-321" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-322"><a href="#cb142-322" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-323"><a href="#cb142-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-324"><a href="#cb142-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-325"><a href="#cb142-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-326"><a href="#cb142-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-327"><a href="#cb142-327" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-328"><a href="#cb142-328" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-329"><a href="#cb142-329" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-330"><a href="#cb142-330" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-331"><a href="#cb142-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-332"><a href="#cb142-332" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-333"><a href="#cb142-333" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-334"><a href="#cb142-334" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span></span>
<span id="cb142-335"><a href="#cb142-335" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>)) </span>
<span id="cb142-336"><a href="#cb142-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-337"><a href="#cb142-337" aria-hidden="true" tabindex="-1"></a>Suppose, if want to see how the total pay is distributed across different agencies for <span class="in">`per annum`</span> basis. We could use following plot. Now, from the result we see that, maximum total pay is for Agency “Queens community board #14” and minimum total pay is for Agency “Queens community board #8”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower. This information can help us to understand about a popularity of the agency or other analysis.</span>
<span id="cb142-338"><a href="#cb142-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-339"><a href="#cb142-339" aria-hidden="true" tabindex="-1"></a><span class="fu"># Pay by Day</span></span>
<span id="cb142-340"><a href="#cb142-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-341"><a href="#cb142-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-342"><a href="#cb142-342" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-343"><a href="#cb142-343" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-344"><a href="#cb142-344" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-345"><a href="#cb142-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-346"><a href="#cb142-346" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-347"><a href="#cb142-347" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-348"><a href="#cb142-348" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-349"><a href="#cb142-349" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-350"><a href="#cb142-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-351"><a href="#cb142-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-352"><a href="#cb142-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-353"><a href="#cb142-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-354"><a href="#cb142-354" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-355"><a href="#cb142-355" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-356"><a href="#cb142-356" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-357"><a href="#cb142-357" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-358"><a href="#cb142-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-359"><a href="#cb142-359" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-360"><a href="#cb142-360" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-361"><a href="#cb142-361" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span></span>
<span id="cb142-362"><a href="#cb142-362" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-363"><a href="#cb142-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-364"><a href="#cb142-364" aria-hidden="true" tabindex="-1"></a>Now, if want to see how the total pay is distributed across different agencies for <span class="in">`per day`</span> basis. We could use above plot. Now, from the result we see that, maximum total pay is for Agency “Dept of citywide admin svcs” and minimum total pay is for Agency “Department of juvenile justice”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower. </span>
<span id="cb142-365"><a href="#cb142-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-366"><a href="#cb142-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-367"><a href="#cb142-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-368"><a href="#cb142-368" aria-hidden="true" tabindex="-1"></a><span class="fu"># pay by hour</span></span>
<span id="cb142-369"><a href="#cb142-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-370"><a href="#cb142-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-371"><a href="#cb142-371" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-372"><a href="#cb142-372" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-373"><a href="#cb142-373" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-374"><a href="#cb142-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-375"><a href="#cb142-375" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-376"><a href="#cb142-376" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-377"><a href="#cb142-377" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-378"><a href="#cb142-378" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-379"><a href="#cb142-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-380"><a href="#cb142-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-381"><a href="#cb142-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-382"><a href="#cb142-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-383"><a href="#cb142-383" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-384"><a href="#cb142-384" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-385"><a href="#cb142-385" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-386"><a href="#cb142-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-387"><a href="#cb142-387" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-388"><a href="#cb142-388" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-389"><a href="#cb142-389" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-390"><a href="#cb142-390" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-391"><a href="#cb142-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-392"><a href="#cb142-392" aria-hidden="true" tabindex="-1"></a>Now, if want to see how the total pay is distributed across different agencies for <span class="in">`per hour`</span> basis. We could use above plot. Now, from the result we see that, maximum total pay is for Agency “Civil services commission” and minimum total pay is for Agency “Bronx community board #10”. Thus, if we sort the Agency wrt total pay, then we can comment that which agencies pay higher or lower. </span>
<span id="cb142-393"><a href="#cb142-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-394"><a href="#cb142-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-395"><a href="#cb142-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-396"><a href="#cb142-396" aria-hidden="true" tabindex="-1"></a><span class="fu">## Jobs Title that pay the Most &amp; Least money in NYC</span></span>
<span id="cb142-397"><a href="#cb142-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-398"><a href="#cb142-398" aria-hidden="true" tabindex="-1"></a>Now, we do same analysis for 'Job Title' which we did in the previous section. We want to find which job title has maximum or minimum average total pay for different pay basis. We used bar plot for descending or ascending average total pay for our analysis. </span>
<span id="cb142-399"><a href="#cb142-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-400"><a href="#cb142-400" aria-hidden="true" tabindex="-1"></a><span class="fu"># per annum</span></span>
<span id="cb142-401"><a href="#cb142-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-402"><a href="#cb142-402" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-403"><a href="#cb142-403" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-404"><a href="#cb142-404" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-405"><a href="#cb142-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-406"><a href="#cb142-406" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-407"><a href="#cb142-407" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-408"><a href="#cb142-408" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-409"><a href="#cb142-409" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-410"><a href="#cb142-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-411"><a href="#cb142-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-412"><a href="#cb142-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-413"><a href="#cb142-413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-414"><a href="#cb142-414" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-415"><a href="#cb142-415" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per annum'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-416"><a href="#cb142-416" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-417"><a href="#cb142-417" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-418"><a href="#cb142-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-419"><a href="#cb142-419" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-420"><a href="#cb142-420" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-421"><a href="#cb142-421" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> </span>
<span id="cb142-422"><a href="#cb142-422" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-423"><a href="#cb142-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-424"><a href="#cb142-424" aria-hidden="true" tabindex="-1"></a><span class="fu"># per day</span></span>
<span id="cb142-425"><a href="#cb142-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-426"><a href="#cb142-426" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-427"><a href="#cb142-427" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-428"><a href="#cb142-428" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-429"><a href="#cb142-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-430"><a href="#cb142-430" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-431"><a href="#cb142-431" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-432"><a href="#cb142-432" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-433"><a href="#cb142-433" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-434"><a href="#cb142-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-435"><a href="#cb142-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-436"><a href="#cb142-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-437"><a href="#cb142-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-438"><a href="#cb142-438" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per day'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-439"><a href="#cb142-439" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-440"><a href="#cb142-440" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-441"><a href="#cb142-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-442"><a href="#cb142-442" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-443"><a href="#cb142-443" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-444"><a href="#cb142-444" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-445"><a href="#cb142-445" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-446"><a href="#cb142-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-447"><a href="#cb142-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-448"><a href="#cb142-448" aria-hidden="true" tabindex="-1"></a><span class="fu"># pay by hour</span></span>
<span id="cb142-449"><a href="#cb142-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-450"><a href="#cb142-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width = 7}</span></span>
<span id="cb142-451"><a href="#cb142-451" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-452"><a href="#cb142-452" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),]</span>
<span id="cb142-453"><a href="#cb142-453" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-454"><a href="#cb142-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-455"><a href="#cb142-455" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, Mean_Total_Pay)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-456"><a href="#cb142-456" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-457"><a href="#cb142-457" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-458"><a href="#cb142-458" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-459"><a href="#cb142-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-460"><a href="#cb142-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-461"><a href="#cb142-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-462"><a href="#cb142-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10}</span></span>
<span id="cb142-463"><a href="#cb142-463" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-464"><a href="#cb142-464" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Pay_Basis<span class="sc">==</span><span class="st">'per hour'</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Title_Description) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_Total_Pay =</span> <span class="fu">mean</span>(Total_Pay))</span>
<span id="cb142-465"><a href="#cb142-465" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_Total_Pay, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-466"><a href="#cb142-466" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-467"><a href="#cb142-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-468"><a href="#cb142-468" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Title_Description =</span> <span class="fu">fct_reorder</span>(Title_Description, <span class="fu">desc</span>(Mean_Total_Pay))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_Total_Pay), <span class="at">x =</span> <span class="fu">as.factor</span>(Title_Description),<span class="at">fill=</span>Title_Description), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb142-469"><a href="#cb142-469" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-470"><a href="#cb142-470" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> func) <span class="sc">+</span> </span>
<span id="cb142-471"><a href="#cb142-471" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>), <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"mm"</span>))</span>
<span id="cb142-472"><a href="#cb142-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-473"><a href="#cb142-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-474"><a href="#cb142-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-475"><a href="#cb142-475" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average pay by Location</span></span>
<span id="cb142-476"><a href="#cb142-476" aria-hidden="true" tabindex="-1"></a>Work Location Borough tells us the area that a particular agency in NYC belongs to so it is interesting to know which one of these areas have the highest pay!</span>
<span id="cb142-477"><a href="#cb142-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-478"><a href="#cb142-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=10 }</span></span>
<span id="cb142-479"><a href="#cb142-479" aria-hidden="true" tabindex="-1"></a><span class="co"># Using number of observation per group</span></span>
<span id="cb142-480"><a href="#cb142-480" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%d"</span>, x)</span>
<span id="cb142-481"><a href="#cb142-481" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Work_Location_Borough, <span class="at">y =</span> Total_Pay)) <span class="sc">+</span></span>
<span id="cb142-482"><a href="#cb142-482" aria-hidden="true" tabindex="-1"></a>       <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="co"># Boxplot with error bars </span></span>
<span id="cb142-483"><a href="#cb142-483" aria-hidden="true" tabindex="-1"></a>                    <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb142-484"><a href="#cb142-484" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">'green'</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="co"># Colors</span></span>
<span id="cb142-485"><a href="#cb142-485" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">outlier.colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb142-486"><a href="#cb142-486" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Total Pay"</span>, <span class="at">labels =</span> func) <span class="sc">+</span>  <span class="co"># Continuous variable label</span></span>
<span id="cb142-487"><a href="#cb142-487" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Work Location Borough"</span>) <span class="sc">+</span>      <span class="co"># Group label</span></span>
<span id="cb142-488"><a href="#cb142-488" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="st">"Boxplot by Work Location Borough"</span>) <span class="sc">+</span> <span class="co"># Plot title</span></span>
<span id="cb142-489"><a href="#cb142-489" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="co"># Theme customization</span></span>
<span id="cb142-490"><a href="#cb142-490" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="fl">0.25</span>), <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span> ))</span>
<span id="cb142-491"><a href="#cb142-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-492"><a href="#cb142-492" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb142-493"><a href="#cb142-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-494"><a href="#cb142-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-495"><a href="#cb142-495" aria-hidden="true" tabindex="-1"></a>In order to find out the total pay distribution wrt location, we could use box plot distribution for Total Pay VS Location plot. Now, if we the box plot, then for most of the locations we see there are outliers in the data suggesting that total pay have extreme values I.e few employees have relevantly more total pay than remaining. Moreover, if we compare among different locations, then we could see that Washington have higher median than others suggesting that we have more uniformity in the total pay as compared to other locations. However, if we want to find out which location has higher pay than we see that Manhattan has higher pay as compared to because of outliers. Also, if we see that most of the box plot are either right or left skewed with outliers suggesting non uniformity in the total pay distribution. However, for few cities like Ulster, Westchester, Duchess etc looks to have normal distribution suggesting uniform pay distribution. Therefore, we can comment on the uniformity of pay distribution or average pay distribution or city with higher or lower pay distribution using box plot. </span>
<span id="cb142-496"><a href="#cb142-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-497"><a href="#cb142-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-498"><a href="#cb142-498" aria-hidden="true" tabindex="-1"></a><span class="fu">## Agency name which has highest overtime hours and over time salary :</span></span>
<span id="cb142-499"><a href="#cb142-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-500"><a href="#cb142-500" aria-hidden="true" tabindex="-1"></a>When we deal with payroll data, our one of the primary point of interest is <span class="in">`overtime`</span> payment. Therefore, we want to deduce a relationship between 'Agency Name' and 'overtime' hours or payment. </span>
<span id="cb142-501"><a href="#cb142-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-502"><a href="#cb142-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=7}</span></span>
<span id="cb142-503"><a href="#cb142-503" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_OT_Hours =</span> <span class="fu">mean</span>(OT_Hours))</span>
<span id="cb142-504"><a href="#cb142-504" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_OT_Hours, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-505"><a href="#cb142-505" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-506"><a href="#cb142-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-507"><a href="#cb142-507" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, Mean_OT_Hours)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_OT_Hours), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name)) <span class="sc">+</span></span>
<span id="cb142-508"><a href="#cb142-508" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">size=</span>.<span class="dv">3</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-509"><a href="#cb142-509" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb142-510"><a href="#cb142-510" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-511"><a href="#cb142-511" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb142-512"><a href="#cb142-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-513"><a href="#cb142-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-514"><a href="#cb142-514" aria-hidden="true" tabindex="-1"></a>From the above graph, we see that the 'fire department' has the most overtime working hours followed by 'board of election' than 'department of correction' as top 3 agencies with overtime working hours.</span>
<span id="cb142-515"><a href="#cb142-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-516"><a href="#cb142-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height = 4, fig.width=7}</span></span>
<span id="cb142-517"><a href="#cb142-517" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">=</span> NY_payroll <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Agency_Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Mean_OT_paid =</span> <span class="fu">mean</span>(Total_OT_Paid))</span>
<span id="cb142-518"><a href="#cb142-518" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> dat1[<span class="fu">order</span>(dat1<span class="sc">$</span>Mean_OT_paid, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb142-519"><a href="#cb142-519" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> newdata[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb142-520"><a href="#cb142-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-521"><a href="#cb142-521" aria-hidden="true" tabindex="-1"></a>newdata <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Agency_Name =</span> <span class="fu">fct_reorder</span>(Agency_Name, <span class="fu">desc</span>(Mean_OT_paid))) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">y =</span>  <span class="fu">as.numeric</span>(Mean_OT_paid), <span class="at">x =</span> <span class="fu">as.factor</span>(Agency_Name),<span class="at">fill=</span>Agency_Name)) <span class="sc">+</span></span>
<span id="cb142-522"><a href="#cb142-522" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">width=</span><span class="fl">0.3</span>,<span class="at">size=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb142-523"><a href="#cb142-523" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_fivethirtyeight</span>() <span class="sc">+</span> </span>
<span id="cb142-524"><a href="#cb142-524" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.6</span>), <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>,<span class="at">size=</span><span class="dv">6</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb142-525"><a href="#cb142-525" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb142-526"><a href="#cb142-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-527"><a href="#cb142-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-528"><a href="#cb142-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-529"><a href="#cb142-529" aria-hidden="true" tabindex="-1"></a>From the above plot, average overtime payment is displayed against different agencies. We have sorted our data in descending order to capture the maximum overtime payment. We see that 'fire department' followed by 'department of sanitation' than 'department of correction'. </span>
<span id="cb142-530"><a href="#cb142-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-531"><a href="#cb142-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-532"><a href="#cb142-532" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribution of average total payment based on new york counties for different years</span></span>
<span id="cb142-533"><a href="#cb142-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-534"><a href="#cb142-534" aria-hidden="true" tabindex="-1"></a>Finally, we could use 'New York' map to show the distribution of average total pay across all counties. We used theme_map() for 'new york' state and used light shade to display lower total pay and darker shade for higher total pay for all fiscal years. This map plot gives visual idea of maximum and minimum average pay for a location which more descriptive on comparison to bar that could be used in place of bar plot for same relationship.</span>
<span id="cb142-535"><a href="#cb142-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-536"><a href="#cb142-536" aria-hidden="true" tabindex="-1"></a>We see that the same county has darker shade and light shade across all fiscal years. Thus, suggesting that these are high paying areas with better jobs. However, we might need more evidence to corroborate our statement. </span>
<span id="cb142-537"><a href="#cb142-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-540"><a href="#cb142-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-541"><a href="#cb142-541" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-542"><a href="#cb142-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-543"><a href="#cb142-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb142-544"><a href="#cb142-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-545"><a href="#cb142-545" aria-hidden="true" tabindex="-1"></a>NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb142-546"><a href="#cb142-546" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2019</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-547"><a href="#cb142-547" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb142-548"><a href="#cb142-548" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-549"><a href="#cb142-549" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-550"><a href="#cb142-550" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb142-551"><a href="#cb142-551" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb142-552"><a href="#cb142-552" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb142-553"><a href="#cb142-553" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"orange"</span>, </span>
<span id="cb142-554"><a href="#cb142-554" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"darkred"</span>,</span>
<span id="cb142-555"><a href="#cb142-555" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb142-556"><a href="#cb142-556" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb142-557"><a href="#cb142-557" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb142-558"><a href="#cb142-558" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb142-559"><a href="#cb142-559" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2019"</span>)) <span class="sc">+</span> </span>
<span id="cb142-560"><a href="#cb142-560" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb142-561"><a href="#cb142-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-564"><a href="#cb142-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-565"><a href="#cb142-565" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-566"><a href="#cb142-566" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-567"><a href="#cb142-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb142-568"><a href="#cb142-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-569"><a href="#cb142-569" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb142-570"><a href="#cb142-570" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2020</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-571"><a href="#cb142-571" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb142-572"><a href="#cb142-572" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-573"><a href="#cb142-573" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-574"><a href="#cb142-574" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb142-575"><a href="#cb142-575" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb142-576"><a href="#cb142-576" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb142-577"><a href="#cb142-577" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"blue"</span>, </span>
<span id="cb142-578"><a href="#cb142-578" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"darkred"</span>,</span>
<span id="cb142-579"><a href="#cb142-579" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb142-580"><a href="#cb142-580" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb142-581"><a href="#cb142-581" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb142-582"><a href="#cb142-582" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb142-583"><a href="#cb142-583" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2020"</span>)) <span class="sc">+</span> </span>
<span id="cb142-584"><a href="#cb142-584" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb142-585"><a href="#cb142-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-586"><a href="#cb142-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-589"><a href="#cb142-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-590"><a href="#cb142-590" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-591"><a href="#cb142-591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-592"><a href="#cb142-592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb142-593"><a href="#cb142-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-594"><a href="#cb142-594" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb142-595"><a href="#cb142-595" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2021</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-596"><a href="#cb142-596" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb142-597"><a href="#cb142-597" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-598"><a href="#cb142-598" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-599"><a href="#cb142-599" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb142-600"><a href="#cb142-600" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb142-601"><a href="#cb142-601" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb142-602"><a href="#cb142-602" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"green"</span>, </span>
<span id="cb142-603"><a href="#cb142-603" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb142-604"><a href="#cb142-604" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb142-605"><a href="#cb142-605" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb142-606"><a href="#cb142-606" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb142-607"><a href="#cb142-607" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb142-608"><a href="#cb142-608" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2021"</span>)) <span class="sc">+</span> </span>
<span id="cb142-609"><a href="#cb142-609" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb142-610"><a href="#cb142-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-611"><a href="#cb142-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-614"><a href="#cb142-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-615"><a href="#cb142-615" aria-hidden="true" tabindex="-1"></a>ny_counties <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">'county'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-616"><a href="#cb142-616" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb142-617"><a href="#cb142-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">'new york'</span>)</span>
<span id="cb142-618"><a href="#cb142-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-619"><a href="#cb142-619" aria-hidden="true" tabindex="-1"></a> NY_payroll <span class="sc">%&gt;%</span></span>
<span id="cb142-620"><a href="#cb142-620" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Fiscal_Year<span class="sc">==</span><span class="dv">2022</span> <span class="sc">&amp;</span> region <span class="sc">==</span> <span class="st">"new york"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-621"><a href="#cb142-621" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(region, <span class="at">subregion =</span> <span class="fu">tolower</span>(Work_Location_Borough)) <span class="sc">%&gt;%</span></span>
<span id="cb142-622"><a href="#cb142-622" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">mean_total_pay =</span> <span class="fu">mean</span>(Total_Pay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-623"><a href="#cb142-623" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(ny_counties, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'region'</span>, <span class="st">'subregion'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-624"><a href="#cb142-624" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> mean_total_pay)) <span class="sc">+</span> </span>
<span id="cb142-625"><a href="#cb142-625" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>() <span class="sc">+</span> </span>
<span id="cb142-626"><a href="#cb142-626" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">'white'</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb142-627"><a href="#cb142-627" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_continuous</span>(<span class="at">low =</span> <span class="st">"pink"</span>, </span>
<span id="cb142-628"><a href="#cb142-628" aria-hidden="true" tabindex="-1"></a>                            <span class="at">high =</span> <span class="st">"purple"</span>,</span>
<span id="cb142-629"><a href="#cb142-629" aria-hidden="true" tabindex="-1"></a>                            <span class="at">name =</span> <span class="st">'Total Pay (dollar)'</span>) <span class="sc">+</span> </span>
<span id="cb142-630"><a href="#cb142-630" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_map</span>() <span class="sc">+</span> </span>
<span id="cb142-631"><a href="#cb142-631" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>() <span class="sc">+</span> </span>
<span id="cb142-632"><a href="#cb142-632" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_map</span>(<span class="st">'albers'</span>, <span class="at">lat0=</span><span class="dv">30</span>, <span class="at">lat1=</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb142-633"><a href="#cb142-633" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Average Total Pay for NY Employees for 2022"</span>)) <span class="sc">+</span> </span>
<span id="cb142-634"><a href="#cb142-634" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb142-635"><a href="#cb142-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-636"><a href="#cb142-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-637"><a href="#cb142-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-638"><a href="#cb142-638" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions :</span></span>
<span id="cb142-639"><a href="#cb142-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-640"><a href="#cb142-640" aria-hidden="true" tabindex="-1"></a>Throughout this project, we used different visualizations techniques using ggplot library to demonstrate the different data behaviors. We used 'NYC Payroll' dataset from which we explained overall pay distribution across different agencies, regions and pay basis types. We used pie chart, bar plot, box plot, distribution curve, line plot, theme map etc, for our overall data analysis. The choice of plot was picked based on the nature of the data and the analysis we wanted to deduce. </span>
<span id="cb142-641"><a href="#cb142-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-642"><a href="#cb142-642" aria-hidden="true" tabindex="-1"></a>From the above analysis, we saw how the working hours, per basis type, total payment and average total pay varies with fiscal year or agencies type. We also saw statistical analysis using mean and median of salaries wrt fiscal year to see the trend on the increment of total pay over the years. Furthermore, we saw the agency which pays most and least overtime salary and the agency which have maximum overtime hours. These are important aspects when we see payment data. Lastly, we used 'New York' state map to display the Total Payment distribution across different counties. Therefore, we explained how using different data visualizations we can explain the data and its behavior. </span>
<span id="cb142-643"><a href="#cb142-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-644"><a href="#cb142-644" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further thoughts :</span></span>
<span id="cb142-645"><a href="#cb142-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-646"><a href="#cb142-646" aria-hidden="true" tabindex="-1"></a>In this project, I added all possible visualizations which could be interpreted from the dataset. The data contains information about NYC payroll. Hence, columns like total pay, gross pay, special allowance, counties, job types, job title, payment basis, overtime hours etc. create meaningful significance. I tried to use different plots which I felt explains the data property more closely than any other plot. The map plot where I showed the distribution between average total pay and counites could be improved. We could add more information like county name and data set could include all county information for diverse results. Overall I feel that I explained the dataset with loads of data visualisation tools to explain the trend, behavior and relationship between two or multiple variables.</span>
<span id="cb142-647"><a href="#cb142-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-648"><a href="#cb142-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-649"><a href="#cb142-649" aria-hidden="true" tabindex="-1"></a><span class="fu">## References </span></span>
<span id="cb142-650"><a href="#cb142-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-651"><a href="#cb142-651" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>https://data.cityofnewyork.us/City-Government/Citywide-Payroll-Data-Fiscal-Year-/k397-673e</span>
<span id="cb142-652"><a href="#cb142-652" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>https://studentwork.prattsi.org/infovis/projects/visualizing-the-citywide-payroll/</span>
<span id="cb142-653"><a href="#cb142-653" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>https://www.kaggle.com/code/jonathanbouchet/nyc-payroll-data/report</span>
<span id="cb142-654"><a href="#cb142-654" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb142-657"><a href="#cb142-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-658"><a href="#cb142-658" aria-hidden="true" tabindex="-1"></a><span class="co">#save.image("Final_project_NiyatiSharma.RData")</span></span>
<span id="cb142-659"><a href="#cb142-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-660"><a href="#cb142-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-661"><a href="#cb142-661" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>